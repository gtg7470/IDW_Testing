ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"wifi_module_spi.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.no_op,"ax",%progbits
  18              		.align	1
  19              		.global	no_op
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	no_op:
  26              	.LFB275:
  27              		.file 1 "Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c"
   1:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
   2:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  ******************************************************************************
   3:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @file    wifi_module_spi.c
   4:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @author  Central LAB
   5:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @version V0.0.1
   6:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @date    10-Nov-2016
   7:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @brief   Enable Wi-Fi functionality using SPI
   8:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  ******************************************************************************
   9:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @attention
  10:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *
  11:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * <h2><center>&copy; COPYRIGHT(c) 2015 STMicroelectronics</center></h2>
  12:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *
  13:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * Redistribution and use in source and binary forms, with or without modification,
  14:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * are permitted provided that the following conditions are met:
  15:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *   1. Redistributions of source code must retain the above copyright notice,
  16:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *      this list of conditions and the following disclaimer.
  17:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *   2. Redistributions in binary form must reproduce the above copyright notice,
  18:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *      this list of conditions and the following disclaimer in the documentation
  19:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *      and/or other materials provided with the distribution.
  20:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *   3. Neither the name of STMicroelectronics nor the names of its contributors
  21:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *      may be used to endorse or promote products derived from this software
  22:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *      without specific prior written permission.
  23:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *
  24:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  25:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  26:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  27:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
  28:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  29:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
  30:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
  31:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 2


  32:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  33:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  34:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *
  35:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  ******************************************************************************
  36:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  */
  37:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /* Includes ------------------------------------------------------------------*/
  38:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #include "wifi_module.h"
  39:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #include "wifi_globals.h"
  40:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #include "stm32f4xx_hal_spi.h"
  41:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #include "enum.h"
  42:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
  43:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /** @addtogroup MIDDLEWARES
  44:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** * @{
  45:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** */ 
  46:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
  47:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /** @defgroup  NUCLEO_WIFI_MODULE
  48:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   * @brief Wi-Fi driver modules
  49:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   * @{
  50:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   */
  51:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
  52:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /** @defgroup NUCLEO_WIFI_MODULE_Private_Defines
  53:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   * @{
  54:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   */
  55:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
  56:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
  57:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   * @}
  58:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   */
  59:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
  60:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /** @addtogroup NUCLEO_WIFI_MODULE_Private_Variables
  61:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   * @{
  62:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   */
  63:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** //#define SPI_IRQ_MODE
  64:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #define SPI_DMA_MODE
  65:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #define HEADER_SIZE 5 //1[0x2], (1)[KOE], 1[Wind_No], 2[Payload Len] = 5 bytes
  66:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #define SPI_READ_PACKET_SIZE 1024
  67:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #define CS_PULSE_700NS_NBR_CYCLES_REQ1  352
  68:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #define CS_PULSE_LENGTH1 (CS_PULSE_700NS_NBR_CYCLES_REQ1/4)
  69:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #define DUMMY_RAM_ADDRESS_TO_READ1 (0x20000000)
  70:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #define SOCKET_WRITE_DELAY 250
  71:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
  72:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** uint8_t Write_Header_CMD[HEADER_SIZE] = {0x00, 0x00, 0x00, 0x00, 0x00};
  73:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** uint8_t Read_Header_CMD[HEADER_SIZE] = {0x02, 0x00, 0x00, 0x00, 0x00};
  74:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** uint8_t Received_Header[HEADER_SIZE];
  75:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** uint8_t dummy_Header[HEADER_SIZE];
  76:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** uint8_t dataBuff[SPI_READ_PACKET_SIZE];
  77:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
  78:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** const uint8_t dummy_bytes = 0xFF;
  79:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** char dummy_char = 0xFF;
  80:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** uint8_t wind_no, sync;
  81:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** uint16_t http_packet_len, payload_len, payload_to_read, payload_read_len;
  82:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** uint8_t* tx_payload_data;
  83:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** uint32_t payload_size_to_transmit;
  84:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** uint8_t* tx_header_data;
  85:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** uint8_t  tx_header_size;
  86:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** uint8_t  tx_payload_size;
  87:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** uint8_t packet_cont;
  88:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** wifi_bool wind_55_in_Q = WIFI_FALSE;
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 3


  89:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
  90:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** SPI_RECEIVE_EVENT_t Spi_Receive_Event;
  91:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** SPI_TRANSMIT_EVENT_t Spi_Transmit_Event;
  92:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** KIND_OF_EVENT_t kind_of_event;
  93:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** wifi_bool SPI_Tx_Transfer;
  94:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** wifi_bool gcfg_data_broken = WIFI_FALSE;
  95:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
  96:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** //void ReceiveDummy(uint8_t * Data, uint8_t DataLen);
  97:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void SPI_Transmit_Manager(SPI_TRANSMIT_REQUEST_t TransmitRequest);
  98:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void SPI_Transmit_Manager_Poll(uint8_t * Data, uint32_t DataLen);
  99:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void TransmitClosure(void);
 100:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 101:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #if defined(SPWF04) && !defined(CONSOLE_UART_ENABLED)
 102:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** static uint8_t process_buffer[100];
 103:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** static char *mqtt_string = "%u:%[^:]:%*u:%*u:%*u:%u:%u:%n";
 104:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 105:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** extern wifi_instances_t wifi_instances;
 106:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 107:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** static uint8_t scan_ignore=0;
 108:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void ReceiveHeader(SPI_RECEIVE_EVENT_t ReceiveEvent, uint8_t * DataHeader, uint8_t DataLen);
 109:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void SPI_Receive_Manager(SPI_RECEIVE_REQUEST_t ReceiveRequest);
 110:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 111:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void ProcessEndOfReceive(KIND_OF_PACKET_t kop, WiFi_Indication_t wind_no);
 112:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void Process_Packet(KIND_OF_PACKET_t kop, WiFi_Indication_t wind_no);
 113:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void Process_Wind_Payload(WiFi_Indication_t wind_no);
 114:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 115:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void ReceiveClosure(void);
 116:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #endif
 117:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 118:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void no_op(int dummy) { }
  28              		.loc 1 118 0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
  33              	.LVL0:
  34 0000 7047     		bx	lr
  35              		.cfi_endproc
  36              	.LFE275:
  38              		.section	.text.SPI_Transmit_Manager,"ax",%progbits
  39              		.align	1
  40              		.global	SPI_Transmit_Manager
  41              		.syntax unified
  42              		.thumb
  43              		.thumb_func
  44              		.fpu fpv4-sp-d16
  46              	SPI_Transmit_Manager:
  47              	.LFB278:
 119:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 120:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #if defined(SPWF04) && !defined(CONSOLE_UART_ENABLED)
 121:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
 122:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @brief  WIFI SPI IRQ Callback
 123:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @param  None
 124:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @retval None
 125:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  */
 126:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void WIFI_SPI_IRQ_Callback(void)
 127:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 4


 128:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   Disable_SPI_Receiving_Path();
 129:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   Enable_SPI_CS();//Enable nCS (Chip Select) 
 130:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 131:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   if(IO_status_flag.send_data)
 132:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   {
 133:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       SPI_Transmit_Manager(SPI_WRITE_PAYLOAD_TRANSMIT);//now send the data
 134:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       IO_status_flag.send_data = WIFI_FALSE;
 135:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   } else
 136:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   {
 137:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     //if(!SPI_Tx_Transfer)/*Ignore IRQ if in between a AT Cmd, Fix for Socket Server read!*/
 138:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     SPI_Receive_Manager(SPI_READ_HEADER_FOR_RX);
 139:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   }
 140:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 141:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** }
 142:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 143:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #ifdef SPI_DMA_MODE
 144:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
 145:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @brief  Manage the SPI receive
 146:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @param  ReceiveRequest: the receive request
 147:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @retval None
 148:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  */
 149:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void SPI_Receive_Manager(SPI_RECEIVE_REQUEST_t ReceiveRequest)
 150:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {
 151:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   uint16_t byte_count;
 152:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   volatile uint8_t i, dummy = 0x00;
 153:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   //uint16_t payload_len;
 154:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 155:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   /*
 156:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    *  Disable both DMA
 157:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    */
 158:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_DISABLE(SpiHandle.hdmatx);
 159:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_DISABLE(SpiHandle.hdmarx);
 160:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 161:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   /**
 162:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    * Flush the Rx register or FIFO
 163:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    */
 164:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   for (i = 0 ; i < SPI_FIFO_RX_DEPTH ; i++)
 165:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   {
 166:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     no_op(*(volatile uint8_t*)__HAL_WIFI_SPI_GET_RX_DATA_REGISTER_ADDRESS(&SpiHandle));
 167:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   }
 168:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 169:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_ENABLE_IT(SpiHandle.hdmarx, DMA_IT_TC);	/**< Enable Receive packet notification */
 170:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_DISABLE_IT(SpiHandle.hdmatx, DMA_IT_TC); /**< Disable Transmit packet notification */
 171:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 172:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   switch (ReceiveRequest)
 173:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   {
 174:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   case SPI_READ_HEADER_FOR_RX:
 175:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     ReceiveHeader(SPI_RECEIVED_HEADER_FOR_RX, (uint8_t *)Read_Header_CMD, HEADER_SIZE);
 176:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
 177:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 178:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   case SPI_READ_HEADER_FOR_TX:
 179:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     ReceiveHeader(SPI_RECEIVED_HEADER_FOR_TX, (uint8_t *)tx_payload_data, payload_size_to_transmit)
 180:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
 181:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 182:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   case SPI_READ_PAYLOAD:
 183:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 184:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     byte_count = payload_to_read;
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 5


 185:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     if (byte_count > SPI_READ_PACKET_SIZE)
 186:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     {
 187:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       byte_count = SPI_READ_PACKET_SIZE;
 188:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     }
 189:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 190:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     payload_read_len = byte_count;
 191:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 192:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     Spi_Receive_Event = SPI_RECEIVE_END;/*For Wind Payload*/        
 193:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 194:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_CLEAR_MINC(SpiHandle.hdmatx); /**< Configure DMA to send same Byte */
 195:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 196:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     /*
 197:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****      *  Set counter in both DMA
 198:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****      */
 199:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_COUNTER(SpiHandle.hdmarx, byte_count);
 200:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_COUNTER(SpiHandle.hdmatx, byte_count);
 201:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 202:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     /*
 203:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****      *  Set memory address in both DMA
 204:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****      */
 205:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_MEMORY_ADDRESS(SpiHandle.hdmarx, (uint32_t)&dataBuff);
 206:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_MEMORY_ADDRESS(SpiHandle.hdmatx, (uint32_t)&dummy_bytes);
 207:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 208:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
 209:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 210:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   case SPI_READ_DATA_PAYLOAD:  
 211:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 212:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     //What happens when payload_to_read becomes > sizeof(dataBuff)?
 213:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     //we first read sizeof(datBuff) and repeat read till payload_to_read is complete
 214:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     byte_count = payload_to_read;
 215:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 216:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     if (byte_count > SPI_READ_PACKET_SIZE)
 217:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     {
 218:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       byte_count = SPI_READ_PACKET_SIZE;
 219:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       payload_to_read -= byte_count; //reduce payload_to_read by amount read(sizeof(dataBuff)) so f
 220:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       Spi_Receive_Event = SPI_RECEIVE_INTERIM_PAYLOAD_DATA;/*For Data Payload higher than dataBuff 
 221:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     }
 222:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     else
 223:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     {
 224:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       payload_to_read = 0;
 225:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       Spi_Receive_Event = SPI_RECEIVE_PAYLOAD_DATA;/*For Data Payload*/
 226:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     }
 227:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 228:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     payload_read_len = byte_count;            
 229:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 230:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_CLEAR_MINC(SpiHandle.hdmatx); /**< Configure DMA to send same Byte */
 231:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 232:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     /*
 233:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****      *  Set counter in both DMA
 234:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****      */
 235:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_COUNTER(SpiHandle.hdmarx, byte_count);
 236:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_COUNTER(SpiHandle.hdmatx, byte_count);
 237:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 238:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     /*
 239:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****      *  Set memory address in both DMA
 240:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****      */    
 241:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_MEMORY_ADDRESS(SpiHandle.hdmarx, (uint32_t)&dataBuff);
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 6


 242:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_MEMORY_ADDRESS(SpiHandle.hdmatx, (uint32_t)&dummy);
 243:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;      
 244:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 245:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   default:
 246:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
 247:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   }
 248:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 249:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   /*
 250:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    *  Enable both DMA - Rx First
 251:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    */
 252:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_ENABLE(SpiHandle.hdmarx);
 253:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_ENABLE(SpiHandle.hdmatx);
 254:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 255:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   return;
 256:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** }
 257:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #endif
 258:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 259:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
 260:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @brief Receive header
 261:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @param  ReceiveEvent: Set the current receive event ongoing.
 262:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *         DataHeader  : Data Header for Tx (not used today).
 263:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *         DataLen     : Tx Data Len (not used today)
 264:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @retval None
 265:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  */
 266:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void ReceiveHeader(SPI_RECEIVE_EVENT_t ReceiveEvent, uint8_t * DataHeader, uint8_t DataLen)
 267:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {
 268:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   Spi_Receive_Event = ReceiveEvent;
 269:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       
 270:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_WIFI_DMA_SET_MINC(SpiHandle.hdmatx);	/**< Configure DMA to send Tx packet */
 271:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 272:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   /*
 273:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    *  Set counter in both DMA
 274:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    */
 275:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_WIFI_DMA_SET_COUNTER(SpiHandle.hdmatx, DataLen);
 276:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_WIFI_DMA_SET_COUNTER(SpiHandle.hdmarx, HEADER_SIZE);
 277:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 278:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   /*
 279:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    *  Set memory address in both DMA
 280:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    */
 281:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_WIFI_DMA_SET_MEMORY_ADDRESS(SpiHandle.hdmarx, (uint32_t)Received_Header);
 282:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_WIFI_DMA_SET_MEMORY_ADDRESS(SpiHandle.hdmatx, (uint32_t)DataHeader);
 283:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 284:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   return;
 285:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** }
 286:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 287:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 288:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void HTTP_Callback(void)
 289:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {
 290:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   if(WiFi_Control_Variables.enable_receive_file_response)
 291:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     ind_wifi_file_data_available((uint8_t *)dataBuff);
 292:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   else if(WiFi_Control_Variables.enable_receive_socket_list_response)
 293:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     ind_wifi_socket_list_data_available((uint8_t *)dataBuff);
 294:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   else
 295:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     ind_wifi_http_data_available((uint8_t *)dataBuff,payload_read_len);
 296:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   memset(dataBuff,0x00,sizeof dataBuff);
 297:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 298:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   if(packet_payload_data_available)
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 7


 299:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   {
 300:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       packet_payload_data_available = WIFI_FALSE;
 301:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       ResumePayloadReception();//only part of payload has been read and sent to user
 302:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   }
 303:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** }
 304:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 305:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void Socket_Callback(Socket_type_t Socket_Type)
 306:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {
 307:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   //Now callback to user with user_data pointer <UserDataBuff>   
 308:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   if(Socket_Type == CLIENT_NET_SOCKET)
 309:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     ind_wifi_socket_data_received(-1, WiFi_Counter_Variables.sockon_id_user, (uint8_t *)dataBuff, W
 310:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   else if(Socket_Type == CLIENT_WEB_SOCKET)
 311:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     ind_wifi_socket_data_received(-1, WiFi_Counter_Variables.sockon_id_user, (uint8_t *)dataBuff, W
 312:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   else
 313:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     ind_wifi_socket_data_received(WiFi_Counter_Variables.sockdon_id_user, WiFi_Counter_Variables.so
 314:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 315:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   memset(dataBuff, 0x00, WiFi_Counter_Variables.chunk_size);//Flush the buffer
 316:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   if(packet_payload_data_available)
 317:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   {
 318:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     packet_payload_data_available = WIFI_FALSE;
 319:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     ResumePayloadReception();//only part of payload has been read and sent to user
 320:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   }
 321:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** }
 322:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 323:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 324:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
 325:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @brief Tx and Rx Transfer completed callbacks
 326:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @param  None
 327:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @retval None
 328:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  */
 329:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #define DELAY_NEXT_HEADER_FETCH 1555555 /*MAGIC NUMBER!!!*/
 330:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 331:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void WiFi_DMA_RxCallback(void)
 332:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {
 333:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   uint8_t error_state;
 334:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   WiFi_Indication_t wind;
 335:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   static WiFi_Indication_t last_wind;
 336:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 337:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   #if DEBUG_PRINT
 338:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   uint8_t wifi_status;
 339:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   #endif
 340:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 341:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_CLEAR_FLAG(SpiHandle.hdmarx, WIFI_SPI_RX_DMA_TC_FLAG);
 342:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 343:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   /**
 344:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    * Clear TX TCIF just in case
 345:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    */
 346:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_CLEAR_FLAG(SpiHandle.hdmatx, WIFI_SPI_TX_DMA_TC_FLAG);
 347:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 348:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   switch (Spi_Receive_Event)
 349:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     {
 350:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case SPI_RECEIVED_HEADER_FOR_TX:
 351:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case SPI_RECEIVED_HEADER_FOR_RX:
 352:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         kind_of_event = (KIND_OF_EVENT_t)((Received_Header[1]>>4)&0xF);
 353:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         wind_no = Received_Header[2];
 354:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         wind = (WiFi_Indication_t)wind_no;
 355:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         sync = Received_Header[0];
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 8


 356:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 357:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         /*For the time being we are filtering out headers wth SYNC word as 0xB5/0xB7/0xFE/0x80/0xFF
 358:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         if(sync != 0x02 && ( (sync != 0x80 && sync != 0xFF && sync != 0xB5 && sync != 0xB6 && sync 
 359:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         && kind_of_event==SPI_INCOMING_DATA )) 
 360:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           kind_of_event = SPI_FRAME_ERROR;        
 361:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 362:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         switch(kind_of_event)
 363:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         {
 364:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           case  SPI_WIND_NOTIFICATION:
 365:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             payload_len = (Received_Header[4]<<8)|Received_Header[3];  
 366:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             #if DEBUG_PRINT
 367:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             wifi_status = (Received_Header[1])&0xF;
 368:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             #endif
 369:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 370:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             if(wind_no == 0x07) 
 371:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             {
 372:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 error_state = (Received_Header[4]<<8)|Received_Header[3];  
 373:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 #if DEBUG_PRINT
 374:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 printf("\r\n>> Configuration Failure no %d", error_state);
 375:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 #endif
 376:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             }
 377:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             #if DEBUG_PRINT
 378:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             if(wind_no != 49)
 379:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               printf("\r\n<<WIND %d, status %d\r\n", wind_no, wifi_status);
 380:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             #endif
 381:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             if (payload_len <= 0)
 382:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               {
 383:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   /* Go for the next header after processing the WIND*/
 384:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   Disable_SPI_CS();    
 385:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   ProcessEndOfReceive(SPI_WIND_PACKET, wind);
 386:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               }
 387:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               else
 388:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               {
 389:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   last_wind = wind;
 390:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   payload_to_read = payload_len;
 391:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   payload_read_len = 0;
 392:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   SPI_Receive_Manager(SPI_READ_PAYLOAD);	/**< Read the WIND Payload */
 393:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               }
 394:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             break;
 395:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 396:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           case SPI_INCOMING_DATA:
 397:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             payload_len = (Received_Header[4]<<8)|Received_Header[3];  
 398:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             error_state = Received_Header[2];//@TBD:Check if parsing is correct for Error!
 399:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 400:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             //Handle Data
 401:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             //Should be same as above switch case??
 402:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             if (payload_len <= 0  && (error_state == 0x00) /* || error_state == 0xFE || error_state
 403:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               {
 404:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** //                    printf("\r\n<<AT+S.OK\r\n");
 405:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     /* This is an OK event*/
 406:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     Disable_SPI_CS();  
 407:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     ProcessEndOfReceive(SPI_OK_PACKET, Invalid_Wind); 
 408:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 409:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     switch(IO_status_flag.AT_event_processing)
 410:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
 411:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_LIST_EVENT:
 412:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_TFTP_EVENT:
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 9


 413:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_HTTP_EVENT:
 414:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       if(WiFi_Control_Variables.Ok_terminated_data_request_pending == WIFI_TRUE)
 415:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       {
 416:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.Ok_terminated_data_request_pending = WIFI_FALSE;
 417:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.stop_event_dequeue = WIFI_FALSE;
 418:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Counter_Variables.sock_total_count = 0;
 419:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       }
 420:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       break;
 421:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_CLIENT_SOCKET_WRITE_EVENT:
 422:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_SERVER_SOCKET_WRITE_EVENT:
 423:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_CLIENT_WEB_SOCKET_WRITE_EVENT:
 424:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       /* Response of AT command recv; stop the timeout functionality */
 425:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       Stop_AT_CMD_Timer();
 426:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       break;
 427:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_SCAN_EVENT:
 428:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       WiFi_Counter_Variables.sock_total_count = 0;
 429:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       scan_ignore = 0;
 430:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       break;
 431:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_NO_EVENT:
 432:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       WiFi_Counter_Variables.sock_total_count = 0;
 433:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       #ifdef SPI_VCOM                          
 434:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         IO_status_flag.AT_vcom_processing = WIFI_NO_EVENT;
 435:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         IO_status_flag.AT_event_processing = WIFI_NO_EVENT;
 436:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       #endif
 437:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       break;
 438:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     default:
 439:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       break;
 440:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
 441:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     //In case there is follow-up action after this OK, do it here
 442:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     if(WiFi_Control_Variables.afterOK_start_sock_read == WIFI_TRUE)
 443:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
 444:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.afterOK_start_sock_read = WIFI_FALSE;
 445:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.stop_event_dequeue = WIFI_TRUE;//stop event de-queue
 446:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.start_sock_read = WIFI_TRUE;     
 447:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         return;
 448:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }                     
 449:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     else if(WiFi_Control_Variables.afterOK_enable_query == WIFI_TRUE)
 450:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     { 
 451:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         IO_status_flag.prevent_push_OK_event = WIFI_TRUE;//There's another OK comin
 452:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.stop_event_dequeue = WIFI_TRUE;//stop event de-queue
 453:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.afterOK_enable_query = WIFI_FALSE;
 454:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.enable_query = WIFI_TRUE;                        
 455:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         return;
 456:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
 457:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     else if(WiFi_Control_Variables.afterOK_start_sockd_read == WIFI_TRUE)
 458:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
 459:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.stop_event_dequeue = WIFI_TRUE;//stop event de-queue
 460:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.afterOK_start_sockd_read = WIFI_FALSE;
 461:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.start_sockd_read = WIFI_TRUE;                       
 462:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         return;
 463:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
 464:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     else if(WiFi_Control_Variables.afterOK_enable_server_query == WIFI_TRUE)
 465:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {                        
 466:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.stop_event_dequeue = WIFI_TRUE;//stop event de-queue
 467:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.afterOK_enable_server_query = WIFI_FALSE;
 468:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.enable_server_query = WIFI_TRUE;                    
 469:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         return;
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 10


 470:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     } 
 471:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     else if(WiFi_Control_Variables.afterOK_start_websock_read == WIFI_TRUE)
 472:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
 473:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.afterOK_start_websock_read = WIFI_FALSE;
 474:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.stop_event_dequeue = WIFI_TRUE;//stop event de-queue
 475:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.start_websock_read = WIFI_TRUE;                     
 476:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         return;
 477:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }                        
 478:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     else if(WiFi_Control_Variables.afterOK_enable_websock_query == WIFI_TRUE)
 479:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
 480:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.afterOK_enable_websock_query = WIFI_FALSE;
 481:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.stop_event_dequeue = WIFI_TRUE;//stop event de-queue
 482:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.enable_websocket_query = WIFI_TRUE;                 
 483:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         return;
 484:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
 485:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 486:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     IO_status_flag.AT_event_processing = WIFI_NO_EVENT;
 487:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     SPI_Tx_Transfer = WIFI_FALSE;//OK has arrived, so AT cmd is not ongoing now
 488:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               }
 489:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             else if (payload_len > 0)
 490:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               {
 491:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   #if DEBUG_PRINT
 492:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     //printf("<<payload_len:%d\r\n",payload_len);
 493:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   #endif
 494:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   switch(IO_status_flag.AT_event_processing)
 495:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   {
 496:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_CLIENT_SOCKET_QUERY_EVENT:
 497:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_SERVER_SOCKET_QUERY_EVENT:
 498:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_CLIENT_WEB_SOCKET_QUERY_EVENT:
 499:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                        /* Response of AT command recv; stop the timeout functionality */
 500:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       Stop_AT_CMD_Timer();
 501:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       payload_to_read = payload_len;
 502:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       payload_read_len = 0;
 503:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       break;
 504:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       
 505:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_CLIENT_SOCKET_READ_DATA:
 506:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_SERVER_SOCKET_READ_DATA:
 507:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_CLIENT_WEB_SOCKET_READ_DATA: 
 508:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       /* Response of AT command recv; stop the timeout functionality */
 509:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         Stop_AT_CMD_Timer();
 510:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       /* Actually more data is being recvd after Read command but we've requested f
 511:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                          Update the value of Socket_Data_Length with actual amount of bytes being r
 512:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       if(payload_len > WiFi_Counter_Variables.Socket_Data_Length)
 513:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Counter_Variables.Socket_Data_Length = payload_len;
 514:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       payload_to_read = payload_len;
 515:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       payload_read_len = 0;
 516:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       break;
 517:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_LIST_EVENT:
 518:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_TFTP_EVENT:  
 519:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     case WIFI_HTTP_EVENT:
 520:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       http_packet_len = payload_len;
 521:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     default:
 522:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       payload_to_read = payload_len;
 523:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       payload_read_len = 0;
 524:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       break;
 525:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   }
 526:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 11


 527:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     DisableEnable_SPI_CS(); 
 528:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     SPI_Receive_Manager(SPI_READ_DATA_PAYLOAD);	/**< Read the Data Packet Payload *
 529:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               }
 530:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             //else if (payload_len == 0 && error_state!= 0x00 && error_state!= 0xFE && error_state!
 531:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             else if (payload_len == 0 && error_state!= 0x00)//ignore 0xFE && 0xFF error number
 532:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               {
 533:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     //printf("\r\n<<Error Condition!!\r\n");                    
 534:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     Disable_SPI_CS(); 
 535:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     if(error_state== 0xFE || error_state== 0xFF)
 536:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
 537:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       #if DEBUG_PRINT
 538:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         printf("\r\n<<corrupted OK packet!!\r\n");
 539:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       #endif
 540:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       #ifdef SPI_VCOM
 541:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         ProcessEndOfReceive(SPI_IGNORE_PACKET, Invalid_Wind);
 542:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       #else
 543:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         ProcessEndOfReceive(SPI_IGNORE_PACKET, Invalid_Wind);//This was treated as 
 544:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       #endif
 545:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       break;
 546:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
 547:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 548:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     if(IO_status_flag.AT_event_processing == WIFI_CERT_WRITE_EVENT)
 549:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
 550:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       IO_status_flag.prevent_push_OK_event = WIFI_TRUE; //do not Q this OK as a pro
 551:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       //Process packet as OK
 552:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       ProcessEndOfReceive(SPI_OK_PACKET, Invalid_Wind);
 553:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
 554:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     else
 555:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       ProcessEndOfReceive(SPI_ERROR_PACKET, Invalid_Wind);
 556:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               }
 557:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             else
 558:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               {
 559:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     /* Go for the next header if there is any*/
 560:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     Disable_SPI_CS();   
 561:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     ProcessEndOfReceive(SPI_DATA_PACKET, Invalid_Wind); 
 562:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               }
 563:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             break;  
 564:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             
 565:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           case  SPI_ERROR_NOTIFICATION:
 566:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             Disable_SPI_CS(); 
 567:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             ProcessEndOfReceive(SPI_ERROR_PACKET, Invalid_Wind);
 568:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             break;
 569:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             
 570:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           case  SPI_FRAME_ERROR:
 571:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             //printf("Frame dump\r\n");
 572:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****              printf("\r\n Unknown packet 0x%x 0x%x 0x%x 0x%x 0x%x!!\r\n", Received_Header[0], Recei
 573:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             Disable_SPI_CS(); 
 574:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             ProcessEndOfReceive(SPI_IGNORE_PACKET, Invalid_Wind);
 575:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             break;
 576:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             
 577:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           default:
 578:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             /* Release CS line */
 579:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****              printf("\r\n Unknown packet 0x%x 0x%x 0x%x 0x%x 0x%x!!\r\n", Received_Header[0], Recei
 580:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             Disable_SPI_CS();    
 581:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             ProcessEndOfReceive(SPI_IGNORE_PACKET, Invalid_Wind);
 582:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             break;
 583:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         }
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 12


 584:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           memset(Received_Header, 0x00, HEADER_SIZE);
 585:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         break;
 586:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 587:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case SPI_RECEIVE_PAYLOAD_DATA:
 588:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           //Data or AT Cmd Payload 
 589:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           /*Next a header should arrive if there is more data*/
 590:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           Disable_SPI_CS();
 591:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           ProcessEndOfReceive(SPI_DATA_PAYLOAD_PACKET,Invalid_Wind);
 592:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 593:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         break;
 594:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       
 595:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case SPI_RECEIVE_INTERIM_PAYLOAD_DATA:   
 596:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         Process_Packet(SPI_DATA_INTERIM_PAYLOAD_PACKET,Invalid_Wind);//Set the events  
 597:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         break;
 598:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       
 599:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case SPI_RECEIVE_END:
 600:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         /* Release CS line */
 601:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         /*Data is in dataBuff*/
 602:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         Disable_SPI_CS();
 603:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 604:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         /* Proceed with next header */
 605:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         ProcessEndOfReceive(SPI_WIND_PAYLOAD_PACKET, last_wind);        
 606:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         break;
 607:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 608:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       default:
 609:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         break;
 610:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     }
 611:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** }
 612:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 613:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #define DELAY_PART_PAYLOAD_FETCH 1555555//200000 /*MAGIC NUMBER!!!*/
 614:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
 615:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @brief  Resume the payload reception which is not finished yet
 616:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @param  None
 617:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @retval None
 618:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  */
 619:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void ResumePayloadReception(void)
 620:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {
 621:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     //There is more data pending for this payload packet, so just fetch them
 622:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** //    DisableEnable_SPI_CS();
 623:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     //printf("\r\nresume_payload");
 624:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 625:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     SPI_Receive_Manager(SPI_READ_DATA_PAYLOAD);//no header coming for this case
 626:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** }
 627:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 628:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
 629:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @brief  Resume the packet header reception
 630:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @param  None
 631:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @retval None
 632:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  */
 633:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void ResumePacketReception(void)
 634:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {
 635:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   memset(dataBuff, 0x00, /*payload_len*/ SPI_READ_PACKET_SIZE);
 636:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 637:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   Enable_SPI_Receiving_Path();
 638:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 639:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   if (HAL_GPIO_ReadPin(WIFI_SPI_IRQ_PORT, WIFI_SPI_IRQ_PIN) == GPIO_PIN_RESET)
 640:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   {
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 13


 641:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_GPIO_EXTI_GENERATE_SWIT(WIFI_SPI_IRQ_PIN);
 642:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   } 
 643:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   else //line is low does not mean that there is no more data, as in cases handled below
 644:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   {
 645:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     switch(IO_status_flag.AT_event_processing)
 646:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       {
 647:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         case WIFI_NO_EVENT:
 648:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           #ifdef SPI_VCOM
 649:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           switch(IO_status_flag.AT_vcom_processing)
 650:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             {
 651:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               case WIFI_SCAN_EVENT:
 652:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 for (localloop = 0 ; localloop < 200 ; localloop++)//1555555
 653:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 {
 654:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   no_op(*(volatile uint32_t*)DUMMY_RAM_ADDRESS_TO_READ1);
 655:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 }
 656:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 __HAL_GPIO_EXTI_GENERATE_SWIT(WIFI_SPI_IRQ_PIN);
 657:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 break;
 658:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               
 659:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               default:
 660:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 break;
 661:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             }
 662:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           #endif
 663:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
 664:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 665:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         default:
 666:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
 667:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       } //switch
 668:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   } //else
 669:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** } //ResumePacketReception
 670:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 671:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 672:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
 673:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @brief  Close the receiver path
 674:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @param  None
 675:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @retval None
 676:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  */
 677:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void ReceiveClosure(void)
 678:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {
 679:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   /*
 680:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    *  Disable both DMA
 681:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    */
 682:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_DISABLE(SpiHandle.hdmatx);
 683:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_DISABLE(SpiHandle.hdmarx);
 684:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 685:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   return;
 686:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** }
 687:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 688:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
 689:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @brief  ProcessEndOfReceive
 690:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @param  kop : the kind of packet received
 691:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *         wind_no : the WIND number if applicable
 692:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @retval None
 693:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  */
 694:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void ProcessEndOfReceive(KIND_OF_PACKET_t kop, WiFi_Indication_t wind_no)
 695:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {  
 696:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   ReceiveClosure();
 697:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 14


 698:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   switch(IO_status_flag.AT_event_processing)
 699:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     {
 700:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WIFI_NO_EVENT:
 701:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         #ifdef SPI_VCOM
 702:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           switch(IO_status_flag.AT_vcom_processing)
 703:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           {
 704:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             case WIFI_SCAN_EVENT:
 705:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               for (localloop = 0 ; localloop < 1000 ; localloop++)//1555555
 706:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               {
 707:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 no_op(*(volatile uint32_t*)DUMMY_RAM_ADDRESS_TO_READ1);
 708:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               }
 709:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               __HAL_GPIO_EXTI_GENERATE_SWIT(WIFI_SPI_IRQ_PIN);
 710:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               break;
 711:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             default:
 712:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               for (localloop = 0 ; localloop < 1000 ; localloop++)//1555555
 713:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               {
 714:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 no_op(*(volatile uint32_t*)DUMMY_RAM_ADDRESS_TO_READ1);
 715:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               }
 716:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               break;
 717:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           }
 718:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         #endif
 719:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         break;
 720:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 721:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       default:
 722:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         break;
 723:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     }
 724:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 725:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   Process_Packet(kop, wind_no);//Set the events
 726:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   ResumePacketReception();
 727:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   return;
 728:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** }
 729:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 730:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
 731:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @brief  Tx and Rx Transfer completed callbacks
 732:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @param  None
 733:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @retval None
 734:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  */
 735:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void WiFi_DMA_TxCallback(void)
 736:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {
 737:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_CLEAR_FLAG(SpiHandle.hdmatx, WIFI_SPI_TX_DMA_TC_FLAG);
 738:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 739:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   switch (Spi_Transmit_Event)
 740:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   {
 741:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   case SPI_HEADER_TRANSMITTED:
 742:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     if(payload_size_to_transmit != 0)
 743:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     {
 744:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       SPI_Transmit_Manager(SPI_PAYLOAD_TRANSMIT);
 745:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     }
 746:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     else
 747:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     {
 748:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       TransmitClosure();      
 749:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     }
 750:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
 751:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 752:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   case SPI_PAYLOAD_TRANSMITTED:    
 753:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       TransmitClosure();
 754:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 15


 755:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 756:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   default:
 757:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
 758:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   } 
 759:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 760:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   return;
 761:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** }
 762:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 763:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 764:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
 765:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @brief  Set the SPI write parameters for DMA Tx
 766:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @param  header_data : pointer to header data if applicable
 767:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *         payload_data : pointer to payload data if applicable
 768:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *         header_size : header size
 769:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *         payload_size : payload size
 770:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @retval None
 771:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  */
 772:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void WiFi_SPI_Write(uint8_t* header_data, uint8_t* payload_data, uint8_t header_size, uint8_t paylo
 773:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {
 774:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   tx_header_data = header_data;
 775:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   tx_payload_data = payload_data;
 776:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   tx_header_size = header_size;
 777:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   tx_payload_size = payload_size;
 778:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 779:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   packet_cont = WIFI_FALSE;
 780:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 781:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   Disable_SPI_Receiving_Path();
 782:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 783:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   return;
 784:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** }
 785:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 786:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
 787:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** * @brief  Process_Packet
 788:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** *         Process the SPI Packet
 789:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** * @param  KIND_OF_PACKET_t: kind of packet
 790:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           wind_no: The wind number of the packet
 791:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** * @retval None
 792:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** */
 793:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void Process_Packet(KIND_OF_PACKET_t kop, WiFi_Indication_t wind_no)
 794:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {
 795:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   static uint8_t error_state;
 796:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   char * process_buffer_ptr = (char*)dataBuff; //stores the starting address of the payload.
 797:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   char SocketId_No[2];
 798:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   char * pStr, *token;
 799:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   static uint8_t sock_read_header_count=0;
 800:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 801:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   reset_event(&wifi_instances.wifi_event);
 802:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 803:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         switch(kop)
 804:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         {
 805:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         case SPI_WIND_PACKET:
 806:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         case SPI_WIND_PAYLOAD_PACKET:
 807:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 808:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           //if(kind_of_event==SPI_WIND_NOTIFICATION)
 809:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           {
 810:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               __disable_irq();
 811:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               Process_Wind_Payload(wind_no);
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 16


 812:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               __enable_irq();
 813:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               
 814:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               if(!WiFi_Control_Variables.prevent_push_WIFI_event)
 815:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 {
 816:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     __disable_irq();
 817:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     push_eventbuffer_queue(&wifi_instances.event_buff, wifi_instances.wifi_event);
 818:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                      __enable_irq();
 819:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     reset_event(&wifi_instances.wifi_event);
 820:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 }
 821:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               else if(!WiFi_Control_Variables.queue_wifi_wind_message)  //if we do not want to queu
 822:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 {
 823:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     reset_event(&wifi_instances.wifi_event);
 824:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     WiFi_Control_Variables.prevent_push_WIFI_event = WIFI_FALSE;
 825:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     WiFi_Control_Variables.queue_wifi_wind_message = WIFI_TRUE;
 826:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 827:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     if(WiFi_Control_Variables.mqtt_data_available)
 828:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
 829:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       int8_t client_id = -1;
 830:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       int length=0;
 831:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       int data_read =0, message_size =0,total_message_size=0 ;
 832:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       uint32_t length_of_data_to_read=0;
 833:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       
 834:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       memset(process_buffer,0x00,sizeof(process_buffer));
 835:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       sscanf(process_buffer_ptr,mqtt_string,&client_id,process_buffer,&message_size
 836:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       while(data_read < message_size)
 837:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       {
 838:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         length_of_data_to_read = ((message_size - data_read) > MAX_BUFFER_GLOBAL) ?
 839:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         pStr = (char *)(process_buffer_ptr + length);
 840:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         data_read+= length_of_data_to_read;
 841:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 842:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         if(data_read >= message_size)
 843:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         {
 844:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           ind_wifi_mqtt_data_received(client_id,process_buffer,length_of_data_to_re
 845:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           WiFi_Control_Variables.mqtt_data_available = WIFI_FALSE;
 846:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           memset(dma_buffer_ptr + WiFi_Counter_Variables.dma_buffer_previous_index,
 847:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           WiFi_Counter_Variables.dma_buffer_previous_index = WiFi_Counter_Variables
 848:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           break;
 849:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         }
 850:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         else if(data_read == MAX_BUFFER_GLOBAL)
 851:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         {
 852:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           ind_wifi_mqtt_data_received(client_id,process_buffer,MAX_BUFFER_GLOBAL,me
 853:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         }
 854:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       }
 855:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
 856:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 }
 857:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 858:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               if (!WiFi_Control_Variables.do_not_reset_push_WIFI_event) 
 859:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 WiFi_Control_Variables.prevent_push_WIFI_event = WIFI_FALSE;
 860:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 861:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               if(WiFi_Control_Variables.enable_sock_read)
 862:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 WiFi_Control_Variables.Q_Contains_Message = WIFI_FALSE;
 863:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               else
 864:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 return;
 865:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           }
 866:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
 867:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             
 868:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         case SPI_OK_PACKET:
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 17


 869:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 870:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           //Push a simple OK Event, if this is an OK event required to be pushed to Q
 871:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           if(IO_status_flag.prevent_push_OK_event)
 872:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               {
 873:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   //printf("\r\nOK not pushed!!!!!->>>");
 874:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   //This OK is not to be handled, hence the pop action on OK completion to be done 
 875:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   if(IO_status_flag.client_socket_close_ongoing) //OK received is of the sock close
 876:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
 877:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         if(WiFi_Counter_Variables.no_of_open_client_sockets > 0)
 878:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           WiFi_Counter_Variables.no_of_open_client_sockets--;
 879:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         IO_status_flag.prevent_push_OK_event                         = WIFI_FALSE;
 880:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         open_sockets[WiFi_Counter_Variables.remote_socket_closed_id] = WIFI_FALSE;
 881:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         //socket ID for which OK is received.
 882:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Counter_Variables.closed_socket_id                      = WiFi_Counter
 883:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         IO_status_flag.client_socket_close_ongoing                   = WIFI_FALSE;
 884:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         IO_status_flag.client_socket_close_type                      = NET_SOCKET;
 885:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         //User Callback not required in case if sock_close is called by User (Only 
 886:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         if(Client_Socket_Close_Callback[WiFi_Counter_Variables.closed_socket_id])
 887:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           {
 888:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             // User callback after successful socket Close
 889:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Control_Variables.SockON_Server_Closed_Callback = WIFI_TRUE;
 890:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             /*start de-Q only after the callback is successfully made*/
 891:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           }
 892:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         else
 893:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           {
 894:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             /* start de-Q only if we do not need a callback. */
 895:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             Client_Socket_Close_Callback[WiFi_Counter_Variables.closed_socket_id] =
 896:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Control_Variables.stop_event_dequeue = WIFI_FALSE;
 897:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           }
 898:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
 899:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   else if(IO_status_flag.web_socket_close_ongoing)
 900:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
 901:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         //socket ID for which OK is received.
 902:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Counter_Variables.closed_socket_id  = WiFi_Counter_Variables.remote_so
 903:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         IO_status_flag.web_socket_close_ongoing  = WIFI_FALSE;
 904:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         IO_status_flag.client_socket_close_type  = WEB_SOCKET;
 905:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         open_web_socket[WiFi_Counter_Variables.closed_socket_id] = WIFI_FALSE;
 906:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.SockON_Server_Closed_Callback = WIFI_TRUE; // User c
 907:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         /*start de-Q only after the callback is successfully made*/
 908:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
 909:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   else if(IO_status_flag.server_socket_close_ongoing)
 910:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
 911:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         if(WiFi_Control_Variables.close_complete_server_socket)
 912:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         {
 913:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           for(int i=0;i<8;i++)
 914:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             client_connected_on_server_socket[WiFi_Counter_Variables.remote_server_
 915:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           open_server_sockets[WiFi_Counter_Variables.remote_server_closed_id] = WIF
 916:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           WiFi_Control_Variables.close_complete_server_socket = WIFI_FALSE;
 917:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         }
 918:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         else
 919:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         {
 920:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           client_connected_on_server_socket[WiFi_Counter_Variables.remote_server_cl
 921:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           WiFi_Control_Variables.close_specific_client = WIFI_FALSE;
 922:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         }
 923:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.stop_event_dequeue    = WIFI_FALSE;
 924:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         IO_status_flag.server_socket_close_ongoing   = WIFI_FALSE;
 925:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 18


 926:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               }
 927:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           else
 928:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               {
 929:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 /* result of input ssi, do not queue Ok as Timx is disabled */
 930:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     if(WiFi_Control_Variables.fill_buffer_command_ongoing)
 931:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
 932:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       IO_status_flag.AT_Response_Received = WIFI_TRUE;
 933:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       WiFi_Counter_Variables.AT_RESPONSE = WiFi_MODULE_SUCCESS;
 934:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       IO_status_flag.AT_event_processing = WIFI_NO_EVENT;
 935:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       WiFi_Control_Variables.fill_buffer_command_ongoing = WIFI_FALSE;
 936:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
 937:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     else
 938:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
 939:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       if(WiFi_Control_Variables.Scan_Ongoing == WIFI_TRUE)//If Scan was ongoing
 940:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         {
 941:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           WiFi_Control_Variables.Scan_Ongoing = WIFI_FALSE; //Enable next scan     
 942:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           WiFi_Counter_Variables.scanned_ssids=0;
 943:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           IO_status_flag.AT_event_processing = WIFI_NO_EVENT;
 944:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         }
 945:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       //wifi_instances.wifi_event.ok_eval = WIFI_TRUE;
 946:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       wifi_instances.wifi_event.event = WIFI_OK_EVENT;
 947:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       __disable_irq();
 948:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       push_eventbuffer_queue(&wifi_instances.event_buff, wifi_instances.wifi_event)
 949:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                        __enable_irq();
 950:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       reset_event(&wifi_instances.wifi_event);
 951:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
 952:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     WiFi_Control_Variables.stop_event_dequeue = WIFI_FALSE;
 953:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               }
 954:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           if(sock_read_header_count!=0)
 955:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               {
 956:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 sock_read_header_count=0;
 957:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               }
 958:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           IO_status_flag.prevent_push_OK_event = WIFI_FALSE;
 959:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           
 960:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
 961:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 962:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         case SPI_DATA_PACKET:
 963:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         case SPI_DATA_PAYLOAD_PACKET:
 964:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               /*We have a payload with some data in it either from AT cmd reply or a Data packet (N
 965:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               if(SPI_Tx_Transfer)/*This is True while AT Cmd is ongoing*/
 966:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
 967:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       switch(IO_status_flag.AT_event_processing)
 968:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       {
 969:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_NO_EVENT:                        
 970:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         //printf(">>No evnt\r\n");
 971:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         #ifdef SPI_VCOM
 972:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           //Just copy the data into SPI VCOM buffer  
 973:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           memcpy(SPI_VCOM_Buff+WiFi_Counter_Variables.sock_total_count, dataBuff, p
 974:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           WiFi_Counter_Variables.sock_total_count = WiFi_Counter_Variables.sock_tot
 975:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         #endif         
 976:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         break;
 977:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_GPIO_EVENT:
 978:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         // AT+S.GPIOR
 979:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         token = strtok(process_buffer_ptr, ":");
 980:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         //just use the 2nd and 3rd token
 981:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         token = strtok(NULL, ":");
 982:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 19


 983:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Counter_Variables.gpio_value = *token - '0';
 984:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         token = strtok(NULL, ":");
 985:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Counter_Variables.gpio_dir= *token - '0';    //out
 986:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
 987:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         //No need to push event
 988:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         break;
 989:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
 990:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_GCFG_EVENT:
 991:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         /*Now Check to which AT Cmd response this OK belongs to so that correct par
 992:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         if((pStr = (char *)(strstr((const char *)process_buffer_ptr,"="))) != NULL)
 993:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                            {
 994:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               // AT command GCFG                    
 995:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               //we need to copy only the value in get_cfg_value variable
 996:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               if(*(pStr+1)!= 0x00)
 997:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                 memcpy(WiFi_Counter_Variables.get_cfg_value, pStr+1, (strlen(pStr))
 998:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               else
 999:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                 gcfg_data_broken = WIFI_TRUE;
1000:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               //No need to queue this since OK is following this which will be queu
1001:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                            }
1002:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         else if(gcfg_data_broken == WIFI_TRUE)
1003:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                            {
1004:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               gcfg_data_broken = WIFI_FALSE;
1005:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               memcpy(WiFi_Counter_Variables.get_cfg_value, process_buffer_ptr, (str
1006:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                            }
1007:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         break;
1008:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1009:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_SCAN_EVENT:
1010:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1011:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         if(scan_ignore) return;
1012:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         uint8_t scanned_ssids;
1013:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         char bss[100];
1014:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         scanned_ssids= WiFi_Counter_Variables.scanned_ssids;
1015:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         sscanf((const char*)&dataBuff,wifi_scan_string,&scanned_ssids,bss,&wifi_sca
1016:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                            &wifi_scanned_list[scanned_ssids].rssi,wifi_scanned_list
1017:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1018:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         pStr = (char *) strstr((const char *)&dataBuff,"WPA ");            
1019:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         if(pStr != NULL)
1020:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           {
1021:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               wifi_scanned_list[WiFi_Counter_Variables.scanned_ssids].sec_type.wpa 
1022:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           } else
1023:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               wifi_scanned_list[WiFi_Counter_Variables.scanned_ssids].sec_type.wpa 
1024:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       
1025:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         pStr = (char *) strstr((const char *)&dataBuff,"WPA2 ");            
1026:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         if(pStr != NULL)
1027:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           {
1028:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               wifi_scanned_list[WiFi_Counter_Variables.scanned_ssids].sec_type.wpa2
1029:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           } else
1030:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               wifi_scanned_list[WiFi_Counter_Variables.scanned_ssids].sec_type.wpa2
1031:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       
1032:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         pStr = (char *) strstr((const char *)&dataBuff,"WPS ");            
1033:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         if(pStr != NULL)
1034:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           {
1035:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               wifi_scanned_list[WiFi_Counter_Variables.scanned_ssids].sec_type.wps 
1036:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           } else
1037:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               wifi_scanned_list[WiFi_Counter_Variables.scanned_ssids].sec_type.wps 
1038:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1039:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Counter_Variables.scanned_ssids++;//increment total_networks
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 20


1040:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         if(WiFi_Counter_Variables.scanned_ssids==15) scan_ignore = 1;
1041:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       
1042:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         break;
1043:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1044:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_LIST_EVENT:
1045:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_TFTP_EVENT:
1046:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_HTTP_EVENT:                                            
1047:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1048:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         //sock_total_count used as http_total_count
1049:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Counter_Variables.sock_total_count = WiFi_Counter_Variables.sock_total
1050:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1051:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         //Check total length incoming and if greater than http_packet_len, callback
1052:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         /* This is the last part of complete data; now do a packet(header) receptio
1053:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         if(WiFi_Counter_Variables.sock_total_count >= http_packet_len)
1054:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         {
1055:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Control_Variables.enable_sock_read = WIFI_FALSE;
1056:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             http_packet_len = 0;
1057:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Counter_Variables.sock_total_count = 0;
1058:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         }
1059:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         /* code executes for all case
1060:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         -- case of (WiFi_Counter_Variables.sock_total_count < http_packet_len) 
1061:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                            when the packet breakage is such that size of payload/current chunk is 
1062:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                            less than the size of buffer and a large data is pending. -- */
1063:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         packet_payload_data_available = WIFI_FALSE;
1064:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         HTTP_Callback();
1065:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         break;
1066:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1067:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_MQTT_CONNECT_EVENT://WIFI_MQTT_EVENT:
1068:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             #if DEBUG_PRINT
1069:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               printf("\r\n MQTT ID recv \r\n");
1070:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             #endif
1071:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             SocketId_No[0] = process_buffer_ptr[0];
1072:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             /* Do not Queue the OK received, as the work done when ok event is deQ'
1073:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             IO_status_flag.prevent_push_OK_event = WIFI_TRUE;
1074:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             
1075:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             wifi_instances.wifi_event.socket_id = (SocketId_No[0] - '0');
1076:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             wifi_instances.wifi_event.event     =  WIFI_MQTT_ID_EVENT;
1077:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             __disable_irq();
1078:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             push_eventbuffer_queue(&wifi_instances.event_buff, wifi_instances.wifi_
1079:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                              __enable_irq();
1080:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             reset_event(&wifi_instances.wifi_event);
1081:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         break;
1082:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       
1083:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_CLIENT_WEB_SOCKET_OPEN_EVENT:
1084:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         // SOCKON ID (Open a client socket)
1085:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         //Reply to SOCKON for SPWF04 -> AT-S.On:<IP Address>:0
1086:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1087:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         //for secure socket first header is: AT-S.LOADING:1:2\r\n
1088:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         if(WiFi_Control_Variables.is_secure_socket && sock_read_header_count==0)//i
1089:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         {
1090:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           //do nothing with this header, what is the use of this header?
1091:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           IO_status_flag.AT_event_processing = WIFI_CLIENT_WEB_SOCKET_OPEN_EVENT;
1092:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           WiFi_Control_Variables.is_secure_socket = WIFI_FALSE;
1093:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           sock_read_header_count++;
1094:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           return;
1095:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         }
1096:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         else
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 21


1097:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         {
1098:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           //second header with AT-S.On:<IP Address>:0
1099:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           sock_read_header_count=0;
1100:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         }
1101:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         #if DEBUG_PRINT
1102:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         printf("\r\n Socket ID recv \r\n");
1103:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         #endif                        
1104:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         SocketId_No[0] = process_buffer_ptr[0];
1105:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1106:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         wifi_instances.wifi_event.socket_id = (SocketId_No[0] - '0');
1107:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         wifi_instances.wifi_event.event     =  WIFI_WEBSOCK_ID_EVENT;
1108:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         __disable_irq();
1109:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         push_eventbuffer_queue(&wifi_instances.event_buff, wifi_instances.wifi_even
1110:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                          __enable_irq();
1111:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         reset_event(&wifi_instances.wifi_event);
1112:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           break;
1113:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           
1114:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_CLIENT_SOCKET_OPEN_EVENT:
1115:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         // SOCKON ID (Open a client socket)
1116:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         //Reply to SOCKON for SPWF04 -> AT-S.On:<IP Address>:0
1117:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1118:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         //for secure socket first header is: AT-S.LOADING:1:2\r\n
1119:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         if(WiFi_Control_Variables.is_secure_socket && sock_read_header_count==0)//i
1120:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         {
1121:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           //do nothing with this header, what is the use of this header?
1122:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           IO_status_flag.AT_event_processing = WIFI_CLIENT_SOCKET_OPEN_EVENT;
1123:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           WiFi_Control_Variables.is_secure_socket = WIFI_FALSE;
1124:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           sock_read_header_count++;
1125:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           return;
1126:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         }
1127:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         else
1128:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         {
1129:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           //second header with AT-S.On:<IP Address>:0
1130:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           sock_read_header_count=0;
1131:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         }
1132:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         #if DEBUG_PRINT
1133:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         printf("\r\n Socket ID recv \r\n");
1134:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         #endif
1135:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         token = strtok(process_buffer_ptr, ":");
1136:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         //just use the second token
1137:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         token = strtok(NULL, ":");
1138:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1139:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         SocketId_No[0]    = *token ;
1140:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1141:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         wifi_instances.wifi_event.socket_id = (SocketId_No[0] - '0');
1142:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         wifi_instances.wifi_event.event     =  WIFI_SOCK_ID_EVENT;
1143:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         __disable_irq();
1144:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         push_eventbuffer_queue(&wifi_instances.event_buff, wifi_instances.wifi_even
1145:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                          __enable_irq();
1146:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         reset_event(&wifi_instances.wifi_event);
1147:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1148:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         break;
1149:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1150:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_SERVER_SOCKET_OPEN_EVENT:
1151:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1152:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         //<socket_id>->just the number arrives             
1153:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         SocketId_No[0]    = *(process_buffer_ptr + 0);
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 22


1154:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1155:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         wifi_instances.wifi_event.socket_id = (SocketId_No[0] - '0');
1156:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         wifi_instances.wifi_event.event     =  WIFI_SOCK_SERVER_ID_EVENT;
1157:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         __disable_irq();
1158:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         push_eventbuffer_queue(&wifi_instances.event_buff, wifi_instances.wifi_even
1159:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                          __enable_irq();
1160:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         reset_event(&wifi_instances.wifi_event);
1161:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         break;
1162:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1163:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_CLIENT_WEB_SOCKET_QUERY_EVENT:
1164:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_CLIENT_SOCKET_QUERY_EVENT:
1165:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         // DATALEN from SOCKQ, just the length
1166:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Counter_Variables.Socket_Data_Length = atoi((const char*)dataBuff);
1167:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1168:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         if(WiFi_Counter_Variables.Socket_Data_Length != 0)
1169:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           {
1170:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             if(IO_status_flag.AT_event_processing==WIFI_CLIENT_SOCKET_QUERY_EVENT)
1171:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               WiFi_Control_Variables.afterOK_start_sock_read = WIFI_TRUE;
1172:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             else if(IO_status_flag.AT_event_processing==WIFI_CLIENT_WEB_SOCKET_QUER
1173:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             {
1174:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               WiFi_Control_Variables.afterOK_start_websock_read = WIFI_TRUE;
1175:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             }
1176:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           }
1177:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         else if(WiFi_Counter_Variables.Socket_Data_Length == 0)  //no data remainin
1178:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           {
1179:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             if(WiFi_Counter_Variables.socket_close_pending[WiFi_Counter_Variables.s
1180:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               {
1181:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                 // Q socket_close event for that socket for which sock_close comman
1182:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                  if(open_sockets[WiFi_Counter_Variables.sockon_query_id])
1183:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                   {
1184:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                     Queue_Client_Close_Event(WiFi_Counter_Variables.sockon_query_id
1185:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                   }
1186:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                 WiFi_Counter_Variables.socket_close_pending[WiFi_Counter_Variables.
1187:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               }
1188:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Control_Variables.enable_sock_read = WIFI_FALSE;
1189:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Control_Variables.stop_event_dequeue = WIFI_FALSE;  //continue pop
1190:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           }
1191:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         IO_status_flag.AT_event_processing = WIFI_NO_EVENT;
1192:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         break;
1193:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1194:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_SERVER_SOCKET_QUERY_EVENT:
1195:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         //Find the DataLength and do a server socket read
1196:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Counter_Variables.Socket_Data_Length = atoi((const char*)dataBuff);
1197:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1198:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         if(WiFi_Counter_Variables.Socket_Data_Length != 0)
1199:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           {
1200:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Control_Variables.afterOK_start_sockd_read = WIFI_TRUE;
1201:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           }
1202:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         else if(WiFi_Counter_Variables.Socket_Data_Length == 0)  //no data remainin
1203:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           {
1204:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Control_Variables.enable_sock_read = WIFI_FALSE;
1205:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Control_Variables.stop_event_dequeue = WIFI_FALSE;  //continue pop
1206:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           }
1207:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           IO_status_flag.AT_event_processing = WIFI_NO_EVENT;   
1208:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         break;
1209:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1210:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_CLIENT_WEB_SOCKET_READ_DATA:
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 23


1211:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_CLIENT_SOCKET_READ_DATA:
1212:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_SERVER_SOCKET_READ_DATA:
1213:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         //This is the Raw Header from a Client SOCK Read
1214:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Counter_Variables.sock_total_count += payload_read_len;//payload_len i
1215:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1216:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         if(WiFi_Counter_Variables.sock_total_count >= WiFi_Counter_Variables.Socket
1217:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         {
1218:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             //printf("\r\nReached SockON len");
1219:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1220:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             Socket_type_t socket_type;
1221:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             /*@TODO: Do not need to prevent OK push in case of server socket*/
1222:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             IO_status_flag.prevent_push_OK_event = WIFI_TRUE; //prevent the qeueuin
1223:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Control_Variables.enable_sock_read = WIFI_FALSE;    
1224:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1225:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Counter_Variables.chunk_size = payload_read_len;
1226:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Counter_Variables.sockon_id_user = WiFi_Counter_Variables.sockon_q
1227:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Counter_Variables.message_size = WiFi_Counter_Variables.Socket_Dat
1228:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             packet_payload_data_available = WIFI_FALSE;
1229:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1230:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             //do we have more data?
1231:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             if(IO_status_flag.AT_event_processing == WIFI_CLIENT_SOCKET_READ_DATA)
1232:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             {
1233:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               WiFi_Control_Variables.afterOK_enable_query = WIFI_TRUE;
1234:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               socket_type = CLIENT_NET_SOCKET;
1235:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             }
1236:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             else if(IO_status_flag.AT_event_processing == WIFI_CLIENT_WEB_SOCKET_RE
1237:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             {
1238:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               WiFi_Control_Variables.afterOK_enable_websock_query = WIFI_TRUE;
1239:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               socket_type = CLIENT_WEB_SOCKET;
1240:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             }
1241:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             else if(IO_status_flag.AT_event_processing == WIFI_SERVER_SOCKET_READ_D
1242:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             {
1243:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                WiFi_Control_Variables.afterOK_enable_server_query = WIFI_TRUE;//ena
1244:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                WiFi_Counter_Variables.sockdon_id_user = WiFi_Counter_Variables.sock
1245:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                socket_type = SERVER_SOCKET;
1246:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             }
1247:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             
1248:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             IO_status_flag.AT_event_processing = WIFI_NO_EVENT;                    
1249:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Counter_Variables.sock_total_count = 0;
1250:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Counter_Variables.Socket_Data_Length = 0;
1251:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Counter_Variables.SockON_Data_Length = 0;
1252:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             Socket_Callback(socket_type);
1253:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         } else
1254:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           {
1255:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               WiFi_Counter_Variables.message_size       = WiFi_Counter_Variables.So
1256:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               WiFi_Counter_Variables.sockon_id_user     = WiFi_Counter_Variables.so
1257:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               WiFi_Counter_Variables.chunk_size         = payload_read_len;
1258:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               packet_payload_data_available             = WIFI_FALSE;
1259:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               
1260:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               if(IO_status_flag.AT_event_processing == WIFI_CLIENT_SOCKET_READ_DATA
1261:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                 Socket_Callback(CLIENT_NET_SOCKET);
1262:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               else if(IO_status_flag.AT_event_processing == WIFI_CLIENT_WEB_SOCKET_
1263:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                 Socket_Callback(CLIENT_WEB_SOCKET);
1264:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               else if(IO_status_flag.AT_event_processing == WIFI_SERVER_SOCKET_READ
1265:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               {
1266:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                 WiFi_Counter_Variables.sockdon_id_user = WiFi_Counter_Variables.soc
1267:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                 Socket_Callback(SERVER_SOCKET);
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 24


1268:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               }
1269:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           }
1270:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         break;
1271:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1272:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       case WIFI_FW_UPDATE_EVENT:
1273:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           
1274:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           //Just print something to indicate progress of data download!
1275:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           printf("*");
1276:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           //printf(dataBuff);
1277:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           fflush(stdout);
1278:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           
1279:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         break;
1280:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         
1281:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       default:
1282:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         break;
1283:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       }
1284:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     } //if(SPI_Tx_Transfer)
1285:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
1286:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           
1287:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         case SPI_DATA_INTERIM_PAYLOAD_PACKET:
1288:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 if(SPI_Tx_Transfer)/*This is True while AT Cmd is ongoing*/
1289:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
1290:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       switch(IO_status_flag.AT_event_processing)
1291:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         {
1292:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         case WIFI_LIST_EVENT:
1293:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         case WIFI_TFTP_EVENT:
1294:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         case WIFI_HTTP_EVENT:
1295:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           WiFi_Counter_Variables.sock_total_count += payload_read_len;
1296:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           packet_payload_data_available = WIFI_TRUE;
1297:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           HTTP_Callback();
1298:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           break;
1299:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           
1300:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           case WIFI_SERVER_SOCKET_READ_DATA:
1301:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           case WIFI_CLIENT_SOCKET_READ_DATA:
1302:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           case WIFI_CLIENT_WEB_SOCKET_READ_DATA:
1303:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Counter_Variables.sock_total_count += payload_read_len;
1304:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             Socket_type_t socket_type;
1305:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             if(IO_status_flag.AT_event_processing == WIFI_CLIENT_SOCKET_READ_DATA)
1306:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               socket_type = CLIENT_NET_SOCKET;
1307:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             else if(IO_status_flag.AT_event_processing == WIFI_CLIENT_WEB_SOCKET_RE
1308:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                               socket_type = CLIENT_WEB_SOCKET;
1309:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             else if(IO_status_flag.AT_event_processing == WIFI_SERVER_SOCKET_READ_D
1310:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             {
1311:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                WiFi_Counter_Variables.sockdon_id_user = WiFi_Counter_Variables.sock
1312:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                                socket_type = SERVER_SOCKET;
1313:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             }
1314:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1315:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Counter_Variables.sockon_id_user = WiFi_Counter_Variables.sockon_q
1316:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Counter_Variables.message_size = WiFi_Counter_Variables.Socket_Dat
1317:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             WiFi_Counter_Variables.chunk_size = payload_read_len;
1318:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             packet_payload_data_available = WIFI_TRUE;
1319:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             Socket_Callback(socket_type);
1320:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             break;     
1321:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                             
1322:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         default:
1323:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                           break;
1324:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         }
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 25


1325:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
1326:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
1327:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           
1328:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         case SPI_ERROR_PACKET:
1329:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           error_state = Received_Header[2];  
1330:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1331:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           #if defined(SPWF04) && !defined(CONSOLE_UART_ENABLED)
1332:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             #if DEBUG_PRINT
1333:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               if(error_state > NUM_ERROR_STATE) 
1334:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 printf("\r\nError: Unknown Error, no. 0x%x!\r\n", error_state);
1335:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               else
1336:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                 printf("\r\nError: %s\r\n", err_list[error_state]);
1337:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             #endif
1338:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           #endif
1339:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #ifdef SPI_VCOM
1340:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           printf("\r\nError: %s\r\n", err_list[error_state]);
1341:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #endif
1342:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             switch(error_state)
1343:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             {
1344:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             case MISSING_ARGS:
1345:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             case VAR_NOT_FOUND:
1346:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             case TOO_MANY_ARGS:
1347:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             case INVALID_ARGS:
1348:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             case REQUEST:/*FAILURE*/
1349:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               if(SPI_Tx_Transfer)/*This is True while some User / AT Cmd is ongoing*/
1350:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               {
1351:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   if(WiFi_Control_Variables.fill_buffer_command_ongoing)
1352:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   {
1353:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     IO_status_flag.AT_Response_Received = WIFI_TRUE;
1354:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     WiFi_Counter_Variables.AT_RESPONSE  = WiFi_MODULE_SUCCESS;
1355:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     IO_status_flag.AT_event_processing  = WIFI_NO_EVENT;
1356:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     WiFi_Control_Variables.fill_buffer_command_ongoing = WIFI_FALSE;
1357:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     return;
1358:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   }
1359:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   wifi_instances.wifi_event.event = WIFI_ERROR_EVENT;
1360:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   __disable_irq();
1361:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   push_eventbuffer_queue(&wifi_instances.event_buff, wifi_instances.wifi_event);
1362:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                    __enable_irq();
1363:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   reset_event(&wifi_instances.wifi_event);
1364:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   if(WiFi_Control_Variables.stop_event_dequeue)
1365:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     /*ERROR:Illegal Socket ID*/
1366:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     WiFi_Control_Variables.stop_event_dequeue = WIFI_FALSE;//continue popping event
1367:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   if(WiFi_Control_Variables.enable_timeout_timer)
1368:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
1369:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       WiFi_Control_Variables.enable_timeout_timer = WIFI_FALSE;
1370:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       WiFi_Counter_Variables.timeout_tick = 0;
1371:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
1372:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   if(WiFi_Control_Variables.enable_receive_file_response)
1373:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
1374:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       WiFi_Control_Variables.enable_receive_file_response = WIFI_FALSE;
1375:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
1376:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   if(WiFi_Control_Variables.enable_receive_socket_list_response)
1377:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
1378:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       WiFi_Control_Variables.enable_receive_socket_list_response = WIFI_FALSE;
1379:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
1380:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   SPI_Tx_Transfer = WIFI_FALSE;
1381:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               }
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 26


1382:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               break;
1383:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             case OPEN_SOCK:
1384:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             default:
1385:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   if(WiFi_Control_Variables.fill_buffer_command_ongoing)
1386:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   {
1387:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     IO_status_flag.AT_Response_Received = WIFI_TRUE;
1388:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     WiFi_Counter_Variables.AT_RESPONSE  = WiFi_MODULE_SUCCESS;
1389:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     IO_status_flag.AT_event_processing  = WIFI_NO_EVENT;
1390:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     WiFi_Control_Variables.fill_buffer_command_ongoing = WIFI_FALSE;
1391:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     return;
1392:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   }
1393:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   wifi_instances.wifi_event.event = WIFI_ERROR_EVENT;
1394:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   __disable_irq();
1395:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   push_eventbuffer_queue(&wifi_instances.event_buff, wifi_instances.wifi_event);
1396:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                    __enable_irq();
1397:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   reset_event(&wifi_instances.wifi_event);
1398:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   if(WiFi_Control_Variables.stop_event_dequeue)
1399:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     /*ERROR:Illegal Socket ID*/
1400:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     WiFi_Control_Variables.stop_event_dequeue = WIFI_FALSE;//continue popping event
1401:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   if(SPI_Tx_Transfer && WiFi_Control_Variables.enable_sock_read != WIFI_TRUE)/*This
1402:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   {
1403:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     SPI_Tx_Transfer = WIFI_FALSE;
1404:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   }
1405:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   if (WiFi_Control_Variables.enable_sock_read == WIFI_TRUE)
1406:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   {       
1407:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       WiFi_Control_Variables.enable_sock_read = WIFI_FALSE;
1408:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   }
1409:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   if(WiFi_Control_Variables.enable_timeout_timer)
1410:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     {
1411:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       WiFi_Control_Variables.enable_timeout_timer = WIFI_FALSE;
1412:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       WiFi_Counter_Variables.timeout_tick = 0;
1413:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                     }
1414:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   if(WiFi_Control_Variables.Ok_terminated_data_request_pending == WIFI_TRUE)
1415:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       {
1416:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.Ok_terminated_data_request_pending = WIFI_FALSE;
1417:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                         WiFi_Control_Variables.stop_event_dequeue = WIFI_FALSE;
1418:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                       }
1419:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****                   
1420:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****               break;
1421:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             }
1422:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             break;
1423:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             
1424:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         case SPI_IGNORE_PACKET:
1425:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             /*Do nothing with this packet*/
1426:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             break;
1427:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         default:
1428:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             break;
1429:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         }
1430:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** }
1431:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1432:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
1433:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** * @brief  Process_Wind_Payload
1434:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** *         Process the WIND packet and prepare the event to be pushed to event Q as applicable
1435:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** * @param  wind_no: The wind number of the packet
1436:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** * @retval None
1437:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** */
1438:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void Process_Wind_Payload(WiFi_Indication_t wind_no)
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 27


1439:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {
1440:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   char * process_buffer_ptr = (char*)dataBuff; //stores the starting address of the payload.
1441:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   char databytes_No[4]; 
1442:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   char *token;
1443:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
1444:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #if DEBUG_PRINT
1445:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   //printf(" \r\n");
1446:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   //printf((const char*)dataBuff);
1447:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   //fflush(stdout);
1448:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #endif
1449:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   int i;
1450:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1451:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   WiFi_Indication_t Wind_No = (WiFi_Indication_t)wind_no;
1452:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   wifi_instances.wifi_event.wind = Wind_No;
1453:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   wifi_instances.wifi_event.event = WIFI_WIND_EVENT;
1454:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1455:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   switch (Wind_No)
1456:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   {
1457:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case SockON_Data_Pending: /*WIND:55*/         
1458:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           /*+WIND:55:Pending Data:<ServerID>:<ClientID>:<received_bytes>:<cumulated_bytes>*/       
1459:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           if(*(process_buffer_ptr + 0) == ':')//means it is a client socket WIND:55
1460:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           {
1461:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             /*Need to find out which socket ID has data pending*/
1462:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             databytes_No[0] = *(process_buffer_ptr + 1);
1463:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1464:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             wifi_instances.wifi_event.socket_id = (databytes_No[0] - '0'); //Max number of sockets 
1465:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             wifi_instances.wifi_event.server_id = 9;
1466:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           }
1467:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           else //it is a server socket ID
1468:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           {
1469:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             /*Need to find out which server socket ID has data pending*/
1470:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             databytes_No[0] = *(process_buffer_ptr + 0);//Server Socket ID
1471:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             databytes_No[1] = *(process_buffer_ptr + 2);//Client ID Connected to this socket
1472:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             wifi_instances.wifi_event.server_id = (databytes_No[0] - '0'); //Max number of server s
1473:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             wifi_instances.wifi_event.socket_id = (databytes_No[1] - '0');//Each server socket can 
1474:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           }
1475:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
1476:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1477:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case SockON_Server_Socket_Closed:
1478:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           /*<Client_ID>:<Closure_Reason>*/
1479:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           //Find the id of the socket closed          
1480:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           token = strtok(process_buffer_ptr, ":");//just use the 1st token
1481:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           databytes_No[0] = *token ;
1482:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           token = strtok(NULL, ":");
1483:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           databytes_No[1] = *token ;
1484:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           wifi_instances.wifi_event.socket_id = databytes_No[0] - '0'; //Max number of sockets is 8
1485:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           //@TBD: CHECK!!!!
1486:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           //wifi_instances.wifi_event.closure_reason = databytes_No[1] - '0';
1487:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;                
1488:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1489:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi__MiniAP_Associated:
1490:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           //Find out which client joined by parsing the WIND //+WIND:28
1491:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           for(i=0;i<=16;i++)
1492:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             WiFi_Counter_Variables.client_MAC_address[i] = *(process_buffer_ptr + i) ;    
1493:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           IO_status_flag.WiFi_WIND_State = WiFiAPClientJoined;
1494:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
1495:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 28


1496:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_MiniAP_Disassociated:
1497:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           //Find out which client left by parsing the WIND //+WIND:72
1498:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           for(i=0;i<=16;i++)
1499:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             WiFi_Counter_Variables.client_MAC_address[i] = *(process_buffer_ptr + i) ;
1500:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           IO_status_flag.WiFi_WIND_State = WiFiAPClientLeft;
1501:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
1502:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Incoming_socket_client:
1503:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           //<IP-Address>:<HeapSize?>:<ServerID?>:<ClientID?>
1504:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           token = strtok(process_buffer_ptr, ":");
1505:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           token = strtok(NULL, ":");
1506:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           token = strtok(NULL, ":");
1507:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           databytes_No[0] = *token ;
1508:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           token = strtok(NULL, ":");
1509:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           databytes_No[1] = *token ;
1510:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           wifi_instances.wifi_event.server_id = (databytes_No[0] - '0'); //Server ID. Max number of
1511:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           wifi_instances.wifi_event.socket_id = (databytes_No[1] - '0');//This is the client ID con
1512:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           //@TBD: Map IP Address to client number
1513:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
1514:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Outgoing_socket_client:
1515:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           //Find out which client left on which server ID.
1516:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         //<Client-IP-Address>:<HeapSize?>:<ServerID?>:<ClientID?>:<Closure Reason>
1517:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           token = strtok(process_buffer_ptr, ":");
1518:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           token = strtok(NULL, ":");
1519:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           token = strtok(NULL, ":");
1520:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           databytes_No[0] = *token ;
1521:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           token = strtok(NULL, ":");
1522:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           databytes_No[1] = *token ;
1523:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           wifi_instances.wifi_event.server_id = (databytes_No[0] - '0'); //Server ID on which clien
1524:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           wifi_instances.wifi_event.socket_id = (databytes_No[1] - '0');//This is the client ID whi
1525:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
1526:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
1527:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Remote_Configuration:
1528:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           wifi_connected = 0;
1529:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           WiFi_Control_Variables.queue_wifi_wind_message = WIFI_FALSE;
1530:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           WiFi_Control_Variables.prevent_push_WIFI_event = WIFI_TRUE;
1531:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
1532:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           
1533:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Going_Into_Standby:
1534:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           wifi_instances.wifi_event.event = WIFI_STANDBY_CONFIG_EVENT;
1535:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           WiFi_Control_Variables.in_standby_mode = WIFI_TRUE;
1536:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
1537:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           
1538:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Resuming_From_Standby:
1539:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           wifi_instances.wifi_event.event = WIFI_RESUME_CONFIG_EVENT;
1540:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           WiFi_Control_Variables.in_standby_mode = WIFI_FALSE;
1541:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
1542:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #if defined(SPWF04)
1543:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Configuration_Failure:  
1544:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           //Configuration Error Reason (1 - 10)
1545:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           databytes_No[0] = *(process_buffer_ptr + 0);
1546:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           databytes_No[1] = *(process_buffer_ptr + 1);//Max two digits
1547:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           
1548:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           //@TBD:What to do with this number now?
1549:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
1550:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #endif          
1551:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       /*
1552:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       SockD_Dropping_Client         = 83,
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 29


1553:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       NTP_Server_Delivery           = 84,
1554:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       MQTT_Published                = 86,
1555:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       MQTT_Closed                   = 87,
1556:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       Websocket_Data                = 88,
1557:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       Websocket_Closed              = 89,
1558:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       UDP_Broadcast_Received        = 90,
1559:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       TFTP_File_Received            = 91,
1560:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       */
1561:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       
1562:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Websocket_Data:
1563:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           /*A websocket pending event has arrived*/
1564:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           /*<ClientID>:<last_frame_flag?>:<last_frag_flag?>:<rcv_bytes>:<cumulated_bytes>*/ 
1565:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           databytes_No[0] = *(process_buffer_ptr + 0);
1566:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           wifi_instances.wifi_event.socket_id = (databytes_No[0] - '0');//This is the websocket cli
1567:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
1568:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           
1569:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Websocket_Closed:
1570:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           /*<Client_ID>*/
1571:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           //Find the id of the socket closed
1572:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           databytes_No[0] = *(process_buffer_ptr + 0);
1573:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           wifi_instances.wifi_event.socket_id = databytes_No[0] - '0'; //Max number of web-sockets 
1574:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
1575:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         
1576:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Input_To_Remote:
1577:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         /* Disable TIMx   */
1578:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         HAL_NVIC_DisableIRQ(TIMx_IRQn);
1579:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         ind_wifi_inputssi_callback();
1580:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         WiFi_Control_Variables.queue_wifi_wind_message = WIFI_FALSE;
1581:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         WiFi_Control_Variables.prevent_push_WIFI_event = WIFI_TRUE;
1582:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         break;
1583:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         
1584:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Output_From_Remote: ;
1585:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         /* length of text to be received is 40 or lesss*/
1586:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         int bytes_read;
1587:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         sscanf(process_buffer_ptr,"%*d:%n",&bytes_read);
1588:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         ind_wifi_output_from_remote_callback((uint8_t *)process_buffer_ptr+bytes_read);
1589:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         break;
1590:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         
1591:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case MQTT_Closed:
1592:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         /*+WIND:87:MQTT Closed:<Client ID> */
1593:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         wifi_instances.wifi_event.socket_id = ((*process_buffer_ptr) - '0');//This is the MQTT clie
1594:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         break;
1595:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1596:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       // Queueing of following events not required.
1597:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case MQTT_Published:
1598:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           WiFi_Control_Variables.mqtt_data_available = WIFI_TRUE;
1599:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Console_Active:
1600:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_Reset:
1601:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Watchdog_Running:
1602:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Watchdog_Terminating:
1603:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case CopyrightInfo:
1604:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_BSS_Regained:
1605:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_Signal_OK:
1606:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case FW_update:
1607:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Encryption_key_Not_Recognized:
1608:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_Join:
1609:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_Scanning:
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 30


1610:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_Association_Successful:
1611:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_BSS_LOST:
1612:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_NETWORK_LOST:
1613:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_Unhandled_Event:
1614:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_UNHANDLED:
1615:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_MiniAP_Mode :
1616:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case DOT11_AUTHILLEGAL:
1617:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Creating_PSK:
1618:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WPA_Supplicant_Failed:
1619:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WPA_Handshake_Complete:
1620:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case GPIO_line:
1621:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Factory_debug:
1622:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Rejected_Found_Network:
1623:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case TFTP_File_Received:
1624:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           WiFi_Control_Variables.queue_wifi_wind_message = WIFI_FALSE;
1625:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           WiFi_Control_Variables.prevent_push_WIFI_event = WIFI_TRUE;
1626:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
1627:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1628:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         //Queue these Events.
1629:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Poweron:
1630:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case MallocFailed:                                          
1631:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           if(WiFi_Control_Variables.stop_event_dequeue)
1632:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****             WiFi_Control_Variables.stop_event_dequeue = WIFI_FALSE;
1633:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****           break;
1634:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       
1635:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Low_Power_Mode_Enabled:
1636:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Wakeup:
1637:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****         //comes just before WIND:70: resume from deepsleep
1638:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_Up:
1639:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WPA_Terminated:
1640:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Heap_Too_Small:            
1641:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_Hardware_Dead:
1642:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Hard_Fault:
1643:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case StackOverflow:                   
1644:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Error:
1645:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_PS_Mode_Failure:
1646:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_Signal_LOW:
1647:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case JOINFAILED:
1648:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case SCANBLEWUP:
1649:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case SCANFAILED:
1650:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_Started_MiniAP_Mode:
1651:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Start_Failed :
1652:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_EXCEPTION :
1653:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_Hardware_Started :
1654:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case Scan_Complete:
1655:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_UNHANDLED_IND:
1656:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_Powered_Down:
1657:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_Deauthentication:
1658:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case WiFi_Disassociation:
1659:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case RX_MGMT:
1660:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case RX_DATA:
1661:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case RX_UNK:
1662:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       case NTP_Server_Delivery:
1663:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****            break;
1664:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       default:
1665:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****            break;
1666:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     }
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 31


1667:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   if(!WiFi_Control_Variables.mqtt_data_available)
1668:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     memset(process_buffer_ptr, 0x00, MAX_BUFFER_GLOBAL);
1669:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1670:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** }
1671:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1672:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #endif
1673:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1674:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /*
1675:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** E.g.
1676:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** AT command: AT+S.SCAN=d,/scan.txt
1677:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 1)	Command ID: 0x33
1678:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 2)	Number of parameters: 0x02
1679:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** First Parameter: 0x01,S
1680:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** Second Parameter: 0x09,(/scan.txt)
1681:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 3)	Full message payload length: 0x0D
1682:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** Result. SPI Message: 0x02 0x00 0x0D 0x33 0x02 0x01 S 0x09 (/scan.txt)
1683:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1684:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** AT+S.SCFG=console_enabled,0
1685:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 0x02 0x00 0x0D 0x0A 0x02 0x0F (console_enabled) 0x01 0x00
1686:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** */
1687:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /* SPI DMA Transmit*/
1688:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void SPI_Send_AT_Command(int offset, int mode)
1689:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {
1690:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   tx_payload_data = WiFi_SPI_Packet;  
1691:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
1692:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #if DEBUG_PRINT
1693:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   //printf("\r\n>>AT\r\n");
1694:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   printf("\r\n>>%s\r\n", get_cmd_string(WiFi_SPI_Packet[3]));
1695:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** #endif
1696:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   payload_size_to_transmit = offset;  
1697:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
1698:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   switch (mode)
1699:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   {
1700:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   case SPI_POLL:
1701:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     SPI_Transmit_Manager_Poll(tx_payload_data, payload_size_to_transmit);
1702:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
1703:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   case SPI_DMA:
1704:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     SPI_Transmit_Manager(SPI_PAYLOAD_TRANSMIT);
1705:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
1706:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   case SPI_IT:
1707:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     //not supported yet
1708:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;  
1709:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   }
1710:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** }
1711:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1712:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
1713:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @brief  Manage the SPI transmit in polling mode
1714:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @param  None
1715:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @retval None
1716:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  */
1717:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void SPI_Transmit_Manager_Poll(uint8_t * Data, uint32_t DataLen)
1718:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {   
1719:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   Disable_SPI_Receiving_Path();
1720:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
1721:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   Enable_SPI_CS();
1722:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
1723:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   if(HAL_SPI_Transmit(&SpiHandle, Data, DataLen, 1000)== HAL_OK)
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 32


1724:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   {
1725:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****       TransmitClosure();
1726:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   }
1727:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** }
1728:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1729:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
1730:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @brief  Manage the SPI transmit
1731:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @param  TransmitRequest: the transmit request
1732:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @retval None
1733:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  */
1734:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void SPI_Transmit_Manager(SPI_TRANSMIT_REQUEST_t TransmitRequest)
1735:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {   
  48              		.loc 1 1735 0
  49              		.cfi_startproc
  50              		@ args = 0, pretend = 0, frame = 0
  51              		@ frame_needed = 0, uses_anonymous_args = 0
  52              	.LVL1:
  53              		.loc 1 1735 0
  54 0000 10B5     		push	{r4, lr}
  55              	.LCFI0:
  56              		.cfi_def_cfa_offset 8
  57              		.cfi_offset 4, -8
  58              		.cfi_offset 14, -4
  59 0002 0446     		mov	r4, r0
1736:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   Disable_SPI_Receiving_Path();
  60              		.loc 1 1736 0
  61 0004 FFF7FEFF 		bl	Disable_SPI_Receiving_Path
  62              	.LVL2:
1737:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
1738:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   Enable_SPI_CS();//Enable nCS (Chip Select) 
  63              		.loc 1 1738 0
  64 0008 FFF7FEFF 		bl	Enable_SPI_CS
  65              	.LVL3:
1739:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
1740:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   /*
1741:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    *  Disable both DMA
1742:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    */
1743:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_DISABLE(SpiHandle.hdmatx);
  66              		.loc 1 1743 0
  67 000c 3D4B     		ldr	r3, .L12
  68 000e 9A6C     		ldr	r2, [r3, #72]
  69 0010 1168     		ldr	r1, [r2]
  70 0012 0A68     		ldr	r2, [r1]
  71 0014 22F00102 		bic	r2, r2, #1
  72 0018 0A60     		str	r2, [r1]
1744:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_DISABLE(SpiHandle.hdmarx);
  73              		.loc 1 1744 0
  74 001a DA6C     		ldr	r2, [r3, #76]
  75 001c 1168     		ldr	r1, [r2]
  76 001e 0A68     		ldr	r2, [r1]
  77 0020 22F00102 		bic	r2, r2, #1
  78 0024 0A60     		str	r2, [r1]
1745:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
1746:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_DISABLE_IT(SpiHandle.hdmarx, DMA_IT_TC); /**< Disable Receive packet notification */
  79              		.loc 1 1746 0
  80 0026 DA6C     		ldr	r2, [r3, #76]
  81 0028 1168     		ldr	r1, [r2]
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 33


  82 002a 0A68     		ldr	r2, [r1]
  83 002c 22F01002 		bic	r2, r2, #16
  84 0030 0A60     		str	r2, [r1]
1747:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
1748:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_CLEAR_FLAG(SpiHandle.hdmatx, WIFI_SPI_TX_DMA_TC_FLAG); /**< Clear flag in DMA */
  85              		.loc 1 1748 0
  86 0032 9B6C     		ldr	r3, [r3, #72]
  87 0034 1B68     		ldr	r3, [r3]
  88 0036 344A     		ldr	r2, .L12+4
  89 0038 9342     		cmp	r3, r2
  90 003a 20D9     		bls	.L3
  91              		.loc 1 1748 0 is_stmt 0 discriminator 1
  92 003c 4FF00062 		mov	r2, #134217728
  93 0040 324B     		ldr	r3, .L12+8
  94 0042 DA60     		str	r2, [r3, #12]
  95              	.L4:
1749:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 	HAL_NVIC_ClearPendingIRQ(WIFI_SPI_DMA_TX_IRQn); /**< Clear DMA pending bit in NVIC */
  96              		.loc 1 1749 0 is_stmt 1
  97 0044 3B20     		movs	r0, #59
  98 0046 FFF7FEFF 		bl	HAL_NVIC_ClearPendingIRQ
  99              	.LVL4:
1750:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_ENABLE_IT(SpiHandle.hdmatx, DMA_IT_TC);	/**< Enable Transmit packet notification */
 100              		.loc 1 1750 0
 101 004a 2E4A     		ldr	r2, .L12
 102 004c 936C     		ldr	r3, [r2, #72]
 103 004e 1968     		ldr	r1, [r3]
 104 0050 0B68     		ldr	r3, [r1]
 105 0052 43F01003 		orr	r3, r3, #16
 106 0056 0B60     		str	r3, [r1]
1751:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
1752:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_WIFI_DMA_SET_MINC(SpiHandle.hdmatx); /**< Configure DMA to send Tx packet */
 107              		.loc 1 1752 0
 108 0058 936C     		ldr	r3, [r2, #72]
 109 005a 1A68     		ldr	r2, [r3]
 110 005c 1368     		ldr	r3, [r2]
 111 005e 43F48063 		orr	r3, r3, #1024
 112 0062 1360     		str	r3, [r2]
1753:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
1754:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   switch (TransmitRequest)
 113              		.loc 1 1754 0
 114 0064 012C     		cmp	r4, #1
 115 0066 2ED0     		beq	.L8
 116 0068 F4B1     		cbz	r4, .L9
 117 006a 022C     		cmp	r4, #2
 118 006c 3AD0     		beq	.L10
 119              	.L7:
1755:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   {
1756:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   case SPI_HEADER_TRANSMIT:
1757:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     Spi_Transmit_Event = SPI_HEADER_TRANSMITTED;
1758:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
1759:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_COUNTER(SpiHandle.hdmatx, tx_header_size); /**< Set counter in DMA TX */
1760:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_MEMORY_ADDRESS(SpiHandle.hdmatx, (uint32_t)tx_header_data); /**< Set memory 
1761:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
1762:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
1763:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   case SPI_PAYLOAD_TRANSMIT:
1764:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     Spi_Transmit_Event = SPI_PAYLOAD_TRANSMITTED;
1765:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 34


1766:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_COUNTER(SpiHandle.hdmatx, payload_size_to_transmit); /**< Set counter in DMA
1767:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_MEMORY_ADDRESS(SpiHandle.hdmatx, (uint32_t)tx_payload_data); /**< Set memory
1768:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
1769:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
1770:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   case SPI_WRITE_PAYLOAD_TRANSMIT:
1771:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     Spi_Transmit_Event = SPI_PAYLOAD_TRANSMITTED;
1772:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
1773:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_COUNTER(SpiHandle.hdmatx, WiFi_Counter_Variables.curr_DataLength); /**< Set 
1774:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_MEMORY_ADDRESS(SpiHandle.hdmatx, (uint32_t)WiFi_Counter_Variables.curr_data)
1775:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
1776:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
1777:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   default:
1778:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
1779:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   }
1780:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
1781:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_ENABLE(SpiHandle.hdmatx); /**< Enable DMA TX */
 120              		.loc 1 1781 0
 121 006e 254B     		ldr	r3, .L12
 122 0070 9B6C     		ldr	r3, [r3, #72]
 123 0072 1A68     		ldr	r2, [r3]
 124 0074 1368     		ldr	r3, [r2]
 125 0076 43F00103 		orr	r3, r3, #1
 126 007a 1360     		str	r3, [r2]
 127 007c 10BD     		pop	{r4, pc}
 128              	.L3:
1748:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 	HAL_NVIC_ClearPendingIRQ(WIFI_SPI_DMA_TX_IRQn); /**< Clear DMA pending bit in NVIC */
 129              		.loc 1 1748 0 discriminator 2
 130 007e 244A     		ldr	r2, .L12+12
 131 0080 9342     		cmp	r3, r2
 132 0082 04D9     		bls	.L5
1748:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 	HAL_NVIC_ClearPendingIRQ(WIFI_SPI_DMA_TX_IRQn); /**< Clear DMA pending bit in NVIC */
 133              		.loc 1 1748 0 is_stmt 0 discriminator 3
 134 0084 4FF00062 		mov	r2, #134217728
 135 0088 204B     		ldr	r3, .L12+8
 136 008a 9A60     		str	r2, [r3, #8]
 137 008c DAE7     		b	.L4
 138              	.L5:
1748:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 	HAL_NVIC_ClearPendingIRQ(WIFI_SPI_DMA_TX_IRQn); /**< Clear DMA pending bit in NVIC */
 139              		.loc 1 1748 0 discriminator 4
 140 008e 214A     		ldr	r2, .L12+16
 141 0090 9342     		cmp	r3, r2
 142 0092 04D9     		bls	.L6
1748:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 	HAL_NVIC_ClearPendingIRQ(WIFI_SPI_DMA_TX_IRQn); /**< Clear DMA pending bit in NVIC */
 143              		.loc 1 1748 0 discriminator 6
 144 0094 4FF00062 		mov	r2, #134217728
 145 0098 1F4B     		ldr	r3, .L12+20
 146 009a DA60     		str	r2, [r3, #12]
 147 009c D2E7     		b	.L4
 148              	.L6:
1748:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 	HAL_NVIC_ClearPendingIRQ(WIFI_SPI_DMA_TX_IRQn); /**< Clear DMA pending bit in NVIC */
 149              		.loc 1 1748 0 discriminator 7
 150 009e 4FF00062 		mov	r2, #134217728
 151 00a2 1D4B     		ldr	r3, .L12+20
 152 00a4 9A60     		str	r2, [r3, #8]
 153 00a6 CDE7     		b	.L4
 154              	.L9:
1757:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 35


 155              		.loc 1 1757 0 is_stmt 1
 156 00a8 0022     		movs	r2, #0
 157 00aa 1C4B     		ldr	r3, .L12+24
 158 00ac 1A70     		strb	r2, [r3]
1759:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_MEMORY_ADDRESS(SpiHandle.hdmatx, (uint32_t)tx_header_data); /**< Set memory 
 159              		.loc 1 1759 0
 160 00ae 154B     		ldr	r3, .L12
 161 00b0 9A6C     		ldr	r2, [r3, #72]
 162 00b2 1268     		ldr	r2, [r2]
 163 00b4 1A49     		ldr	r1, .L12+28
 164 00b6 0978     		ldrb	r1, [r1]	@ zero_extendqisi2
 165 00b8 5160     		str	r1, [r2, #4]
1760:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
 166              		.loc 1 1760 0
 167 00ba 9B6C     		ldr	r3, [r3, #72]
 168 00bc 1B68     		ldr	r3, [r3]
 169 00be 194A     		ldr	r2, .L12+32
 170 00c0 1268     		ldr	r2, [r2]
 171 00c2 DA60     		str	r2, [r3, #12]
1761:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 172              		.loc 1 1761 0
 173 00c4 D3E7     		b	.L7
 174              	.L8:
1764:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 175              		.loc 1 1764 0
 176 00c6 0122     		movs	r2, #1
 177 00c8 144B     		ldr	r3, .L12+24
 178 00ca 1A70     		strb	r2, [r3]
1766:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_MEMORY_ADDRESS(SpiHandle.hdmatx, (uint32_t)tx_payload_data); /**< Set memory
 179              		.loc 1 1766 0
 180 00cc 0D4B     		ldr	r3, .L12
 181 00ce 9A6C     		ldr	r2, [r3, #72]
 182 00d0 1268     		ldr	r2, [r2]
 183 00d2 1549     		ldr	r1, .L12+36
 184 00d4 0968     		ldr	r1, [r1]
 185 00d6 5160     		str	r1, [r2, #4]
1767:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
 186              		.loc 1 1767 0
 187 00d8 9B6C     		ldr	r3, [r3, #72]
 188 00da 1B68     		ldr	r3, [r3]
 189 00dc 134A     		ldr	r2, .L12+40
 190 00de 1268     		ldr	r2, [r2]
 191 00e0 DA60     		str	r2, [r3, #12]
1768:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 192              		.loc 1 1768 0
 193 00e2 C4E7     		b	.L7
 194              	.L10:
1771:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 195              		.loc 1 1771 0
 196 00e4 0122     		movs	r2, #1
 197 00e6 0D4B     		ldr	r3, .L12+24
 198 00e8 1A70     		strb	r2, [r3]
1773:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     __HAL_WIFI_DMA_SET_MEMORY_ADDRESS(SpiHandle.hdmatx, (uint32_t)WiFi_Counter_Variables.curr_data)
 199              		.loc 1 1773 0
 200 00ea 064A     		ldr	r2, .L12
 201 00ec 936C     		ldr	r3, [r2, #72]
 202 00ee 1968     		ldr	r1, [r3]
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 36


 203 00f0 0F4B     		ldr	r3, .L12+44
 204 00f2 B3F88C00 		ldrh	r0, [r3, #140]
 205 00f6 4860     		str	r0, [r1, #4]
1774:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
 206              		.loc 1 1774 0
 207 00f8 926C     		ldr	r2, [r2, #72]
 208 00fa 1268     		ldr	r2, [r2]
 209 00fc D3F88830 		ldr	r3, [r3, #136]
 210 0100 D360     		str	r3, [r2, #12]
1775:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     
 211              		.loc 1 1775 0
 212 0102 B4E7     		b	.L7
 213              	.L13:
 214              		.align	2
 215              	.L12:
 216 0104 00000000 		.word	SpiHandle
 217 0108 58640240 		.word	1073898584
 218 010c 00640240 		.word	1073898496
 219 0110 B8600240 		.word	1073897656
 220 0114 58600240 		.word	1073897560
 221 0118 00600240 		.word	1073897472
 222 011c 00000000 		.word	Spi_Transmit_Event
 223 0120 00000000 		.word	tx_header_size
 224 0124 00000000 		.word	tx_header_data
 225 0128 00000000 		.word	payload_size_to_transmit
 226 012c 00000000 		.word	tx_payload_data
 227 0130 00000000 		.word	WiFi_Counter_Variables
 228              		.cfi_endproc
 229              	.LFE278:
 231              		.section	.text.TransmitClosure,"ax",%progbits
 232              		.align	1
 233              		.global	TransmitClosure
 234              		.syntax unified
 235              		.thumb
 236              		.thumb_func
 237              		.fpu fpv4-sp-d16
 239              	TransmitClosure:
 240              	.LFB279:
1782:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** }
1783:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1784:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** /**
1785:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @brief  Close the transmit mechanism after packet has been sent
1786:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  *         Wait for the event to come back
1787:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @param  None
1788:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  * @retval None
1789:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****  */
1790:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** void TransmitClosure(void)
1791:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** {
 241              		.loc 1 1791 0
 242              		.cfi_startproc
 243              		@ args = 0, pretend = 0, frame = 0
 244              		@ frame_needed = 0, uses_anonymous_args = 0
 245 0000 08B5     		push	{r3, lr}
 246              	.LCFI1:
 247              		.cfi_def_cfa_offset 8
 248              		.cfi_offset 3, -8
 249              		.cfi_offset 14, -4
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 37


1792:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   Disable_SPI_CS();
 250              		.loc 1 1792 0
 251 0002 FFF7FEFF 		bl	Disable_SPI_CS
 252              	.LVL5:
1793:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
1794:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   /*
1795:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    *  Disable both DMA
1796:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****    */
1797:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_DISABLE(SpiHandle.hdmatx);
 253              		.loc 1 1797 0
 254 0006 094A     		ldr	r2, .L16
 255 0008 936C     		ldr	r3, [r2, #72]
 256 000a 1968     		ldr	r1, [r3]
 257 000c 0B68     		ldr	r3, [r1]
 258 000e 23F00103 		bic	r3, r3, #1
 259 0012 0B60     		str	r3, [r1]
1798:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   __HAL_DMA_DISABLE(SpiHandle.hdmarx);
 260              		.loc 1 1798 0
 261 0014 D36C     		ldr	r3, [r2, #76]
 262 0016 1A68     		ldr	r2, [r3]
 263 0018 1368     		ldr	r3, [r2]
 264 001a 23F00103 		bic	r3, r3, #1
 265 001e 1360     		str	r3, [r2]
1799:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
1800:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   Enable_SPI_Receiving_Path();
 266              		.loc 1 1800 0
 267 0020 FFF7FEFF 		bl	Enable_SPI_Receiving_Path
 268              	.LVL6:
1801:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
1802:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   SPI_Tx_Transfer = WIFI_TRUE;
 269              		.loc 1 1802 0
 270 0024 0122     		movs	r2, #1
 271 0026 024B     		ldr	r3, .L16+4
 272 0028 1A70     		strb	r2, [r3]
 273 002a 08BD     		pop	{r3, pc}
 274              	.L17:
 275              		.align	2
 276              	.L16:
 277 002c 00000000 		.word	SpiHandle
 278 0030 00000000 		.word	SPI_Tx_Transfer
 279              		.cfi_endproc
 280              	.LFE279:
 282              		.section	.text.SPI_Transmit_Manager_Poll,"ax",%progbits
 283              		.align	1
 284              		.global	SPI_Transmit_Manager_Poll
 285              		.syntax unified
 286              		.thumb
 287              		.thumb_func
 288              		.fpu fpv4-sp-d16
 290              	SPI_Transmit_Manager_Poll:
 291              	.LFB277:
1718:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   Disable_SPI_Receiving_Path();
 292              		.loc 1 1718 0
 293              		.cfi_startproc
 294              		@ args = 0, pretend = 0, frame = 0
 295              		@ frame_needed = 0, uses_anonymous_args = 0
 296              	.LVL7:
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 38


 297 0000 38B5     		push	{r3, r4, r5, lr}
 298              	.LCFI2:
 299              		.cfi_def_cfa_offset 16
 300              		.cfi_offset 3, -16
 301              		.cfi_offset 4, -12
 302              		.cfi_offset 5, -8
 303              		.cfi_offset 14, -4
 304 0002 0446     		mov	r4, r0
 305 0004 0D46     		mov	r5, r1
1719:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 306              		.loc 1 1719 0
 307 0006 FFF7FEFF 		bl	Disable_SPI_Receiving_Path
 308              	.LVL8:
1721:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 309              		.loc 1 1721 0
 310 000a FFF7FEFF 		bl	Enable_SPI_CS
 311              	.LVL9:
1723:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   {
 312              		.loc 1 1723 0
 313 000e 4FF47A73 		mov	r3, #1000
 314 0012 AAB2     		uxth	r2, r5
 315 0014 2146     		mov	r1, r4
 316 0016 0448     		ldr	r0, .L22
 317 0018 FFF7FEFF 		bl	HAL_SPI_Transmit
 318              	.LVL10:
 319 001c 00B1     		cbz	r0, .L21
 320              	.L18:
 321 001e 38BD     		pop	{r3, r4, r5, pc}
 322              	.LVL11:
 323              	.L21:
1725:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   }
 324              		.loc 1 1725 0
 325 0020 FFF7FEFF 		bl	TransmitClosure
 326              	.LVL12:
1727:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c **** 
 327              		.loc 1 1727 0
 328 0024 FBE7     		b	.L18
 329              	.L23:
 330 0026 00BF     		.align	2
 331              	.L22:
 332 0028 00000000 		.word	SpiHandle
 333              		.cfi_endproc
 334              	.LFE277:
 336              		.section	.text.SPI_Send_AT_Command,"ax",%progbits
 337              		.align	1
 338              		.global	SPI_Send_AT_Command
 339              		.syntax unified
 340              		.thumb
 341              		.thumb_func
 342              		.fpu fpv4-sp-d16
 344              	SPI_Send_AT_Command:
 345              	.LFB276:
1689:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   tx_payload_data = WiFi_SPI_Packet;  
 346              		.loc 1 1689 0
 347              		.cfi_startproc
 348              		@ args = 0, pretend = 0, frame = 0
 349              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 39


 350              	.LVL13:
 351 0000 08B5     		push	{r3, lr}
 352              	.LCFI3:
 353              		.cfi_def_cfa_offset 8
 354              		.cfi_offset 3, -8
 355              		.cfi_offset 14, -4
1690:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 356              		.loc 1 1690 0
 357 0002 094A     		ldr	r2, .L29
 358 0004 094B     		ldr	r3, .L29+4
 359 0006 1A60     		str	r2, [r3]
1696:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   
 360              		.loc 1 1696 0
 361 0008 094B     		ldr	r3, .L29+8
 362 000a 1860     		str	r0, [r3]
1698:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   {
 363              		.loc 1 1698 0
 364 000c 0129     		cmp	r1, #1
 365 000e 02D0     		beq	.L26
 366 0010 0229     		cmp	r1, #2
 367 0012 05D0     		beq	.L27
 368 0014 08BD     		pop	{r3, pc}
 369              	.L26:
1701:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
 370              		.loc 1 1701 0
 371 0016 0146     		mov	r1, r0
 372              	.LVL14:
 373 0018 0348     		ldr	r0, .L29
 374              	.LVL15:
 375 001a FFF7FEFF 		bl	SPI_Transmit_Manager_Poll
 376              	.LVL16:
1702:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****   case SPI_DMA:
 377              		.loc 1 1702 0
 378 001e 08BD     		pop	{r3, pc}
 379              	.LVL17:
 380              	.L27:
1704:Middlewares/ST/STM32_SPWF0xSy/wifi_module_spi.c ****     break;
 381              		.loc 1 1704 0
 382 0020 0120     		movs	r0, #1
 383              	.LVL18:
 384 0022 FFF7FEFF 		bl	SPI_Transmit_Manager
 385              	.LVL19:
 386 0026 08BD     		pop	{r3, pc}
 387              	.L30:
 388              		.align	2
 389              	.L29:
 390 0028 00000000 		.word	WiFi_SPI_Packet
 391 002c 00000000 		.word	tx_payload_data
 392 0030 00000000 		.word	payload_size_to_transmit
 393              		.cfi_endproc
 394              	.LFE276:
 396              		.global	gcfg_data_broken
 397              		.comm	SPI_Tx_Transfer,1,1
 398              		.comm	kind_of_event,1,1
 399              		.comm	Spi_Transmit_Event,1,1
 400              		.comm	Spi_Receive_Event,1,1
 401              		.global	wind_55_in_Q
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 40


 402              		.comm	packet_cont,1,1
 403              		.comm	tx_payload_size,1,1
 404              		.comm	tx_header_size,1,1
 405              		.comm	tx_header_data,4,4
 406              		.comm	payload_size_to_transmit,4,4
 407              		.comm	tx_payload_data,4,4
 408              		.comm	payload_read_len,2,2
 409              		.comm	payload_to_read,2,2
 410              		.comm	payload_len,2,2
 411              		.comm	http_packet_len,2,2
 412              		.comm	sync,1,1
 413              		.comm	wind_no,1,1
 414              		.global	dummy_char
 415              		.global	dummy_bytes
 416              		.comm	dataBuff,1024,4
 417              		.comm	dummy_Header,5,4
 418              		.comm	Received_Header,5,4
 419              		.global	Read_Header_CMD
 420              		.global	Write_Header_CMD
 421              		.section	.bss.Write_Header_CMD,"aw",%nobits
 422              		.align	2
 425              	Write_Header_CMD:
 426 0000 00000000 		.space	5
 426      00
 427              		.section	.bss.gcfg_data_broken,"aw",%nobits
 430              	gcfg_data_broken:
 431 0000 00       		.space	1
 432              		.section	.bss.wind_55_in_Q,"aw",%nobits
 435              	wind_55_in_Q:
 436 0000 00       		.space	1
 437              		.section	.data.Read_Header_CMD,"aw",%progbits
 438              		.align	2
 441              	Read_Header_CMD:
 442 0000 02       		.byte	2
 443 0001 00       		.byte	0
 444 0002 00       		.byte	0
 445 0003 00       		.byte	0
 446 0004 00       		.byte	0
 447              		.section	.data.dummy_char,"aw",%progbits
 450              	dummy_char:
 451 0000 FF       		.byte	-1
 452              		.section	.rodata.dummy_bytes,"a",%progbits
 455              	dummy_bytes:
 456 0000 FF       		.byte	-1
 457              		.text
 458              	.Letext0:
 459              		.file 2 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\include
 460              		.file 3 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\include
 461              		.file 4 "Drivers/CMSIS/Include/core_cm4.h"
 462              		.file 5 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/system_stm32f4xx.h"
 463              		.file 6 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f401xe.h"
 464              		.file 7 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f4xx.h"
 465              		.file 8 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 466              		.file 9 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 467              		.file 10 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim.h"
 468              		.file 11 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_uart.h"
 469              		.file 12 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal.h"
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 41


 470              		.file 13 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_spi.h"
 471              		.file 14 "Middlewares/ST/STM32_SPWF0xSy/Inc/wifi_interface.h"
 472              		.file 15 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
 473              		.file 16 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
 474              		.file 17 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\lib\\gcc\\arm-none-ea
 475              		.file 18 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
 476              		.file 19 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
 477              		.file 20 "Middlewares/ST/STM32_SPWF0xSy/Utils/event_buffer.h"
 478              		.file 21 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
 479              		.file 22 "Middlewares/ST/STM32_SPWF0xSy/Inc/wifi_module.h"
 480              		.file 23 "Middlewares/ST/STM32_SPWF0xSy/Utils/wifi_globals.h"
 481              		.file 24 "Drivers/BSP/X-NUCLEO-IDW0xx1/stm32_spwf_wifi.h"
 482              		.file 25 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_cortex.h"
 483              		.file 26 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_ll_dma.h"
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 42


DEFINED SYMBOLS
                            *ABS*:00000000 wifi_module_spi.c
D:\cygwin64\tmp\cc20puCb.s:18     .text.no_op:00000000 $t
D:\cygwin64\tmp\cc20puCb.s:25     .text.no_op:00000000 no_op
D:\cygwin64\tmp\cc20puCb.s:39     .text.SPI_Transmit_Manager:00000000 $t
D:\cygwin64\tmp\cc20puCb.s:46     .text.SPI_Transmit_Manager:00000000 SPI_Transmit_Manager
D:\cygwin64\tmp\cc20puCb.s:216    .text.SPI_Transmit_Manager:00000104 $d
                            *COM*:00000001 Spi_Transmit_Event
                            *COM*:00000001 tx_header_size
                            *COM*:00000004 tx_header_data
                            *COM*:00000004 payload_size_to_transmit
                            *COM*:00000004 tx_payload_data
D:\cygwin64\tmp\cc20puCb.s:232    .text.TransmitClosure:00000000 $t
D:\cygwin64\tmp\cc20puCb.s:239    .text.TransmitClosure:00000000 TransmitClosure
D:\cygwin64\tmp\cc20puCb.s:277    .text.TransmitClosure:0000002c $d
                            *COM*:00000001 SPI_Tx_Transfer
D:\cygwin64\tmp\cc20puCb.s:283    .text.SPI_Transmit_Manager_Poll:00000000 $t
D:\cygwin64\tmp\cc20puCb.s:290    .text.SPI_Transmit_Manager_Poll:00000000 SPI_Transmit_Manager_Poll
D:\cygwin64\tmp\cc20puCb.s:332    .text.SPI_Transmit_Manager_Poll:00000028 $d
D:\cygwin64\tmp\cc20puCb.s:337    .text.SPI_Send_AT_Command:00000000 $t
D:\cygwin64\tmp\cc20puCb.s:344    .text.SPI_Send_AT_Command:00000000 SPI_Send_AT_Command
D:\cygwin64\tmp\cc20puCb.s:390    .text.SPI_Send_AT_Command:00000028 $d
D:\cygwin64\tmp\cc20puCb.s:430    .bss.gcfg_data_broken:00000000 gcfg_data_broken
                            *COM*:00000001 kind_of_event
                            *COM*:00000001 Spi_Receive_Event
D:\cygwin64\tmp\cc20puCb.s:435    .bss.wind_55_in_Q:00000000 wind_55_in_Q
                            *COM*:00000001 packet_cont
                            *COM*:00000001 tx_payload_size
                            *COM*:00000002 payload_read_len
                            *COM*:00000002 payload_to_read
                            *COM*:00000002 payload_len
                            *COM*:00000002 http_packet_len
                            *COM*:00000001 sync
                            *COM*:00000001 wind_no
D:\cygwin64\tmp\cc20puCb.s:450    .data.dummy_char:00000000 dummy_char
D:\cygwin64\tmp\cc20puCb.s:455    .rodata.dummy_bytes:00000000 dummy_bytes
                            *COM*:00000400 dataBuff
                            *COM*:00000005 dummy_Header
                            *COM*:00000005 Received_Header
D:\cygwin64\tmp\cc20puCb.s:441    .data.Read_Header_CMD:00000000 Read_Header_CMD
D:\cygwin64\tmp\cc20puCb.s:425    .bss.Write_Header_CMD:00000000 Write_Header_CMD
D:\cygwin64\tmp\cc20puCb.s:422    .bss.Write_Header_CMD:00000000 $d
D:\cygwin64\tmp\cc20puCb.s:431    .bss.gcfg_data_broken:00000000 $d
D:\cygwin64\tmp\cc20puCb.s:436    .bss.wind_55_in_Q:00000000 $d
D:\cygwin64\tmp\cc20puCb.s:438    .data.Read_Header_CMD:00000000 $d
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
Disable_SPI_Receiving_Path
Enable_SPI_CS
HAL_NVIC_ClearPendingIRQ
SpiHandle
WiFi_Counter_Variables
Disable_SPI_CS
Enable_SPI_Receiving_Path
HAL_SPI_Transmit
WiFi_SPI_Packet
ARM GAS  D:\cygwin64\tmp\cc20puCb.s 			page 43


