ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"wifi_interface.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.wifi_set_socket_certificates,"ax",%progbits
  18              		.align	1
  19              		.global	wifi_set_socket_certificates
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	wifi_set_socket_certificates:
  26              	.LFB276:
  27              		.file 1 "Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c"
   1:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
   2:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  ******************************************************************************
   3:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * @file    wifi_interface.c
   4:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * @author  Central LAB
   5:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * @version V2.1.0
   6:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * @date    17-May-2016
   7:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * @brief   User APIs implementation for X-CUBE-WIFI1
   8:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  ******************************************************************************
   9:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * @attention
  10:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  *
  11:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * <h2><center>&copy; COPYRIGHT(c) 2015 STMicroelectronics</center></h2>
  12:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  *
  13:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * Redistribution and use in source and binary forms, with or without modification,
  14:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * are permitted provided that the following conditions are met:
  15:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  *   1. Redistributions of source code must retain the above copyright notice,
  16:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  *      this list of conditions and the following disclaimer.
  17:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  *   2. Redistributions in binary form must reproduce the above copyright notice,
  18:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  *      this list of conditions and the following disclaimer in the documentation
  19:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  *      and/or other materials provided with the distribution.
  20:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  *   3. Neither the name of STMicroelectronics nor the names of its contributors
  21:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  *      may be used to endorse or promote products derived from this software
  22:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  *      without specific prior written permission.
  23:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  *
  24:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  25:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  26:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  27:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
  28:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  29:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
  30:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
  31:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 2


  32:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  33:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  34:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  *
  35:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  ******************************************************************************
  36:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  */
  37:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
  38:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /* Includes ------------------------------------------------------------------*/
  39:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #include "wifi_module.h"
  40:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #include "wifi_globals.h"
  41:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #include "stdarg.h"
  42:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
  43:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /** @addtogroup MIDDLEWARES
  44:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @{
  45:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */ 
  46:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
  47:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /** @defgroup  NUCLEO_WIFI_INTERFACE
  48:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   * @brief Wi-Fi User API modules
  49:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   * @{
  50:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   */
  51:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
  52:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /** @defgroup NUCLEO_WIFI_INTERFACE_Private_Defines
  53:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   * @{
  54:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   */
  55:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
  56:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
  57:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   * @}
  58:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   */
  59:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
  60:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /** @addtogroup NUCLEO_WIFI_INTERFACE_Private_Variables
  61:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   * @{
  62:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   */
  63:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /* Private variables ---------------------------------------------------------*/
  64:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
  65:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
  66:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   * @}
  67:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   */
  68:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
  69:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /** @defgroup NUCLEO_WIFI_INTERFACE_Private_Functions
  70:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   * @{
  71:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   */
  72:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
  73:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** GPIO_InitTypeDef  WAKEUP_InitStruct;
  74:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
  75:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
  76:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   * @brief  wifi_init
  77:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   *         User API for wifi init
  78:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   * @param  None
  79:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   * @retval None
  80:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   */
  81:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_init(wifi_config* config)
  82:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
  83:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
  84:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
  85:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #if defined (DEBUG_PRINT) && !defined (WIFI_USE_VCOM)
  86:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     printf("\r\n\nBuild Configuration:");
  87:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #if defined(USE_STM32F4XX_NUCLEO)  
  88:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       printf("\r\nNucleo: NUCLEO-F401RE\r\n");
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 3


  89:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif
  90:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #if defined(USE_STM32L4XX_NUCLEO)  
  91:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       printf("\r\nNucleo: NUCLEO-L476RG\r\n");
  92:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif
  93:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #if defined(USE_STM32L0XX_NUCLEO)  
  94:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       printf("\r\nNucleo: NUCLEO-L053R8\r\n");
  95:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif
  96:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #if defined(USE_STM32F1xx_NUCLEO)  
  97:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       printf("\r\nNucleo: NUCLEO-F103RB\r\n");
  98:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif
  99:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #if defined(SPWF04)
 100:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       printf("X-Nucleo: X-NUCLEO-IDW04A1\r\n");
 101:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #else
 102:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       printf("X-Nucleo: X-NUCLEO-IDW01M1\r\n");
 103:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif
 104:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #if defined (CONSOLE_UART_ENABLED)
 105:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       printf("Interface: UART\r\n");
 106:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #else
 107:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       printf("Interface: SPI\r\n");
 108:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif
 109:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif  
 110:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 111:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Module_Init();
 112:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 113:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #ifndef WIFI_USE_VCOM  
 114:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     wifi_wakeup(WIFI_TRUE);//Prevent from going to sleep during configuration    
 115:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 116:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /* Soft reset the module */
 117:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     wifi_reset();
 118:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 119:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #if defined(CONSOLE_UART_ENABLED)
 120:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* Restore default setting*/    
 121:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = Restore_Default_Setting();
 122:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) 
 123:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         return status;
 124:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 125:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #if !defined (USE_STM32L0XX_NUCLEO)
 126:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         
 127:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         /* Restore_Default_Setting, resets the usart baud rate to 115200.
 128:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****            Set it to the value of config->mcu_baud_rate for synchronisation. */
 129:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = SET_Configuration_Value(CONSOLE1_SPEED, config->mcu_baud_rate);
 130:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status; 
 131:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         
 132:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         /* save current setting in flash */
 133:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         Reset_AT_CMD_Buffer();  
 134:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         sprintf((char*)WiFi_AT_Cmd_Buff,AT_SAVE_CURRENT_SETTING);  
 135:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 136:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status == WiFi_MODULE_SUCCESS)
 137:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         {
 138:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = USART_Receive_AT_Resp( );
 139:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 140:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         } 
 141:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 142:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         /* Soft reset the module */
 143:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         wifi_reset();
 144:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #endif
 145:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 4


 146:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* Switch on HW Flow Control*/  
 147:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #ifdef SPWF04
 148:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = SET_Configuration_Value(CONSOLE1_HWFC, 0);
 149:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #else
 150:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = SET_Configuration_Value(CONSOLE1_HWFC, 1);
 151:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #endif
 152:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 153:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status; 
 154:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 155:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(config->wifi_baud_rate)
 156:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 157:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         /* Set USART Speed*/  
 158:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = SET_Configuration_Value(CONSOLE1_SPEED, config->wifi_baud_rate);
 159:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status; 
 160:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 161:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 162:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #ifdef SPWF04
 163:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           /*AT+S.WIFI=0<cr>*/  
 164:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         sprintf((char*)WiFi_AT_Cmd_Buff,AT_WIFI_ENABLE, 0);  
 165:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 166:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status == WiFi_MODULE_SUCCESS)
 167:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         {
 168:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = USART_Receive_AT_Resp( );
 169:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 170:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           else IO_status_flag.radio_off = WIFI_TRUE;
 171:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         }
 172:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         
 173:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         while(IO_status_flag.WiFi_WIND_State!= WiFiPowerDown);//Till +WIND:38:WiFi Powered Down arr
 174:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #endif  
 175:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 176:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* Set wifi_mode to idle*/  
 177:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = SET_Configuration_Value(WIFI_MODE, WiFi_IDLE_MODE);
 178:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;   
 179:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
 180:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       switch(config->ht_mode)
 181:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 182:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         case WIFI_FALSE:
 183:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_HT_MODE, 0);
 184:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 185:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Addr(WIFI_OPR_RATE_MASK, "0x00003FCF");
 186:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 187:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 188:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         case WIFI_TRUE:
 189:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_HT_MODE, 1);
 190:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 191:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Addr(WIFI_OPR_RATE_MASK, "0x003FFFCF");
 192:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 193:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 194:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         default:
 195:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 196:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 197:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 198:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       switch(config->power)
 199:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 200:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         case wifi_active:
 201:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_POWERSAVE, 0);
 202:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 5


 203:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_SLEEP_ENABLED, 0);  
 204:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 205:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_STANDBY_ENABLED, 0);  
 206:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 207:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 208:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         case wifi_reactive:
 209:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_POWERSAVE, 1);
 210:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 211:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_OPERATIONAL_MODE, 11);  
 212:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 213:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_BEACON_WAKEUP, 0);
 214:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 215:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_LISTEN_INTERVAL, 0);
 216:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 217:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_SLEEP_ENABLED, 0);  
 218:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 219:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_STANDBY_ENABLED, 0);  
 220:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 221:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 222:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         case wifi_sleep:
 223:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_POWERSAVE, 1);
 224:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 225:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_OPERATIONAL_MODE, 12);  
 226:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 227:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_BEACON_WAKEUP, 10);
 228:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 229:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_LISTEN_INTERVAL, 1);
 230:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 231:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_SLEEP_ENABLED, 1);  
 232:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 233:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_STANDBY_ENABLED, 0);  
 234:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 235:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 236:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         default:
 237:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 238:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 239:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 240:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       switch(config->power_level)
 241:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 242:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         case low:
 243:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         case medium:
 244:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         case high:
 245:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         case max:
 246:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_TX_POWER, config->power_level*6);
 247:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 248:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 249:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         default:
 250:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 251:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 252:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 253:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       switch(config->dhcp)
 254:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 255:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         case off:
 256:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         case on:
 257:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         case custom:
 258:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(IP_USE_DHCP_SERVER, config->dhcp);
 259:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 6


 260:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 261:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         default:
 262:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 263:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 264:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 265:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* Set IP address */
 266:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(config->ip_addr)
 267:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 268:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = SET_Configuration_Addr(WIFI_IP_ADDRESS, config->ip_addr);
 269:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 270:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 271:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* Set netmask address */
 272:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(config->netmask_addr)
 273:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 274:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = SET_Configuration_Addr(WIFI_IP_NETMASK, config->netmask_addr);
 275:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 276:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 277:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* Set default gateway address */
 278:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(config->gateway_addr)
 279:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 280:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = SET_Configuration_Addr(WIFI_IP_DEFAULT_GATEWAY, config->gateway_addr);
 281:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 282:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 283:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* Set dns address */
 284:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(config->dns_addr)
 285:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 286:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         #ifdef SPWF04
 287:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****             status = SET_Configuration_Addr(WIFI_IP_DNS1, config->dns_addr);
 288:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         #else
 289:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****             status = SET_Configuration_Addr(WIFI_IP_DNS, config->dns_addr);
 290:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         #endif
 291:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****             if(status != WiFi_MODULE_SUCCESS) return status;
 292:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 293:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* Set hostname */
 294:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(config->host_name)
 295:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 296:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = SET_Configuration_Addr(WIFI_IP_HOSTNAME, config->host_name);  
 297:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 298:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 299:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 300:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(config->ap_domain_name)
 301:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 302:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = SET_Configuration_Addr(WIFI_IP_APDOMAINNAME, config->ap_domain_name);
 303:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 304:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 305:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 306:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(config->ap_config_page_name)
 307:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 308:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = SET_Configuration_Addr(WIFI_IP_APREDIRECT, config->ap_config_page_name);
 309:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 310:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 311:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 312:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(config->http_timeout)
 313:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 314:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = SET_Configuration_Value(WIFI_IP_HTTP_TIMEOUT, config->http_timeout*1000);
 315:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 316:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 7


 317:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(config->dhcp_timeout)
 318:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 319:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = SET_Configuration_Value(WIFI_IP_DHCP_TIMEOUT, config->dhcp_timeout);
 320:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 321:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 322:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(config->wifi_region)
 323:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 324:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = SET_Configuration_Value(WIFI_REG_COUNTRY, config->wifi_region);
 325:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 326:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }   
 327:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 328:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #ifdef SPWF01
 329:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         Reset_AT_CMD_Buffer();  
 330:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         sprintf((char*)WiFi_AT_Cmd_Buff,AT_HTTPD, config->web_server);  
 331:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 332:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status == WiFi_MODULE_SUCCESS)
 333:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         {
 334:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = USART_Receive_AT_Resp( );
 335:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 336:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         }  
 337:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #endif  
 338:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 339:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #ifdef SPWF04
 340:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           /*AT+S.TLSCERT2=content,2 */
 341:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           Reset_AT_CMD_Buffer();  
 342:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.TLSCERT=content,2\r");        
 343:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 344:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status == WiFi_MODULE_SUCCESS)
 345:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           {
 346:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****             status = USART_Receive_AT_Resp( );
 347:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****             if(status != WiFi_MODULE_SUCCESS) return status;
 348:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           }  
 349:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           
 350:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           /* Set verbose to 1 for SPWF04 UART*/
 351:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value("console_verbose", 1);
 352:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 353:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 354:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****             /*AT+S.WIFI=1<cr>*/  
 355:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           sprintf((char*)WiFi_AT_Cmd_Buff,AT_WIFI_ENABLE, 1);  
 356:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 357:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status == WiFi_MODULE_SUCCESS)
 358:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           {
 359:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****             status = USART_Receive_AT_Resp( );
 360:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****             if(status != WiFi_MODULE_SUCCESS) return status;
 361:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****             else IO_status_flag.radio_off = WIFI_FALSE;
 362:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           }
 363:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           
 364:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           while(IO_status_flag.WiFi_Enabled != WIFI_TRUE);//Till Hardware Started arrives
 365:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #else
 366:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           /* AT+S.TLSCERT2=clean,all */
 367:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           Reset_AT_CMD_Buffer();  
 368:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.TLSCERT2=clean,all\r");        
 369:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 370:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status == WiFi_MODULE_SUCCESS)
 371:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           {
 372:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****             status = USART_Receive_AT_Resp( );
 373:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****             if(status != WiFi_MODULE_SUCCESS) return status;
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 8


 374:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           }
 375:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #endif
 376:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 377:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* save current setting in flash */
 378:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       Reset_AT_CMD_Buffer();  
 379:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,AT_SAVE_CURRENT_SETTING);  
 380:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 381:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status == WiFi_MODULE_SUCCESS)
 382:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 383:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = USART_Receive_AT_Resp( );
 384:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 385:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }   
 386:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 387:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(config->wifi_baud_rate)
 388:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 389:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         UART_Configuration(config->wifi_baud_rate); 
 390:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         #if defined(SPWF01) 
 391:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           Receive_Data();//Restart data reception
 392:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         #else
 393:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           WiFi_Counter_Variables.dma_buffer_count =0;
 394:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           WiFi_Counter_Variables.dma_buffer_previous_index =0;
 395:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           Receive_DMA_Uart_Data();
 396:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         #endif
 397:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 398:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 399:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* Soft reset the module, Do the second reset after setting all parameters and saving in flas
 400:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       wifi_reset();
 401:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 402:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #else
 403:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 404:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /*SPI Interface in use*/
 405:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
 406:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* Set localecho to 0*/
 407:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = SET_Configuration_Value(LOCALECHO1, 0);
 408:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;
 409:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
 410:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* Restore default setting*/    
 411:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       Reset_AT_CMD_Buffer();  
 412:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.FCFG");  
 413:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
 414:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Receive_AT_Resp( );
 415:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;
 416:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 417:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* save current setting in flash */
 418:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       Reset_AT_CMD_Buffer();  
 419:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.WCFG");  
 420:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
 421:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Receive_AT_Resp( );
 422:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;
 423:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
 424:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* Soft reset the module */
 425:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       wifi_reset();
 426:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
 427:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /*AT+S.WIFI=0<cr>*/  
 428:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       Reset_AT_CMD_Buffer();  
 429:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.WIFI=%d", 0);  
 430:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 9


 431:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Receive_AT_Resp( );
 432:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;
 433:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       while(IO_status_flag.WiFi_WIND_State!= WiFiPowerDown);//Till +WIND:38:WiFi Powered Down arriv
 434:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
 435:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* Set wifi_mode to idle*/  
 436:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = SET_Configuration_Value(WIFI_MODE, WiFi_IDLE_MODE);
 437:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;  
 438:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
 439:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /*AT+S.WIFI=1<cr>*/  
 440:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       Reset_AT_CMD_Buffer();  
 441:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.WIFI=%d", 1);  
 442:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
 443:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Receive_AT_Resp( );
 444:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;
 445:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       while(IO_status_flag.WiFi_Enabled != WIFI_TRUE);//Till Hardware Started arrives
 446:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
 447:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /*AT+S.TLSCERT2=content,2 -> clean certificates*/
 448:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       Reset_AT_CMD_Buffer();  
 449:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.TLSCERT=content,2");        
 450:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
 451:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Receive_AT_Resp( );
 452:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status; 
 453:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
 454:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****        /* Set verbose to 0 for SPWF04 SPI */
 455:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = SET_Configuration_Value("console_verbose", 0);
 456:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;
 457:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 458:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     //No need to reset again in case of new module SPI
 459:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif  //#if defined(CONSOLE_UART_ENABLED)
 460:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 461:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   wifi_wakeup(WIFI_FALSE);//De-assert wakeup signal (PC13) to allow sleep if enabled
 462:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif  //WIFI_USE_VCOM
 463:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 464:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #if defined(SPWF04)
 465:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /* check for compatibility between middleware and firmware versions. */  
 466:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = wifi_firmware_middleware_version_compatibility();
 467:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status;
 468:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
 469:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 470:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #if defined (DEBUG_PRINT) && !defined (WIFI_USE_VCOM)
 471:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     printf("\r\nEnd of Initialization..\r\n");
 472:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     fflush(stdout);
 473:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
 474:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
 475:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 476:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 477:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
 478:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_set_socket_certificates
 479:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Set the security certificates and key for secure socket (TLS)
 480:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  tls_mode : 'o': one way authentication 'm': mutual authentication
 481:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  ca_certificate: Certificate Authority (CA) certificate (rootca_of_server.pem/rootca_of_cl
 482:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  certificate: could be client/server certificate (client_cert.pem/server_cert.pem) and its
 483:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  certificate_key : key corresponding to the certificate stored (client_key.rsa.pem/server_
 484:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  client_domain: common name of the server certificate 'server' for SPWF01 and auth file co
 485:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         rootca_of_server/client.pem for SPWF04 (rootca_of_client.bin/root_ca_of_server.bin) and i
 486:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  tls_epoch_time : epoch time
 487:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 10


 488:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
 489:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_set_socket_certificates(TLS_Certificate ca_certificate, TLS_Certificate tls_cert
 490:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
  28              		.loc 1 490 0
  29              		.cfi_startproc
  30              		@ args = 20, pretend = 0, frame = 16
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              	.LVL0:
  33 0000 30B5     		push	{r4, r5, lr}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 12
  36              		.cfi_offset 4, -12
  37              		.cfi_offset 5, -8
  38              		.cfi_offset 14, -4
  39 0002 85B0     		sub	sp, sp, #20
  40              	.LCFI1:
  41              		.cfi_def_cfa_offset 32
  42 0004 04AC     		add	r4, sp, #16
  43 0006 04E90300 		stmdb	r4, {r0, r1}
  44 000a 8DE80C00 		stm	sp, {r2, r3}
  45 000e 0C9B     		ldr	r3, [sp, #48]
  46              	.LVL1:
 491:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
 492:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 493:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(tls_epoch_time==0) 
  47              		.loc 1 493 0
  48 0010 002B     		cmp	r3, #0
  49 0012 40F08180 		bne	.L2
 494:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.epoch_time = EPOCH_TIME;
  50              		.loc 1 494 0
  51 0016 504A     		ldr	r2, .L16
  52 0018 504B     		ldr	r3, .L16+4
  53 001a C3F8BC20 		str	r2, [r3, #188]
  54              	.L3:
 495:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   else
 496:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.epoch_time = tls_epoch_time;
 497:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 498:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(CONSOLE_UART_ENABLED)
 499:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 500:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Clean the already stored certificates */
 501:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();  
  55              		.loc 1 501 0
  56 001e FFF7FEFF 		bl	Reset_AT_CMD_Buffer
  57              	.LVL2:
 502:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_CLEAN_TLS_CERT);        
  58              		.loc 1 502 0
  59 0022 4F4D     		ldr	r5, .L16+8
  60 0024 4F4C     		ldr	r4, .L16+12
  61 0026 0FCC     		ldmia	r4!, {r0, r1, r2, r3}
  62 0028 2860     		str	r0, [r5]	@ unaligned
  63 002a 6960     		str	r1, [r5, #4]	@ unaligned
  64 002c AA60     		str	r2, [r5, #8]	@ unaligned
  65 002e EB60     		str	r3, [r5, #12]	@ unaligned
  66 0030 03CC     		ldmia	r4!, {r0, r1}
  67 0032 2861     		str	r0, [r5, #16]	@ unaligned
  68 0034 6961     		str	r1, [r5, #20]	@ unaligned
  69 0036 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 11


  70 0038 2B76     		strb	r3, [r5, #24]
 503:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
  71              		.loc 1 503 0
  72 003a 2846     		mov	r0, r5
  73 003c FFF7FEFF 		bl	strlen
  74              	.LVL3:
  75 0040 80B2     		uxth	r0, r0
  76 0042 FFF7FEFF 		bl	USART_Transmit_AT_Cmd
  77              	.LVL4:
 504:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
  78              		.loc 1 504 0
  79 0046 20B9     		cbnz	r0, .L4
 505:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
 506:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
  80              		.loc 1 506 0
  81 0048 FFF7FEFF 		bl	USART_Receive_AT_Resp
  82              	.LVL5:
 507:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status;
  83              		.loc 1 507 0
  84 004c 0346     		mov	r3, r0
  85 004e 0028     		cmp	r0, #0
  86 0050 5FD1     		bne	.L5
  87              	.L4:
 508:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 509:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 510:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set the epoch time */  
 511:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();  
  88              		.loc 1 511 0
  89 0052 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
  90              	.LVL6:
 512:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_SETTIME,(unsigned long)WiFi_Counter_Variables.epoch_time);    
  91              		.loc 1 512 0
  92 0056 424C     		ldr	r4, .L16+8
  93 0058 404B     		ldr	r3, .L16+4
  94 005a D3F8BC20 		ldr	r2, [r3, #188]
  95 005e 4249     		ldr	r1, .L16+16
  96 0060 2046     		mov	r0, r4
  97 0062 FFF7FEFF 		bl	sprintf
  98              	.LVL7:
 513:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
  99              		.loc 1 513 0
 100 0066 2046     		mov	r0, r4
 101 0068 FFF7FEFF 		bl	strlen
 102              	.LVL8:
 103 006c 80B2     		uxth	r0, r0
 104 006e FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 105              	.LVL9:
 514:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
 106              		.loc 1 514 0
 107 0072 0346     		mov	r3, r0
 108 0074 0028     		cmp	r0, #0
 109 0076 53D0     		beq	.L11
 110              	.L6:
 111              	.LVL10:
 515:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
 516:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
 517:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status;
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 12


 518:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 519:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 520:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Store the CA Cert(if specified) */
 521:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(ca_certificate.certificate) {
 112              		.loc 1 521 0
 113 0078 029C     		ldr	r4, [sp, #8]
 114 007a 8CB1     		cbz	r4, .L7
 522:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Reset_AT_CMD_Buffer();
 115              		.loc 1 522 0
 116 007c FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 117              	.LVL11:
 523:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,AT_STORE_CA_CERT,(ca_certificate.certificate_size), ca_certific
 118              		.loc 1 523 0
 119 0080 374D     		ldr	r5, .L16+8
 120 0082 2346     		mov	r3, r4
 121 0084 039A     		ldr	r2, [sp, #12]
 122 0086 3949     		ldr	r1, .L16+20
 123 0088 2846     		mov	r0, r5
 124 008a FFF7FEFF 		bl	sprintf
 125              	.LVL12:
 524:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 525:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 126              		.loc 1 525 0
 127 008e 2846     		mov	r0, r5
 128 0090 FFF7FEFF 		bl	strlen
 129              	.LVL13:
 130 0094 80B2     		uxth	r0, r0
 131 0096 FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 132              	.LVL14:
 526:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status == WiFi_MODULE_SUCCESS)
 133              		.loc 1 526 0
 134 009a 0346     		mov	r3, r0
 135 009c 0028     		cmp	r0, #0
 136 009e 45D0     		beq	.L12
 137              	.LVL15:
 138              	.L7:
 527:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 528:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Receive_AT_Resp( );
 529:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;
 530:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
 531:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 532:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 533:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Store the 'CA Authority Key ID' for SPWF04 and 'CA domain name' for SPWF01 module */
 534:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(client_domain.certificate) {
 139              		.loc 1 534 0
 140 00a0 0A9C     		ldr	r4, [sp, #40]
 141 00a2 84B1     		cbz	r4, .L8
 535:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Reset_AT_CMD_Buffer();
 142              		.loc 1 535 0
 143 00a4 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 144              	.LVL16:
 536:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #ifdef SPWF04
 537:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,AT_STORE_AUTH_KEY, client_domain.certificate_size, client_dom
 538:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #else
 539:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,AT_SET_CA_DOMAIN_NAME, client_domain.certificate);
 145              		.loc 1 539 0
 146 00a8 2D4D     		ldr	r5, .L16+8
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 13


 147 00aa 2246     		mov	r2, r4
 148 00ac 3049     		ldr	r1, .L16+24
 149 00ae 2846     		mov	r0, r5
 150 00b0 FFF7FEFF 		bl	sprintf
 151              	.LVL17:
 540:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif
 541:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 542:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 152              		.loc 1 542 0
 153 00b4 2846     		mov	r0, r5
 154 00b6 FFF7FEFF 		bl	strlen
 155              	.LVL18:
 156 00ba 80B2     		uxth	r0, r0
 157 00bc FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 158              	.LVL19:
 543:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status == WiFi_MODULE_SUCCESS)
 159              		.loc 1 543 0
 160 00c0 0346     		mov	r3, r0
 161 00c2 0028     		cmp	r0, #0
 162 00c4 38D0     		beq	.L13
 163              	.LVL20:
 164              	.L8:
 544:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 545:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Receive_AT_Resp( );
 546:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;
 547:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }  
 548:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 549:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 550:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Store Certificate */
 551:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(tls_certificate.certificate) {
 165              		.loc 1 551 0
 166 00c6 009C     		ldr	r4, [sp]
 167 00c8 84B1     		cbz	r4, .L9
 552:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Reset_AT_CMD_Buffer();
 168              		.loc 1 552 0
 169 00ca FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 170              	.LVL21:
 553:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,AT_STORE_CERT,(tls_certificate.certificate_size), tls_certifica
 171              		.loc 1 553 0
 172 00ce 244D     		ldr	r5, .L16+8
 173 00d0 2346     		mov	r3, r4
 174 00d2 019A     		ldr	r2, [sp, #4]
 175 00d4 2749     		ldr	r1, .L16+28
 176 00d6 2846     		mov	r0, r5
 177 00d8 FFF7FEFF 		bl	sprintf
 178              	.LVL22:
 554:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 555:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 179              		.loc 1 555 0
 180 00dc 2846     		mov	r0, r5
 181 00de FFF7FEFF 		bl	strlen
 182              	.LVL23:
 183 00e2 80B2     		uxth	r0, r0
 184 00e4 FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 185              	.LVL24:
 556:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status == WiFi_MODULE_SUCCESS)
 186              		.loc 1 556 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 14


 187 00e8 0346     		mov	r3, r0
 188 00ea 58B3     		cbz	r0, .L14
 189              	.LVL25:
 190              	.L9:
 557:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 558:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Receive_AT_Resp( );
 559:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;
 560:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
 561:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 562:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 563:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Store the key corresponding to the above certificate */
 564:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(certificate_key.certificate) {
 191              		.loc 1 564 0
 192 00ec 089C     		ldr	r4, [sp, #32]
 193 00ee 84B1     		cbz	r4, .L5
 565:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Reset_AT_CMD_Buffer();
 194              		.loc 1 565 0
 195 00f0 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 196              	.LVL26:
 566:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,AT_STORE_KEY,(certificate_key.certificate_size), certificate_ke
 197              		.loc 1 566 0
 198 00f4 1A4D     		ldr	r5, .L16+8
 199 00f6 2346     		mov	r3, r4
 200 00f8 099A     		ldr	r2, [sp, #36]
 201 00fa 1F49     		ldr	r1, .L16+32
 202 00fc 2846     		mov	r0, r5
 203 00fe FFF7FEFF 		bl	sprintf
 204              	.LVL27:
 567:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 568:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 205              		.loc 1 568 0
 206 0102 2846     		mov	r0, r5
 207 0104 FFF7FEFF 		bl	strlen
 208              	.LVL28:
 209 0108 80B2     		uxth	r0, r0
 210 010a FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 211              	.LVL29:
 569:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status == WiFi_MODULE_SUCCESS)
 212              		.loc 1 569 0
 213 010e 0346     		mov	r3, r0
 214 0110 F0B1     		cbz	r0, .L15
 215              	.LVL30:
 216              	.L5:
 570:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 571:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = USART_Receive_AT_Resp( );
 572:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 573:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 574:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 575:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 576:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
 577:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 578:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.TIME=<seconds> */  
 579:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();  
 580:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.TIME=%lu",(unsigned long)WiFi_Counter_Variables.epoch_time)
 581:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
 582:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
 583:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS) return status; 
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 15


 584:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 585:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*AT+S.TLSCERT=ca,<size><CR><Peer CA>*/
 586:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(ca_certificate.certificate) {
 587:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Reset_AT_CMD_Buffer();
 588:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.AT_event_processing = WIFI_CERT_WRITE_EVENT;
 589:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.send_data = WIFI_TRUE;
 590:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.curr_DataLength = (ca_certificate.certificate_size);
 591:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.curr_data = (char *)ca_certificate.certificate;
 592:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.TLSCERT=Ca,%d %s",WiFi_Counter_Variables.curr_DataLength,
 593:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
 594:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
 595:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.AT_event_processing = WIFI_NO_EVENT;
 596:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status; 
 597:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 598:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 599:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /*AT+S.TLSCERT=auth,<Peer CA Authority Key Id>*/
 600:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(client_domain.certificate) {
 601:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Reset_AT_CMD_Buffer();
 602:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.AT_event_processing = WIFI_CERT_WRITE_EVENT;
 603:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.send_data = WIFI_TRUE;
 604:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.curr_DataLength = client_domain.certificate_size;
 605:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.curr_data = (char *)client_domain.certificate;
 606:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.TLSCERT=Auth,%d %s", WiFi_Counter_Variables.curr_DataLeng
 607:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
 608:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
 609:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.AT_event_processing = WIFI_NO_EVENT;
 610:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status; 
 611:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 612:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 613:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*AT+S.TLSCERT=cert,<size><CR><SPWF04S certificate>*/
 614:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(tls_certificate.certificate) {
 615:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Reset_AT_CMD_Buffer();
 616:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.AT_event_processing = WIFI_CERT_WRITE_EVENT;
 617:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.send_data = WIFI_TRUE;
 618:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.curr_DataLength = (tls_certificate.certificate_size);
 619:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.curr_data = (char *)tls_certificate.certificate;
 620:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.TLSCERT=cert,%d %s",WiFi_Counter_Variables.curr_DataLengt
 621:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
 622:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
 623:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.AT_event_processing = WIFI_NO_EVENT;
 624:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status; 
 625:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 626:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 627:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*AT+S.TLSCERT=key,<size><CR><SPWF04S private key>*/
 628:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(certificate_key.certificate) {
 629:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Reset_AT_CMD_Buffer();
 630:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.AT_event_processing = WIFI_CERT_WRITE_EVENT;
 631:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.send_data = WIFI_TRUE;
 632:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.curr_DataLength = (certificate_key.certificate_size);
 633:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.curr_data = (char *)certificate_key.certificate;
 634:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.TLSCERT=key,%d %s",WiFi_Counter_Variables.curr_DataLength
 635:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
 636:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
 637:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.AT_event_processing = WIFI_NO_EVENT;
 638:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status; 
 639:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 640:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 16


 641:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
 642:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 217              		.loc 1 642 0
 218 0112 1846     		mov	r0, r3
 219 0114 05B0     		add	sp, sp, #20
 220              	.LCFI2:
 221              		.cfi_remember_state
 222              		.cfi_def_cfa_offset 12
 223              		@ sp needed
 224 0116 30BD     		pop	{r4, r5, pc}
 225              	.LVL31:
 226              	.L2:
 227              	.LCFI3:
 228              		.cfi_restore_state
 496:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 229              		.loc 1 496 0
 230 0118 104A     		ldr	r2, .L16+4
 231 011a C2F8BC30 		str	r3, [r2, #188]
 232 011e 7EE7     		b	.L3
 233              	.LVL32:
 234              	.L11:
 516:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status;
 235              		.loc 1 516 0
 236 0120 FFF7FEFF 		bl	USART_Receive_AT_Resp
 237              	.LVL33:
 517:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 238              		.loc 1 517 0
 239 0124 0346     		mov	r3, r0
 240 0126 0028     		cmp	r0, #0
 241 0128 A6D0     		beq	.L6
 242 012a F2E7     		b	.L5
 243              	.L12:
 528:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;
 244              		.loc 1 528 0
 245 012c FFF7FEFF 		bl	USART_Receive_AT_Resp
 246              	.LVL34:
 529:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
 247              		.loc 1 529 0
 248 0130 0346     		mov	r3, r0
 249 0132 0028     		cmp	r0, #0
 250 0134 B4D0     		beq	.L7
 251 0136 ECE7     		b	.L5
 252              	.L13:
 545:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;
 253              		.loc 1 545 0
 254 0138 FFF7FEFF 		bl	USART_Receive_AT_Resp
 255              	.LVL35:
 546:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }  
 256              		.loc 1 546 0
 257 013c 0346     		mov	r3, r0
 258 013e 0028     		cmp	r0, #0
 259 0140 C1D0     		beq	.L8
 260 0142 E6E7     		b	.L5
 261              	.L14:
 558:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;
 262              		.loc 1 558 0
 263 0144 FFF7FEFF 		bl	USART_Receive_AT_Resp
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 17


 264              	.LVL36:
 559:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
 265              		.loc 1 559 0
 266 0148 0346     		mov	r3, r0
 267 014a 0028     		cmp	r0, #0
 268 014c CED0     		beq	.L9
 269 014e E0E7     		b	.L5
 270              	.L15:
 571:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 271              		.loc 1 571 0
 272 0150 FFF7FEFF 		bl	USART_Receive_AT_Resp
 273              	.LVL37:
 274 0154 0346     		mov	r3, r0
 275              	.LVL38:
 276 0156 DCE7     		b	.L5
 277              	.L17:
 278              		.align	2
 279              	.L16:
 280 0158 A91FA656 		.word	1453727657
 281 015c 00000000 		.word	WiFi_Counter_Variables
 282 0160 00000000 		.word	WiFi_AT_Cmd_Buff
 283 0164 00000000 		.word	.LC0
 284 0168 1C000000 		.word	.LC1
 285 016c 30000000 		.word	.LC2
 286 0170 48000000 		.word	.LC3
 287 0174 64000000 		.word	.LC4
 288 0178 80000000 		.word	.LC5
 289              		.cfi_endproc
 290              	.LFE276:
 292              		.section	.text.wifi_ping,"ax",%progbits
 293              		.align	1
 294              		.global	wifi_ping
 295              		.syntax unified
 296              		.thumb
 297              		.thumb_func
 298              		.fpu fpv4-sp-d16
 300              	wifi_ping:
 301              	.LFB277:
 643:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 644:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 645:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
 646:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_ping
 647:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         issues a single ICMP ECHO request to the given host.
 648:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  hostname: Target host. DNS resolvable name or IP address.
 649:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t: status of PING Command.
 650:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
 651:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_ping(uint8_t * hostname)
 652:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 302              		.loc 1 652 0
 303              		.cfi_startproc
 304              		@ args = 0, pretend = 0, frame = 0
 305              		@ frame_needed = 0, uses_anonymous_args = 0
 306              	.LVL39:
 307 0000 10B5     		push	{r4, lr}
 308              	.LCFI4:
 309              		.cfi_def_cfa_offset 8
 310              		.cfi_offset 4, -8
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 18


 311              		.cfi_offset 14, -4
 312              	.LVL40:
 653:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    WiFi_Status_t status = WiFi_MODULE_SUCCESS;   
 654:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    
 655:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(CONSOLE_UART_ENABLED)   
 656:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    sprintf((char*)WiFi_AT_Cmd_Buff,AT_PING,hostname);        
 313              		.loc 1 656 0
 314 0002 0A4C     		ldr	r4, .L22
 315 0004 0246     		mov	r2, r0
 316 0006 0A49     		ldr	r1, .L22+4
 317 0008 2046     		mov	r0, r4
 318              	.LVL41:
 319 000a FFF7FEFF 		bl	sprintf
 320              	.LVL42:
 657:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 321              		.loc 1 657 0
 322 000e 2046     		mov	r0, r4
 323 0010 FFF7FEFF 		bl	strlen
 324              	.LVL43:
 325 0014 80B2     		uxth	r0, r0
 326 0016 FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 327              	.LVL44:
 658:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
 659:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.PING=1,56,%s",hostname);
 660:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
 661:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    status = WiFi_MODULE_SUCCESS;
 662:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
 663:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status == WiFi_MODULE_SUCCESS)
 328              		.loc 1 663 0
 329 001a 0346     		mov	r3, r0
 330 001c 08B1     		cbz	r0, .L21
 331              	.LVL45:
 332              	.L19:
 664:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 665:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = USART_Receive_AT_Resp( );
 666:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
 667:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 668:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return status;
 669:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 333              		.loc 1 669 0
 334 001e 1846     		mov	r0, r3
 335 0020 10BD     		pop	{r4, pc}
 336              	.LVL46:
 337              	.L21:
 665:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
 338              		.loc 1 665 0
 339 0022 FFF7FEFF 		bl	USART_Receive_AT_Resp
 340              	.LVL47:
 341 0026 0346     		mov	r3, r0
 342              	.LVL48:
 343 0028 F9E7     		b	.L19
 344              	.L23:
 345 002a 00BF     		.align	2
 346              	.L22:
 347 002c 00000000 		.word	WiFi_AT_Cmd_Buff
 348 0030 00000000 		.word	.LC6
 349              		.cfi_endproc
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 19


 350              	.LFE277:
 352              		.section	.text.wifi_websocket_client_open,"ax",%progbits
 353              		.align	1
 354              		.global	wifi_websocket_client_open
 355              		.syntax unified
 356              		.thumb
 357              		.thumb_func
 358              		.fpu fpv4-sp-d16
 360              	wifi_websocket_client_open:
 361              	.LFB278:
 670:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 671:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
 672:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_websocket_client_open
 673:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Open a network websocket
 674:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  Hostname hostname to connect to
 675:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         portnumber portnumber of the Host to connect to
 676:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         protocol tcp or udp protocol
 677:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         sock_id socket id of the opened socket returned to the user
 678:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of socket open request
 679:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
 680:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_websocket_client_open(uint8_t * hostname, uint32_t port_number, uint8_t * protoc
 681:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 362              		.loc 1 681 0
 363              		.cfi_startproc
 364              		@ args = 0, pretend = 0, frame = 0
 365              		@ frame_needed = 0, uses_anonymous_args = 0
 366              	.LVL49:
 367 0000 10B5     		push	{r4, lr}
 368              	.LCFI5:
 369              		.cfi_def_cfa_offset 8
 370              		.cfi_offset 4, -8
 371              		.cfi_offset 14, -4
 372 0002 1C46     		mov	r4, r3
 373              	.LVL50:
 682:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
 683:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 684:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Client_Open_Event(hostname,port_number,protocol, WEB_SOCKET);
 374              		.loc 1 684 0
 375 0004 0123     		movs	r3, #1
 376              	.LVL51:
 377 0006 FFF7FEFF 		bl	Queue_Client_Open_Event
 378              	.LVL52:
 685:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
 379              		.loc 1 685 0
 380 000a FFF7FEFF 		bl	USART_Receive_AT_Resp
 381              	.LVL53:
 686:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 687:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   *sock_id = WiFi_Counter_Variables.Socket_Open_ID; //return the socket id to the user
 382              		.loc 1 687 0
 383 000e 034B     		ldr	r3, .L26
 384 0010 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 385 0012 C3F30203 		ubfx	r3, r3, #0, #3
 386 0016 2370     		strb	r3, [r4]
 688:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
 689:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 387              		.loc 1 689 0
 388 0018 10BD     		pop	{r4, pc}
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 20


 389              	.LVL54:
 390              	.L27:
 391 001a 00BF     		.align	2
 392              	.L26:
 393 001c 00000000 		.word	WiFi_Counter_Variables
 394              		.cfi_endproc
 395              	.LFE278:
 397              		.section	.text.wifi_websocket_client_write,"ax",%progbits
 398              		.align	1
 399              		.global	wifi_websocket_client_write
 400              		.syntax unified
 401              		.thumb
 402              		.thumb_func
 403              		.fpu fpv4-sp-d16
 405              	wifi_websocket_client_write:
 406              	.LFB279:
 690:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 691:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
 692:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_websocket_client_write
 693:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Write len bytes of data to socket
 694:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  sock_id socket ID of the websocket to write to
 695:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         DataLength: data length to send
 696:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         pData : pointer of data buffer to be written
 697:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of socket write request
 698:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
 699:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_websocket_client_write(uint8_t sock_id, uint32_t DataLength, char * pData)
 700:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 407              		.loc 1 700 0
 408              		.cfi_startproc
 409              		@ args = 0, pretend = 0, frame = 0
 410              		@ frame_needed = 0, uses_anonymous_args = 0
 411              	.LVL55:
 412 0000 08B5     		push	{r3, lr}
 413              	.LCFI6:
 414              		.cfi_def_cfa_offset 8
 415              		.cfi_offset 3, -8
 416              		.cfi_offset 14, -4
 417              	.LVL56:
 701:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.SOCKW=00,11<cr> */
 702:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
 703:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 704:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //Check if sock_id is open
 705:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(!open_web_socket[sock_id])
 418              		.loc 1 705 0
 419 0002 094B     		ldr	r3, .L35
 420 0004 1B5C     		ldrb	r3, [r3, r0]	@ zero_extendqisi2
 421 0006 0BB9     		cbnz	r3, .L34
 706:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_NOT_READY;
 422              		.loc 1 706 0
 423 0008 0520     		movs	r0, #5
 424              	.LVL57:
 425 000a 08BD     		pop	{r3, pc}
 426              	.LVL58:
 427              	.L34:
 707:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 708:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(DataLength <= 0 && DataLength > WiFi_Counter_Variables.wifi_socket_write_limit)
 428              		.loc 1 708 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 21


 429 000c 31B9     		cbnz	r1, .L30
 430              		.loc 1 708 0 is_stmt 0 discriminator 1
 431 000e 074B     		ldr	r3, .L35+4
 432 0010 D3F8E430 		ldr	r3, [r3, #228]
 433 0014 9942     		cmp	r1, r3
 434 0016 01D9     		bls	.L30
 709:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_NOT_SUPPORTED;
 435              		.loc 1 709 0 is_stmt 1
 436 0018 0420     		movs	r0, #4
 437              	.LVL59:
 710:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 711:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Client_Write_Event(sock_id,DataLength,pData,WEB_SOCKET);
 712:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
 713:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
 714:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 438              		.loc 1 714 0
 439 001a 08BD     		pop	{r3, pc}
 440              	.LVL60:
 441              	.L30:
 711:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
 442              		.loc 1 711 0
 443 001c 0123     		movs	r3, #1
 444 001e FFF7FEFF 		bl	Queue_Client_Write_Event
 445              	.LVL61:
 712:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
 446              		.loc 1 712 0
 447 0022 FFF7FEFF 		bl	USART_Receive_AT_Resp
 448              	.LVL62:
 713:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 449              		.loc 1 713 0
 450 0026 08BD     		pop	{r3, pc}
 451              	.L36:
 452              		.align	2
 453              	.L35:
 454 0028 00000000 		.word	open_web_socket
 455 002c 00000000 		.word	WiFi_Counter_Variables
 456              		.cfi_endproc
 457              	.LFE279:
 459              		.section	.text.wifi_websocket_client_close,"ax",%progbits
 460              		.align	1
 461              		.global	wifi_websocket_client_close
 462              		.syntax unified
 463              		.thumb
 464              		.thumb_func
 465              		.fpu fpv4-sp-d16
 467              	wifi_websocket_client_close:
 468              	.LFB280:
 715:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 716:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
 717:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_websocket_client_close
 718:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         The WSOCKC command allows to close the websocket
 719:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  sock_close_id the socket ID of the socket which needs to be closed.
 720:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of socket close request
 721:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
 722:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_websocket_client_close(uint8_t sock_close_id)
 723:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 469              		.loc 1 723 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 22


 470              		.cfi_startproc
 471              		@ args = 0, pretend = 0, frame = 0
 472              		@ frame_needed = 0, uses_anonymous_args = 0
 473              	.LVL63:
 474 0000 08B5     		push	{r3, lr}
 475              	.LCFI7:
 476              		.cfi_def_cfa_offset 8
 477              		.cfi_offset 3, -8
 478              		.cfi_offset 14, -4
 479              	.LVL64:
 724:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;  
 725:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Client_Close_Event(sock_close_id, WEB_SOCKET);
 480              		.loc 1 725 0
 481 0002 0121     		movs	r1, #1
 482 0004 FFF7FEFF 		bl	Queue_Client_Close_Event
 483              	.LVL65:
 726:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
 727:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 728:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 484              		.loc 1 728 0
 485 0008 0020     		movs	r0, #0
 486 000a 08BD     		pop	{r3, pc}
 487              		.cfi_endproc
 488              	.LFE280:
 490              		.section	.text.wifi_socket_client_open,"ax",%progbits
 491              		.align	1
 492              		.global	wifi_socket_client_open
 493              		.syntax unified
 494              		.thumb
 495              		.thumb_func
 496              		.fpu fpv4-sp-d16
 498              	wifi_socket_client_open:
 499              	.LFB281:
 729:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 730:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
 731:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_socket_client_open
 732:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Open a network socket
 733:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  Hostname hostname to connect to
 734:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         portnumber portnumber of the Host to connect to
 735:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         protocol tcp or udp protocol
 736:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         sock_id socket id of the opened socket returned to the user
 737:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of socket open request
 738:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
 739:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_socket_client_open(uint8_t * hostname, uint32_t port_number, uint8_t * protocol,
 740:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 500              		.loc 1 740 0
 501              		.cfi_startproc
 502              		@ args = 0, pretend = 0, frame = 0
 503              		@ frame_needed = 0, uses_anonymous_args = 0
 504              	.LVL66:
 505 0000 10B5     		push	{r4, lr}
 506              	.LCFI8:
 507              		.cfi_def_cfa_offset 8
 508              		.cfi_offset 4, -8
 509              		.cfi_offset 14, -4
 510 0002 1C46     		mov	r4, r3
 511              	.LVL67:
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 23


 741:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
 742:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 743:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Client_Open_Event(hostname,port_number,protocol, NET_SOCKET);
 512              		.loc 1 743 0
 513 0004 0223     		movs	r3, #2
 514              	.LVL68:
 515 0006 FFF7FEFF 		bl	Queue_Client_Open_Event
 516              	.LVL69:
 744:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
 517              		.loc 1 744 0
 518 000a FFF7FEFF 		bl	USART_Receive_AT_Resp
 519              	.LVL70:
 745:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 746:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   *sock_id = WiFi_Counter_Variables.Socket_Open_ID; //return the socket id to the user
 520              		.loc 1 746 0
 521 000e 034B     		ldr	r3, .L41
 522 0010 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 523 0012 C3F30203 		ubfx	r3, r3, #0, #3
 524 0016 2370     		strb	r3, [r4]
 747:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
 748:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 525              		.loc 1 748 0
 526 0018 10BD     		pop	{r4, pc}
 527              	.LVL71:
 528              	.L42:
 529 001a 00BF     		.align	2
 530              	.L41:
 531 001c 00000000 		.word	WiFi_Counter_Variables
 532              		.cfi_endproc
 533              	.LFE281:
 535              		.section	.text.Open_Serial_Port,"ax",%progbits
 536              		.align	1
 537              		.global	Open_Serial_Port
 538              		.syntax unified
 539              		.thumb
 540              		.thumb_func
 541              		.fpu fpv4-sp-d16
 543              	Open_Serial_Port:
 544              	.LFB282:
 749:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 750:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 751:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
 752:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  Open_Serial_Port
 753:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Open a network socket
 754:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  None
 755:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : Wifi status
 756:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
 757:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t Open_Serial_Port()
 758:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 545              		.loc 1 758 0
 546              		.cfi_startproc
 547              		@ args = 0, pretend = 0, frame = 0
 548              		@ frame_needed = 0, uses_anonymous_args = 0
 549 0000 08B5     		push	{r3, lr}
 550              	.LCFI9:
 551              		.cfi_def_cfa_offset 8
 552              		.cfi_offset 3, -8
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 24


 553              		.cfi_offset 14, -4
 554              	.LVL72:
 759:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
 760:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.SOCKOS=2<cr> */
 761:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();
 555              		.loc 1 761 0
 556 0002 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 557              	.LVL73:
 762:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //sprintf((char*)WiFi_AT_Cmd_Buff,"\rAT+S.SOCKOS=%d\r",SerialPortNo);        
 763:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 558              		.loc 1 763 0
 559 0006 0748     		ldr	r0, .L47
 560 0008 FFF7FEFF 		bl	strlen
 561              	.LVL74:
 562 000c 80B2     		uxth	r0, r0
 563 000e FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 564              	.LVL75:
 764:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 765:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status==WiFi_MODULE_SUCCESS)
 565              		.loc 1 765 0
 566 0012 0346     		mov	r3, r0
 567 0014 08B1     		cbz	r0, .L46
 568              	.LVL76:
 569              	.L44:
 766:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
 767:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( ); 
 768:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 769:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
 770:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 570              		.loc 1 770 0
 571 0016 1846     		mov	r0, r3
 572 0018 08BD     		pop	{r3, pc}
 573              	.LVL77:
 574              	.L46:
 767:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 575              		.loc 1 767 0
 576 001a FFF7FEFF 		bl	USART_Receive_AT_Resp
 577              	.LVL78:
 578 001e 0346     		mov	r3, r0
 579              	.LVL79:
 580 0020 F9E7     		b	.L44
 581              	.L48:
 582 0022 00BF     		.align	2
 583              	.L47:
 584 0024 00000000 		.word	WiFi_AT_Cmd_Buff
 585              		.cfi_endproc
 586              	.LFE282:
 588              		.section	.text.wifi_socket_client_write,"ax",%progbits
 589              		.align	1
 590              		.global	wifi_socket_client_write
 591              		.syntax unified
 592              		.thumb
 593              		.thumb_func
 594              		.fpu fpv4-sp-d16
 596              	wifi_socket_client_write:
 597              	.LFB283:
 771:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 25


 772:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
 773:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_socket_client_write
 774:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Write len bytes of data to socket
 775:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  sock_id socket ID of the socket to write to
 776:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         DataLength: data length to send
 777:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         pData : pointer of data buffer to be written
 778:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of socket write request
 779:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
 780:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_socket_client_write(uint8_t sock_id, uint32_t DataLength, char * pData)
 781:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 598              		.loc 1 781 0
 599              		.cfi_startproc
 600              		@ args = 0, pretend = 0, frame = 0
 601              		@ frame_needed = 0, uses_anonymous_args = 0
 602              	.LVL80:
 782:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.SOCKW=00,11<cr> */
 783:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
 784:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 785:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //Check if sock_id is open
 786:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(!open_sockets[sock_id])
 603              		.loc 1 786 0
 604 0000 1B4B     		ldr	r3, .L64
 605 0002 1B5C     		ldrb	r3, [r3, r0]	@ zero_extendqisi2
 606 0004 13B9     		cbnz	r3, .L62
 787:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_NOT_READY;  
 607              		.loc 1 787 0
 608 0006 0523     		movs	r3, #5
 788:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
 789:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(DataLength <= 0)
 790:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_NOT_SUPPORTED;
 791:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 792:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #if defined(SPWF01)
 793:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     uint16_t chunk_count = 0, chunk_index;
 794:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     uint32_t chunk_size = 0;
 795:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     chunk_count = DataLength/MAX_CLIENT_WRITE_SIZE;
 796:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     chunk_count = (DataLength % MAX_CLIENT_WRITE_SIZE == 0)? chunk_count: chunk_count+1;
 797:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     chunk_index = 0;
 798:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
 799:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     while(chunk_index < chunk_count)
 800:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 801:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       chunk_size = (DataLength > MAX_CLIENT_WRITE_SIZE)? MAX_CLIENT_WRITE_SIZE: DataLength;
 802:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       DataLength = (DataLength > MAX_CLIENT_WRITE_SIZE)? (DataLength-MAX_CLIENT_WRITE_SIZE): 0;
 803:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       Queue_Client_Write_Event(sock_id,chunk_size,pData+(chunk_index*MAX_CLIENT_WRITE_SIZE), NET_SO
 804:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Receive_AT_Resp( );
 805:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS)
 806:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         break;
 807:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       chunk_index++;
 808:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
 809:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #else //free to use max proportional to free heap size
 810:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(DataLength > WiFi_Counter_Variables.wifi_socket_write_limit)
 811:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       return WiFi_NOT_SUPPORTED;
 812:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
 813:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Queue_Client_Write_Event(sock_id,DataLength,pData, NET_SOCKET);
 814:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
 815:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
 816:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 817:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 26


 818:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 609              		.loc 1 818 0
 610 0008 1846     		mov	r0, r3
 611              	.LVL81:
 612 000a 7047     		bx	lr
 613              	.LVL82:
 614              	.L62:
 781:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.SOCKW=00,11<cr> */
 615              		.loc 1 781 0
 616 000c 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 617              	.LCFI10:
 618              		.cfi_def_cfa_offset 24
 619              		.cfi_offset 4, -24
 620              		.cfi_offset 5, -20
 621              		.cfi_offset 6, -16
 622              		.cfi_offset 7, -12
 623              		.cfi_offset 8, -8
 624              		.cfi_offset 14, -4
 625 0010 0646     		mov	r6, r0
 626 0012 0D46     		mov	r5, r1
 627 0014 1746     		mov	r7, r2
 789:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_NOT_SUPPORTED;
 628              		.loc 1 789 0
 629 0016 19B9     		cbnz	r1, .L63
 790:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 630              		.loc 1 790 0
 631 0018 0423     		movs	r3, #4
 632              	.LVL83:
 633              	.L50:
 634              		.loc 1 818 0
 635 001a 1846     		mov	r0, r3
 636 001c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 637              	.LVL84:
 638              	.L63:
 795:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     chunk_count = (DataLength % MAX_CLIENT_WRITE_SIZE == 0)? chunk_count: chunk_count+1;
 639              		.loc 1 795 0
 640 0020 C1F30F38 		ubfx	r8, r1, #12, #16
 641              	.LVL85:
 796:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     chunk_index = 0;
 642              		.loc 1 796 0
 643 0024 C1F30B03 		ubfx	r3, r1, #0, #12
 644 0028 1BB1     		cbz	r3, .L51
 796:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     chunk_index = 0;
 645              		.loc 1 796 0 is_stmt 0 discriminator 1
 646 002a 08F10108 		add	r8, r8, #1
 647              	.LVL86:
 648 002e 1FFA88F8 		uxth	r8, r8
 649              	.LVL87:
 650              	.L51:
 797:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
 651              		.loc 1 797 0 is_stmt 1 discriminator 4
 652 0032 0024     		movs	r4, #0
 783:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 653              		.loc 1 783 0 discriminator 4
 654 0034 2346     		mov	r3, r4
 799:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 655              		.loc 1 799 0 discriminator 4
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 27


 656 0036 0DE0     		b	.L52
 657              	.LVL88:
 658              	.L57:
 802:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       Queue_Client_Write_Event(sock_id,chunk_size,pData+(chunk_index*MAX_CLIENT_WRITE_SIZE), NET_SO
 659              		.loc 1 802 0
 660 0038 0025     		movs	r5, #0
 661              	.LVL89:
 662              	.L53:
 803:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Receive_AT_Resp( );
 663              		.loc 1 803 0 discriminator 4
 664 003a 0223     		movs	r3, #2
 665              	.LVL90:
 666 003c 07EB0432 		add	r2, r7, r4, lsl #12
 667 0040 3046     		mov	r0, r6
 668 0042 FFF7FEFF 		bl	Queue_Client_Write_Event
 669              	.LVL91:
 804:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS)
 670              		.loc 1 804 0 discriminator 4
 671 0046 FFF7FEFF 		bl	USART_Receive_AT_Resp
 672              	.LVL92:
 805:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         break;
 673              		.loc 1 805 0 discriminator 4
 674 004a 0346     		mov	r3, r0
 675 004c 0028     		cmp	r0, #0
 676 004e E4D1     		bne	.L50
 807:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
 677              		.loc 1 807 0
 678 0050 0134     		adds	r4, r4, #1
 679              	.LVL93:
 680 0052 A4B2     		uxth	r4, r4
 681              	.LVL94:
 682              	.L52:
 799:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 683              		.loc 1 799 0
 684 0054 4445     		cmp	r4, r8
 685 0056 E0D2     		bcs	.L50
 801:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       DataLength = (DataLength > MAX_CLIENT_WRITE_SIZE)? (DataLength-MAX_CLIENT_WRITE_SIZE): 0;
 686              		.loc 1 801 0
 687 0058 2946     		mov	r1, r5
 688 005a B5F5805F 		cmp	r5, #4096
 689 005e 28BF     		it	cs
 690 0060 4FF48051 		movcs	r1, #4096
 691              	.LVL95:
 802:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       Queue_Client_Write_Event(sock_id,chunk_size,pData+(chunk_index*MAX_CLIENT_WRITE_SIZE), NET_SO
 692              		.loc 1 802 0
 693 0064 B5F5805F 		cmp	r5, #4096
 694 0068 E6D9     		bls	.L57
 802:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       Queue_Client_Write_Event(sock_id,chunk_size,pData+(chunk_index*MAX_CLIENT_WRITE_SIZE), NET_SO
 695              		.loc 1 802 0 is_stmt 0 discriminator 1
 696 006a A5F58055 		sub	r5, r5, #4096
 697              	.LVL96:
 698 006e E4E7     		b	.L53
 699              	.L65:
 700              		.align	2
 701              	.L64:
 702 0070 00000000 		.word	open_sockets
 703              		.cfi_endproc
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 28


 704              	.LFE283:
 706              		.section	.text.wifi_socket_client_close,"ax",%progbits
 707              		.align	1
 708              		.global	wifi_socket_client_close
 709              		.syntax unified
 710              		.thumb
 711              		.thumb_func
 712              		.fpu fpv4-sp-d16
 714              	wifi_socket_client_close:
 715              	.LFB285:
 819:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 820:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
 821:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  Socket_Read
 822:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Return len bytes of data from socket
 823:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  DataLength: data length to read
 824:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of socket read request
 825:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
 826:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t Socket_Read(uint16_t DataLength)
 827:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 828:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.SOCKR=01,12<cr> */
 829:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
 830:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #if defined(SPWF01) && defined(CONSOLE_UART_ENABLED)
 831:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     wait_for_command_mode();
 832:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
 833:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 834:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.SOCKON=myserver,1234,t<cr> */
 835:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #if defined(CONSOLE_UART_ENABLED)
 836:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,AT_SOCKET_READ,WiFi_Counter_Variables.sockon_query_id,DataLengt
 837:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.SockON_Data_Length = DataLength;
 838:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 839:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #else
 840:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     //printf("\r\nAT+S.SOCKR");
 841:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.SOCKR=%d,%d",WiFi_Counter_Variables.sockon_query_id,DataL
 842:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.SockON_Data_Length = DataLength;
 843:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_POLL);
 844:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     //@CHECK-TBD!!: Changing AT_event_processing state without checking status flag
 845:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.AT_event_processing = WIFI_CLIENT_SOCKET_READ_DATA;
 846:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Start_AT_CMD_Timer();
 847:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = WiFi_MODULE_SUCCESS;//@TBD: Check return error code from run_spi_cmd
 848:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
 849:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 850:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
 851:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
 852:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(WiFi_Control_Variables.stop_event_dequeue == WIFI_FALSE)
 853:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         WiFi_Control_Variables.stop_event_dequeue = WIFI_TRUE;
 854:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    
 855:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /* enable the data receive in chunk mode only in spwfsa01 *///--------> TBD->Enable chunk mode 
 856:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #ifdef SPWF01
 857:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         WiFi_Counter_Variables.last_process_buffer_index = 5;
 858:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         WiFi_Control_Variables.enable_receive_data_chunk = WIFI_TRUE;
 859:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         WiFi_Control_Variables.enable_sock_read = WIFI_TRUE;
 860:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #elif defined(SPWF04) && !defined(CONSOLE_UART_ENABLED)
 861:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         WiFi_Control_Variables.enable_sock_read = WIFI_TRUE;
 862:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif
 863:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 864:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 865:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 29


 866:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 867:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 868:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04
 869:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
 870:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  Socket_Server_Read
 871:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Return len bytes of data from socket
 872:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  DataLength: data length to read
 873:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of socket read request
 874:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
 875:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t Socket_Server_Read(uint16_t DataLength)
 876:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 877:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.SOCKR=01,12<cr> */
 878:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
 879:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #if defined(SPWF01) && defined(CONSOLE_UART_ENABLED)
 880:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     wait_for_command_mode();
 881:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
 882:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 883:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.SOCKDR=%d,%d,%d<cr> */
 884:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_SERVER_SOCKET_READ,WiFi_Counter_Variables.sockdon_query_id, Wi
 885:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 886:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #if defined(CONSOLE_UART_ENABLED)
 887:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 888:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #else
 889:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_POLL);
 890:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     //@CHECK-TBD!!: Changing AT_event_processing state without checking status flag
 891:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.AT_event_processing = WIFI_SERVER_SOCKET_READ_DATA;
 892:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Start_AT_CMD_Timer();
 893:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = WiFi_MODULE_SUCCESS;//@TBD: Check return error code from run_spi_cmd
 894:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
 895:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 896:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
 897:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
 898:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Control_Variables.stop_event_dequeue = (WiFi_Control_Variables.stop_event_dequeue == WIFI_
 899:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.SockON_Data_Length = DataLength;
 900:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #if defined(SPWF04) && !defined(CONSOLE_UART_ENABLED)
 901:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       WiFi_Control_Variables.enable_sock_read = WIFI_TRUE;
 902:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif
 903:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 904:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
 905:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 906:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 907:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
 908:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  Websocket_Read
 909:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Return len bytes of data from socket
 910:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  DataLength: data length to read
 911:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of socket read request
 912:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
 913:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t Websocket_Read(uint16_t DataLength)
 914:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 915:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.WSOCKR=01,12<cr> */
 916:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
 917:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 918:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(CONSOLE_UART_ENABLED)
 919:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_WEB_SOCKET_READ,WiFi_Counter_Variables.sockon_query_id,DataLen
 920:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 921:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
 922:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //printf("\r\nAT+S.SOCKR");
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 30


 923:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.WSOCKR=%d,%d",WiFi_Counter_Variables.sockon_query_id,DataLe
 924:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_POLL);
 925:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //@CHECK-TBD!!: Changing AT_event_processing state without checking status flag
 926:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   IO_status_flag.AT_event_processing = WIFI_CLIENT_WEB_SOCKET_READ_DATA;
 927:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Start_AT_CMD_Timer();
 928:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = WiFi_MODULE_SUCCESS;//@TBD: Check return error code from run_spi_cmd
 929:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
 930:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
 931:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
 932:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(WiFi_Control_Variables.stop_event_dequeue == WIFI_FALSE)
 933:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         WiFi_Control_Variables.stop_event_dequeue = WIFI_TRUE;
 934:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.SockON_Data_Length = DataLength;
 935:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
 936:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /* enable sock_read for SPI only */
 937:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #if defined(SPWF04) && !defined(CONSOLE_UART_ENABLED)
 938:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         WiFi_Control_Variables.enable_sock_read = WIFI_TRUE;
 939:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif
 940:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    
 941:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /* enable the data receive in chunk mode only in spwfsa01 *///--------> TBD->Enable chunk mode 
 942:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF01
 943:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.last_process_buffer_index = 5;
 944:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Control_Variables.enable_receive_data_chunk = WIFI_TRUE;
 945:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
 946:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.last_process_buffer_index = 10;
 947:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
 948:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 949:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 950:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
 951:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 952:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
 953:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 954:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
 955:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_socket_client_close
 956:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         The SOCKC command allows to close socket
 957:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  sock_close_id the socket ID of the socket which needs to be closed.
 958:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of socket close request
 959:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
 960:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_socket_client_close(uint8_t sock_close_id)
 961:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 716              		.loc 1 961 0 is_stmt 1
 717              		.cfi_startproc
 718              		@ args = 0, pretend = 0, frame = 0
 719              		@ frame_needed = 0, uses_anonymous_args = 0
 720              	.LVL97:
 721 0000 08B5     		push	{r3, lr}
 722              	.LCFI11:
 723              		.cfi_def_cfa_offset 8
 724              		.cfi_offset 3, -8
 725              		.cfi_offset 14, -4
 726              	.LVL98:
 962:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
 963:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* User is asking for a socket close, no need for callback. */
 964:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 965:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #if defined(SPWF01)
 966:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Control_Variables.enable_SockON_Server_Closed_Callback = WIFI_FALSE;
 727              		.loc 1 966 0
 728 0002 074B     		ldr	r3, .L71
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 31


 729 0004 9A79     		ldrb	r2, [r3, #6]	@ zero_extendqisi2
 730 0006 6FF38202 		bfc	r2, #2, #1
 731 000a 9A71     		strb	r2, [r3, #6]
 967:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #else
 968:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Client_Socket_Close_Callback[sock_close_id] = WIFI_FALSE;
 969:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
 970:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(open_sockets[sock_close_id])
 732              		.loc 1 970 0
 733 000c 054B     		ldr	r3, .L71+4
 734 000e 1B5C     		ldrb	r3, [r3, r0]	@ zero_extendqisi2
 735 0010 0BB9     		cbnz	r3, .L70
 971:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
 972:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Queue_Client_Close_Event(sock_close_id, NET_SOCKET);
 973:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return status;
 974:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 975:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   else
 976:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_MODULE_ERROR;
 736              		.loc 1 976 0
 737 0012 0220     		movs	r0, #2
 738              	.LVL99:
 977:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 739              		.loc 1 977 0
 740 0014 08BD     		pop	{r3, pc}
 741              	.LVL100:
 742              	.L70:
 972:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return status;
 743              		.loc 1 972 0
 744 0016 0221     		movs	r1, #2
 745 0018 FFF7FEFF 		bl	Queue_Client_Close_Event
 746              	.LVL101:
 973:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 747              		.loc 1 973 0
 748 001c 0020     		movs	r0, #0
 749 001e 08BD     		pop	{r3, pc}
 750              	.L72:
 751              		.align	2
 752              	.L71:
 753 0020 00000000 		.word	WiFi_Control_Variables
 754 0024 00000000 		.word	open_sockets
 755              		.cfi_endproc
 756              	.LFE285:
 758              		.section	.text.wifi_socket_server_open,"ax",%progbits
 759              		.align	1
 760              		.global	wifi_socket_server_open
 761              		.syntax unified
 762              		.thumb
 763              		.thumb_func
 764              		.fpu fpv4-sp-d16
 766              	wifi_socket_server_open:
 767              	.LFB287:
 978:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 979:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
 980:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  Socket_Pending_Data
 981:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Query pending data.It will returns the number of bytes of data waiting on socket
 982:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param None
 983:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval uint8_t :number of bytes of data waiting on socket
 984:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 32


 985:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** void Socket_Pending_Data()
 986:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 987:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.SOCKQ=01<cr> */
 988:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();
 989:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 990:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #if defined(SPWF01)
 991:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     wait_for_command_mode();
 992:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
 993:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 994:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(open_sockets[WiFi_Counter_Variables.sockon_query_id])
 995:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 996:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(WiFi_Control_Variables.stop_event_dequeue == WIFI_FALSE)
 997:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         WiFi_Control_Variables.stop_event_dequeue = WIFI_TRUE;
 998:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
 999:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #if defined(CONSOLE_UART_ENABLED)
1000:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         sprintf((char*)WiFi_AT_Cmd_Buff,AT_QUERY_PENDING_DATA,WiFi_Counter_Variables.sockon_query_i
1001:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
1002:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #else
1003:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         //printf("\r\nAT+S.SOCKQ");
1004:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.SOCKQ=%d",WiFi_Counter_Variables.sockon_query_id);   
1005:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_POLL);
1006:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         //@CHECK-TBD!!: Changing AT_event_processing state without checking status flag
1007:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         IO_status_flag.AT_event_processing = WIFI_CLIENT_SOCKET_QUERY_EVENT;
1008:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         Start_AT_CMD_Timer();
1009:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         //status = WiFi_MODULE_SUCCESS;//@TBD: Check return error code from run_spi_cmd
1010:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #endif
1011:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
1012:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #ifndef CONSOLE_UART_ENABLED
1013:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         //prevent the OK received after socket close command to be Q'ed
1014:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         IO_status_flag.prevent_push_OK_event       = WIFI_TRUE;
1015:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #endif
1016:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
1017:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1018:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1019:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04
1020:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1021:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  Server_Pending_Data
1022:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Query pending data.It will returns the number of bytes of data waiting on socket
1023:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  None
1024:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval void
1025:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1026:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** void Server_Pending_Data()
1027:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1028:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* "AT+S.SOCKDQ=%d,%d\r" */
1029:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();
1030:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1031:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #if defined(SPWF01) && defined(CONSOLE_UART_ENABLED)
1032:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     wait_for_command_mode();
1033:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
1034:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1035:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(open_server_sockets[WiFi_Counter_Variables.sockdon_query_id])
1036:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
1037:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(WiFi_Control_Variables.stop_event_dequeue == WIFI_FALSE)
1038:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       WiFi_Control_Variables.stop_event_dequeue = WIFI_TRUE;
1039:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #if defined(CONSOLE_UART_ENABLED)
1040:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,AT_SERVER_SOCKET_QUERY,WiFi_Counter_Variables.sockdon_query_i
1041:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 33


1042:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #else
1043:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.SOCKDQ=%d,%d",WiFi_Counter_Variables.sockdon_query_id, 
1044:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_POLL);
1045:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       //@CHECK-TBD!!: Changing AT_event_processing state without checking status flag
1046:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       IO_status_flag.AT_event_processing = WIFI_SERVER_SOCKET_QUERY_EVENT;
1047:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       Start_AT_CMD_Timer();
1048:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       //status = WiFi_MODULE_SUCCESS;//@TBD: Check return error code from run_spi_cmd
1049:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif
1050:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #ifndef CONSOLE_UART_ENABLED
1051:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       //prevent the OK received after socket close command to be Q'ed
1052:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       IO_status_flag.prevent_push_OK_event       = WIFI_TRUE;
1053:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif
1054:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
1055:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1056:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1057:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1058:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  Websocket_Pending_Data
1059:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Query pending data.It will returns the number of bytes of data waiting on websocket
1060:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  None
1061:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval void
1062:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1063:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** void Websocket_Pending_Data()
1064:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1065:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* "AT+S.WSOCKDQ=%d,%d\r" */
1066:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();
1067:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1068:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //if(open_server_sockets[WiFi_Counter_Variables.sockdon_query_id])
1069:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
1070:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(WiFi_Control_Variables.stop_event_dequeue == WIFI_FALSE)
1071:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         WiFi_Control_Variables.stop_event_dequeue = WIFI_TRUE;
1072:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #if defined(CONSOLE_UART_ENABLED)
1073:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,AT_WEB_SOCKET_QUERY,WiFi_Counter_Variables.sockon_query_id); 
1074:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
1075:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #else
1076:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.WSOCKQ=%d",WiFi_Counter_Variables.sockon_query_id);    
1077:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_POLL);
1078:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       //@CHECK-TBD!!: Changing AT_event_processing state without checking status flag
1079:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       IO_status_flag.AT_event_processing = WIFI_CLIENT_WEB_SOCKET_QUERY_EVENT;
1080:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       Start_AT_CMD_Timer();
1081:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       //status = WiFi_MODULE_SUCCESS;//@TBD: Check return error code from run_spi_cmd
1082:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #endif
1083:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifndef CONSOLE_UART_ENABLED
1084:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         //prevent the OK received after socket close command to be Q'ed
1085:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         IO_status_flag.prevent_push_OK_event       = WIFI_TRUE;
1086:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
1087:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
1088:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1089:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
1090:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1091:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1092:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_socket_server_open
1093:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Open a Server socket
1094:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  port_number: port number to connect to
1095:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of server socket request
1096:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1097:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04
1098:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_socket_server_open(uint32_t port_number, uint8_t *protocol, uint8_t *sock_id)
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 34


1099:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1100:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1101:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1102:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Server_Open_Event(port_number,protocol);
1103:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1104:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   *sock_id = WiFi_Counter_Variables.Server_Socket_Open_ID; //return the socket id to the user
1105:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
1106:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1107:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
1108:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_socket_server_open(uint32_t port_number, uint8_t * protocol)
1109:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 768              		.loc 1 1109 0
 769              		.cfi_startproc
 770              		@ args = 0, pretend = 0, frame = 0
 771              		@ frame_needed = 0, uses_anonymous_args = 0
 772              	.LVL102:
 773 0000 08B5     		push	{r3, lr}
 774              	.LCFI12:
 775              		.cfi_def_cfa_offset 8
 776              		.cfi_offset 3, -8
 777              		.cfi_offset 14, -4
 778              	.LVL103:
1110:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1111:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1112:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Server_Open_Event(port_number,protocol);
 779              		.loc 1 1112 0
 780 0002 FFF7FEFF 		bl	Queue_Server_Open_Event
 781              	.LVL104:
1113:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
 782              		.loc 1 1113 0
 783 0006 FFF7FEFF 		bl	USART_Receive_AT_Resp
 784              	.LVL105:
1114:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1115:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
1116:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 785              		.loc 1 1116 0
 786 000a 08BD     		pop	{r3, pc}
 787              		.cfi_endproc
 788              	.LFE287:
 790              		.section	.text.wifi_socket_server_close,"ax",%progbits
 791              		.align	1
 792              		.global	wifi_socket_server_close
 793              		.syntax unified
 794              		.thumb
 795              		.thumb_func
 796              		.fpu fpv4-sp-d16
 798              	wifi_socket_server_close:
 799              	.LFB289:
1117:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1118:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
1119:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1120:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1121:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_socket_server_write
1122:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Write to a Server socket
1123:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  server_id 
1124:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         client_id
1125:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Datalength
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 35


1126:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of server socket request
1127:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1128:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04
1129:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_socket_server_write(uint8_t server_id, uint8_t client_id, uint32_t DataLength,ch
1130:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1131:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.SOCKW=00,11<cr> */
1132:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1133:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1134:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //Check if sock_id is open
1135:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(!open_server_sockets[server_id])
1136:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_NOT_READY;
1137:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1138:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(DataLength<=0 && DataLength > WiFi_Counter_Variables.wifi_socket_write_limit)
1139:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_NOT_SUPPORTED;
1140:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1141:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Server_Write_Event(server_id, client_id, DataLength,Data);
1142:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1143:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
1144:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1145:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
1146:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1147:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_socket_server_write(uint32_t DataLength,char * Data) 
1148:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1149:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1150:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Can only write if there is a client connected */
1151:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(!wifi_client_connected)
1152:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_NOT_READY;
1153:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1154:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(DataLength <= 0 && DataLength > WiFi_Counter_Variables.wifi_socket_write_limit)
1155:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_MODULE_ERROR;
1156:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1157:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   wait_for_command_mode(); 
1158:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
1159:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   __disable_irq();
1160:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1161:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Control_Variables.do_not_reset_push_WIFI_event = WIFI_TRUE;
1162:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Control_Variables.prevent_push_WIFI_event = WIFI_TRUE;
1163:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   __enable_irq();
1164:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1165:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.sock_read_ongoing || IO_status_flag.WIND64_count!= 0)//wait till any pending
1166:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
1167:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       __NOP(); //nothing to do
1168:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
1169:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1170:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*to make sure that by default the mode is not switched to command mode from data mode*/
1171:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Control_Variables.switch_by_default_to_command_mode = WIFI_FALSE;
1172:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1173:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*Switch to Data Mode first*/
1174:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(!IO_status_flag.data_mode)
1175:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
1176:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       WiFi_switch_to_data_mode();//switch by default
1177:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       while(!IO_status_flag.data_mode && wifi_client_connected)
1178:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         {
1179:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           //Wait till data_mode is active
1180:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           __NOP(); //nothing to do
1181:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         }
1182:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       // if client got disconnected
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 36


1183:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(!wifi_client_connected)
1184:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         {
1185:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           WiFi_Control_Variables.switch_by_default_to_command_mode = WIFI_TRUE;  /*back to default 
1186:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           __disable_irq();
1187:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           WiFi_Control_Variables.prevent_push_WIFI_event = WIFI_FALSE;
1188:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           WiFi_Control_Variables.do_not_reset_push_WIFI_event = WIFI_FALSE;
1189:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           __enable_irq();
1190:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           return WiFi_MODULE_ERROR;
1191:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         }
1192:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
1193:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1194:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*Write the data on the uart*/
1195:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(HAL_UART_Transmit(&UartWiFiHandle, (uint8_t *)Data, DataLength,1000)!= HAL_OK)
1196:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
1197:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       WiFi_UART_Error_Handler();
1198:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = WiFi_HAL_UART_ERROR;
1199:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
1200:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //HAL_Delay(100);//Wait for tx before switching back to command mode
1201:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1202:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*Switch back to Command Mode*/
1203:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(!IO_status_flag.command_mode)
1204:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
1205:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       WiFi_switch_to_command_mode();//switch by default
1206:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       while(!IO_status_flag.command_mode)
1207:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         {
1208:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           //Wait till command_mode is active
1209:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           __NOP(); //nothing to do
1210:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         }
1211:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
1212:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1213:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Control_Variables.switch_by_default_to_command_mode = WIFI_TRUE;  /*back to default behaviou
1214:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1215:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   __disable_irq();
1216:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Control_Variables.prevent_push_WIFI_event = WIFI_FALSE;
1217:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Control_Variables.do_not_reset_push_WIFI_event = WIFI_FALSE;
1218:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   __enable_irq();
1219:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1220:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
1221:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1222:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
1223:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1224:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1225:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  Server Socket Close
1226:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Queue the server socket close command
1227:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  count: the number of arguments 
1228:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of server socket request
1229:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1230:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04
1231:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t socket_server_close(int count,...)
1232:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1233:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   va_list v;
1234:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   va_start(v,count);
1235:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   int sid = va_arg(v,int);
1236:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   int cid;
1237:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   (count == 2) ? (cid = va_arg(v,int)): (cid = 9);
1238:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Server_Close_Event(sid,cid);
1239:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   va_end(v);
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 37


1240:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return WiFi_MODULE_SUCCESS;
1241:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1242:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
1243:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1244:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  Server Socket Close
1245:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Close a Server socket
1246:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  None
1247:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of server socket request
1248:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1249:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_socket_server_close() 
1250:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 800              		.loc 1 1250 0
 801              		.cfi_startproc
 802              		@ args = 0, pretend = 0, frame = 0
 803              		@ frame_needed = 0, uses_anonymous_args = 0
 804 0000 08B5     		push	{r3, lr}
 805              	.LCFI13:
 806              		.cfi_def_cfa_offset 8
 807              		.cfi_offset 3, -8
 808              		.cfi_offset 14, -4
1251:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Server_Close_Event(-1,-1);
 809              		.loc 1 1251 0
 810 0002 4FF0FF31 		mov	r1, #-1
 811 0006 0846     		mov	r0, r1
 812 0008 FFF7FEFF 		bl	Queue_Server_Close_Event
 813              	.LVL106:
1252:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return WiFi_MODULE_SUCCESS; 
1253:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 814              		.loc 1 1253 0
 815 000c 0020     		movs	r0, #0
 816 000e 08BD     		pop	{r3, pc}
 817              		.cfi_endproc
 818              	.LFE289:
 820              		.section	.text.wait_for_command_mode,"ax",%progbits
 821              		.align	1
 822              		.global	wait_for_command_mode
 823              		.syntax unified
 824              		.thumb
 825              		.thumb_func
 826              		.fpu fpv4-sp-d16
 828              	wait_for_command_mode:
 829              	.LFB290:
1254:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
1255:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1256:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef CONSOLE_UART_ENABLED
1257:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1258:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wait_for_command_mode
1259:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Waits till we are in command mode
1260:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  None
1261:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval None
1262:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1263:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** void wait_for_command_mode(void)
1264:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 830              		.loc 1 1264 0
 831              		.cfi_startproc
 832              		@ args = 0, pretend = 0, frame = 0
 833              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 38


 834              		@ link register save eliminated.
1265:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     while(!IO_status_flag.command_mode)
 835              		.loc 1 1265 0
 836 0000 00E0     		b	.L78
 837              	.L79:
1266:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
1267:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         //Make sure we are in command mode, ideally we should do this in every User API?
1268:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         __NOP(); //nothing to do
 838              		.loc 1 1268 0
 839              		.syntax unified
 840              	@ 1268 "Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c" 1
 841 0002 00BF     		nop
 842              	@ 0 "" 2
 843              		.thumb
 844              		.syntax unified
 845              	.L78:
1265:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     while(!IO_status_flag.command_mode)
 846              		.loc 1 1265 0
 847 0004 024B     		ldr	r3, .L80
 848 0006 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 849 0008 DB09     		lsrs	r3, r3, #7
 850 000a FAD0     		beq	.L79
1269:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
1270:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 851              		.loc 1 1270 0
 852 000c 7047     		bx	lr
 853              	.L81:
 854 000e 00BF     		.align	2
 855              	.L80:
 856 0010 00000000 		.word	IO_status_flag
 857              		.cfi_endproc
 858              	.LFE290:
 860              		.section	.text.Socket_Read,"ax",%progbits
 861              		.align	1
 862              		.global	Socket_Read
 863              		.syntax unified
 864              		.thumb
 865              		.thumb_func
 866              		.fpu fpv4-sp-d16
 868              	Socket_Read:
 869              	.LFB284:
 827:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.SOCKR=01,12<cr> */
 870              		.loc 1 827 0
 871              		.cfi_startproc
 872              		@ args = 0, pretend = 0, frame = 0
 873              		@ frame_needed = 0, uses_anonymous_args = 0
 874              	.LVL107:
 875 0000 70B5     		push	{r4, r5, r6, lr}
 876              	.LCFI14:
 877              		.cfi_def_cfa_offset 16
 878              		.cfi_offset 4, -16
 879              		.cfi_offset 5, -12
 880              		.cfi_offset 6, -8
 881              		.cfi_offset 14, -4
 882 0002 0646     		mov	r6, r0
 883              	.LVL108:
 831:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 39


 884              		.loc 1 831 0
 885 0004 FFF7FEFF 		bl	wait_for_command_mode
 886              	.LVL109:
 836:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.SockON_Data_Length = DataLength;
 887              		.loc 1 836 0
 888 0008 134D     		ldr	r5, .L86
 889 000a 2A78     		ldrb	r2, [r5]	@ zero_extendqisi2
 890 000c 134C     		ldr	r4, .L86+4
 891 000e 3346     		mov	r3, r6
 892 0010 C2F3C202 		ubfx	r2, r2, #3, #3
 893 0014 1249     		ldr	r1, .L86+8
 894 0016 2046     		mov	r0, r4
 895 0018 FFF7FEFF 		bl	sprintf
 896              	.LVL110:
 837:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 897              		.loc 1 837 0
 898 001c C5F8A460 		str	r6, [r5, #164]
 838:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #else
 899              		.loc 1 838 0
 900 0020 2046     		mov	r0, r4
 901 0022 FFF7FEFF 		bl	strlen
 902              	.LVL111:
 903 0026 80B2     		uxth	r0, r0
 904 0028 FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 905              	.LVL112:
 850:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
 906              		.loc 1 850 0
 907 002c 0246     		mov	r2, r0
 908 002e 88B9     		cbnz	r0, .L83
 852:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         WiFi_Control_Variables.stop_event_dequeue = WIFI_TRUE;
 909              		.loc 1 852 0
 910 0030 0C4B     		ldr	r3, .L86+12
 911 0032 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 912 0034 13F0080F 		tst	r3, #8
 913 0038 03D1     		bne	.L84
 853:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    
 914              		.loc 1 853 0
 915 003a 0A49     		ldr	r1, .L86+12
 916 003c 43F00803 		orr	r3, r3, #8
 917 0040 0B70     		strb	r3, [r1]
 918              	.L84:
 857:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         WiFi_Control_Variables.enable_receive_data_chunk = WIFI_TRUE;
 919              		.loc 1 857 0
 920 0042 0521     		movs	r1, #5
 921 0044 044B     		ldr	r3, .L86
 922 0046 A3F89A10 		strh	r1, [r3, #154]	@ movhi
 858:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         WiFi_Control_Variables.enable_sock_read = WIFI_TRUE;
 923              		.loc 1 858 0
 924 004a 0649     		ldr	r1, .L86+12
 925 004c 8B78     		ldrb	r3, [r1, #2]	@ zero_extendqisi2
 859:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #elif defined(SPWF04) && !defined(CONSOLE_UART_ENABLED)
 926              		.loc 1 859 0
 927 004e 43F02403 		orr	r3, r3, #36
 928 0052 8B70     		strb	r3, [r1, #2]
 929              	.L83:
 866:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 930              		.loc 1 866 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 40


 931 0054 1046     		mov	r0, r2
 932              	.LVL113:
 933 0056 70BD     		pop	{r4, r5, r6, pc}
 934              	.L87:
 935              		.align	2
 936              	.L86:
 937 0058 00000000 		.word	WiFi_Counter_Variables
 938 005c 00000000 		.word	WiFi_AT_Cmd_Buff
 939 0060 00000000 		.word	.LC7
 940 0064 00000000 		.word	WiFi_Control_Variables
 941              		.cfi_endproc
 942              	.LFE284:
 944              		.section	.text.Socket_Pending_Data,"ax",%progbits
 945              		.align	1
 946              		.global	Socket_Pending_Data
 947              		.syntax unified
 948              		.thumb
 949              		.thumb_func
 950              		.fpu fpv4-sp-d16
 952              	Socket_Pending_Data:
 953              	.LFB286:
 986:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.SOCKQ=01<cr> */
 954              		.loc 1 986 0
 955              		.cfi_startproc
 956              		@ args = 0, pretend = 0, frame = 0
 957              		@ frame_needed = 0, uses_anonymous_args = 0
 958 0000 10B5     		push	{r4, lr}
 959              	.LCFI15:
 960              		.cfi_def_cfa_offset 8
 961              		.cfi_offset 4, -8
 962              		.cfi_offset 14, -4
 988:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 963              		.loc 1 988 0
 964 0002 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 965              	.LVL114:
 991:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
 966              		.loc 1 991 0
 967 0006 FFF7FEFF 		bl	wait_for_command_mode
 968              	.LVL115:
 994:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 969              		.loc 1 994 0
 970 000a 0E4B     		ldr	r3, .L92
 971 000c 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 972 000e C2F3C202 		ubfx	r2, r2, #3, #3
 973 0012 0D4B     		ldr	r3, .L92+4
 974 0014 9B5C     		ldrb	r3, [r3, r2]	@ zero_extendqisi2
 975 0016 9BB1     		cbz	r3, .L88
 996:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         WiFi_Control_Variables.stop_event_dequeue = WIFI_TRUE;
 976              		.loc 1 996 0
 977 0018 0C4B     		ldr	r3, .L92+8
 978 001a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 979 001c 13F0080F 		tst	r3, #8
 980 0020 03D1     		bne	.L90
 997:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
 981              		.loc 1 997 0
 982 0022 0A49     		ldr	r1, .L92+8
 983 0024 43F00803 		orr	r3, r3, #8
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 41


 984 0028 0B70     		strb	r3, [r1]
 985              	.L90:
1000:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 986              		.loc 1 1000 0
 987 002a 094C     		ldr	r4, .L92+12
 988 002c 0949     		ldr	r1, .L92+16
 989 002e 2046     		mov	r0, r4
 990 0030 FFF7FEFF 		bl	sprintf
 991              	.LVL116:
1001:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #else
 992              		.loc 1 1001 0
 993 0034 2046     		mov	r0, r4
 994 0036 FFF7FEFF 		bl	strlen
 995              	.LVL117:
 996 003a 80B2     		uxth	r0, r0
 997 003c FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 998              	.LVL118:
 999              	.L88:
 1000 0040 10BD     		pop	{r4, pc}
 1001              	.L93:
 1002 0042 00BF     		.align	2
 1003              	.L92:
 1004 0044 00000000 		.word	WiFi_Counter_Variables
 1005 0048 00000000 		.word	open_sockets
 1006 004c 00000000 		.word	WiFi_Control_Variables
 1007 0050 00000000 		.word	WiFi_AT_Cmd_Buff
 1008 0054 00000000 		.word	.LC8
 1009              		.cfi_endproc
 1010              	.LFE286:
 1012              		.section	.text.wifi_socket_server_write,"ax",%progbits
 1013              		.align	1
 1014              		.global	wifi_socket_server_write
 1015              		.syntax unified
 1016              		.thumb
 1017              		.thumb_func
 1018              		.fpu fpv4-sp-d16
 1020              	wifi_socket_server_write:
 1021              	.LFB288:
1148:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
 1022              		.loc 1 1148 0
 1023              		.cfi_startproc
 1024              		@ args = 0, pretend = 0, frame = 0
 1025              		@ frame_needed = 0, uses_anonymous_args = 0
 1026              	.LVL119:
 1027 0000 38B5     		push	{r3, r4, r5, lr}
 1028              	.LCFI16:
 1029              		.cfi_def_cfa_offset 16
 1030              		.cfi_offset 3, -16
 1031              		.cfi_offset 4, -12
 1032              		.cfi_offset 5, -8
 1033              		.cfi_offset 14, -4
 1034              	.LVL120:
1151:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_NOT_READY;
 1035              		.loc 1 1151 0
 1036 0002 3A4B     		ldr	r3, .L114
 1037 0004 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1038 0006 13B9     		cbnz	r3, .L111
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 42


1152:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 1039              		.loc 1 1152 0
 1040 0008 0524     		movs	r4, #5
 1041              	.LVL121:
 1042              	.L95:
1221:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
 1043              		.loc 1 1221 0
 1044 000a 2046     		mov	r0, r4
 1045 000c 38BD     		pop	{r3, r4, r5, pc}
 1046              	.LVL122:
 1047              	.L111:
1154:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_MODULE_ERROR;
 1048              		.loc 1 1154 0
 1049 000e 30B9     		cbnz	r0, .L96
1154:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_MODULE_ERROR;
 1050              		.loc 1 1154 0 is_stmt 0 discriminator 1
 1051 0010 374B     		ldr	r3, .L114+4
 1052 0012 D3F8E430 		ldr	r3, [r3, #228]
 1053 0016 9842     		cmp	r0, r3
 1054 0018 01D9     		bls	.L96
1155:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 1055              		.loc 1 1155 0 is_stmt 1
 1056 001a 0224     		movs	r4, #2
 1057 001c F5E7     		b	.L95
 1058              	.L96:
 1059 001e 0D46     		mov	r5, r1
 1060 0020 0446     		mov	r4, r0
1157:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
 1061              		.loc 1 1157 0
 1062 0022 FFF7FEFF 		bl	wait_for_command_mode
 1063              	.LVL123:
 1064              	.LBB14:
 1065              	.LBB15:
 1066              		.file 2 "Drivers/CMSIS/Include/cmsis_gcc.h"
   1:Drivers/CMSIS/Include/cmsis_gcc.h **** /**************************************************************************//**
   2:Drivers/CMSIS/Include/cmsis_gcc.h ****  * @file     cmsis_gcc.h
   3:Drivers/CMSIS/Include/cmsis_gcc.h ****  * @brief    CMSIS compiler GCC header file
   4:Drivers/CMSIS/Include/cmsis_gcc.h ****  * @version  V5.0.4
   5:Drivers/CMSIS/Include/cmsis_gcc.h ****  * @date     09. April 2018
   6:Drivers/CMSIS/Include/cmsis_gcc.h ****  ******************************************************************************/
   7:Drivers/CMSIS/Include/cmsis_gcc.h **** /*
   8:Drivers/CMSIS/Include/cmsis_gcc.h ****  * Copyright (c) 2009-2018 Arm Limited. All rights reserved.
   9:Drivers/CMSIS/Include/cmsis_gcc.h ****  *
  10:Drivers/CMSIS/Include/cmsis_gcc.h ****  * SPDX-License-Identifier: Apache-2.0
  11:Drivers/CMSIS/Include/cmsis_gcc.h ****  *
  12:Drivers/CMSIS/Include/cmsis_gcc.h ****  * Licensed under the Apache License, Version 2.0 (the License); you may
  13:Drivers/CMSIS/Include/cmsis_gcc.h ****  * not use this file except in compliance with the License.
  14:Drivers/CMSIS/Include/cmsis_gcc.h ****  * You may obtain a copy of the License at
  15:Drivers/CMSIS/Include/cmsis_gcc.h ****  *
  16:Drivers/CMSIS/Include/cmsis_gcc.h ****  * www.apache.org/licenses/LICENSE-2.0
  17:Drivers/CMSIS/Include/cmsis_gcc.h ****  *
  18:Drivers/CMSIS/Include/cmsis_gcc.h ****  * Unless required by applicable law or agreed to in writing, software
  19:Drivers/CMSIS/Include/cmsis_gcc.h ****  * distributed under the License is distributed on an AS IS BASIS, WITHOUT
  20:Drivers/CMSIS/Include/cmsis_gcc.h ****  * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  21:Drivers/CMSIS/Include/cmsis_gcc.h ****  * See the License for the specific language governing permissions and
  22:Drivers/CMSIS/Include/cmsis_gcc.h ****  * limitations under the License.
  23:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 43


  24:Drivers/CMSIS/Include/cmsis_gcc.h **** 
  25:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef __CMSIS_GCC_H
  26:Drivers/CMSIS/Include/cmsis_gcc.h **** #define __CMSIS_GCC_H
  27:Drivers/CMSIS/Include/cmsis_gcc.h **** 
  28:Drivers/CMSIS/Include/cmsis_gcc.h **** /* ignore some GCC warnings */
  29:Drivers/CMSIS/Include/cmsis_gcc.h **** #pragma GCC diagnostic push
  30:Drivers/CMSIS/Include/cmsis_gcc.h **** #pragma GCC diagnostic ignored "-Wsign-conversion"
  31:Drivers/CMSIS/Include/cmsis_gcc.h **** #pragma GCC diagnostic ignored "-Wconversion"
  32:Drivers/CMSIS/Include/cmsis_gcc.h **** #pragma GCC diagnostic ignored "-Wunused-parameter"
  33:Drivers/CMSIS/Include/cmsis_gcc.h **** 
  34:Drivers/CMSIS/Include/cmsis_gcc.h **** /* Fallback for __has_builtin */
  35:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef __has_builtin
  36:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __has_builtin(x) (0)
  37:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  38:Drivers/CMSIS/Include/cmsis_gcc.h **** 
  39:Drivers/CMSIS/Include/cmsis_gcc.h **** /* CMSIS compiler specific defines */
  40:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __ASM
  41:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __ASM                                  __asm
  42:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  43:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __INLINE
  44:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __INLINE                               inline
  45:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  46:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __STATIC_INLINE
  47:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __STATIC_INLINE                        static inline
  48:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  49:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __STATIC_FORCEINLINE                 
  50:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __STATIC_FORCEINLINE                   __attribute__((always_inline)) static inline
  51:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif                                           
  52:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __NO_RETURN
  53:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __NO_RETURN                            __attribute__((__noreturn__))
  54:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  55:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __USED
  56:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __USED                                 __attribute__((used))
  57:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  58:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __WEAK
  59:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __WEAK                                 __attribute__((weak))
  60:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  61:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __PACKED
  62:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __PACKED                               __attribute__((packed, aligned(1)))
  63:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  64:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __PACKED_STRUCT
  65:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __PACKED_STRUCT                        struct __attribute__((packed, aligned(1)))
  66:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  67:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __PACKED_UNION
  68:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __PACKED_UNION                         union __attribute__((packed, aligned(1)))
  69:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  70:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __UNALIGNED_UINT32        /* deprecated */
  71:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic push
  72:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wpacked"
  73:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wattributes"
  74:Drivers/CMSIS/Include/cmsis_gcc.h ****   struct __attribute__((packed)) T_UINT32 { uint32_t v; };
  75:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic pop
  76:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __UNALIGNED_UINT32(x)                  (((struct T_UINT32 *)(x))->v)
  77:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  78:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __UNALIGNED_UINT16_WRITE
  79:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic push
  80:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wpacked"
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 44


  81:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wattributes"
  82:Drivers/CMSIS/Include/cmsis_gcc.h ****   __PACKED_STRUCT T_UINT16_WRITE { uint16_t v; };
  83:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic pop
  84:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __UNALIGNED_UINT16_WRITE(addr, val)    (void)((((struct T_UINT16_WRITE *)(void *)(addr))-
  85:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  86:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __UNALIGNED_UINT16_READ
  87:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic push
  88:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wpacked"
  89:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wattributes"
  90:Drivers/CMSIS/Include/cmsis_gcc.h ****   __PACKED_STRUCT T_UINT16_READ { uint16_t v; };
  91:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic pop
  92:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __UNALIGNED_UINT16_READ(addr)          (((const struct T_UINT16_READ *)(const void *)(add
  93:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  94:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __UNALIGNED_UINT32_WRITE
  95:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic push
  96:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wpacked"
  97:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wattributes"
  98:Drivers/CMSIS/Include/cmsis_gcc.h ****   __PACKED_STRUCT T_UINT32_WRITE { uint32_t v; };
  99:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic pop
 100:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __UNALIGNED_UINT32_WRITE(addr, val)    (void)((((struct T_UINT32_WRITE *)(void *)(addr))-
 101:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 102:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __UNALIGNED_UINT32_READ
 103:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic push
 104:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wpacked"
 105:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wattributes"
 106:Drivers/CMSIS/Include/cmsis_gcc.h ****   __PACKED_STRUCT T_UINT32_READ { uint32_t v; };
 107:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic pop
 108:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __UNALIGNED_UINT32_READ(addr)          (((const struct T_UINT32_READ *)(const void *)(add
 109:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 110:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __ALIGNED
 111:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __ALIGNED(x)                           __attribute__((aligned(x)))
 112:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 113:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __RESTRICT
 114:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __RESTRICT                             __restrict
 115:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 116:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 117:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 118:Drivers/CMSIS/Include/cmsis_gcc.h **** /* ###########################  Core Function Access  ########################### */
 119:Drivers/CMSIS/Include/cmsis_gcc.h **** /** \ingroup  CMSIS_Core_FunctionInterface
 120:Drivers/CMSIS/Include/cmsis_gcc.h ****     \defgroup CMSIS_Core_RegAccFunctions CMSIS Core Register Access Functions
 121:Drivers/CMSIS/Include/cmsis_gcc.h ****   @{
 122:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 123:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 124:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 125:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Enable IRQ Interrupts
 126:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Enables IRQ interrupts by clearing the I-bit in the CPSR.
 127:Drivers/CMSIS/Include/cmsis_gcc.h ****            Can only be executed in Privileged modes.
 128:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 129:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE void __enable_irq(void)
 130:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 131:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("cpsie i" : : : "memory");
 132:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 133:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 134:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 135:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 136:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Disable IRQ Interrupts
 137:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Disables IRQ interrupts by setting the I-bit in the CPSR.
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 45


 138:Drivers/CMSIS/Include/cmsis_gcc.h ****            Can only be executed in Privileged modes.
 139:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 140:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE void __disable_irq(void)
 141:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 142:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("cpsid i" : : : "memory");
 1067              		.loc 2 142 0
 1068              		.syntax unified
 1069              	@ 142 "Drivers/CMSIS/Include/cmsis_gcc.h" 1
 1070 0026 72B6     		cpsid i
 1071              	@ 0 "" 2
 1072              		.thumb
 1073              		.syntax unified
 1074              	.LBE15:
 1075              	.LBE14:
1161:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Control_Variables.prevent_push_WIFI_event = WIFI_TRUE;
 1076              		.loc 1 1161 0
 1077 0028 324A     		ldr	r2, .L114+8
 1078 002a 1379     		ldrb	r3, [r2, #4]	@ zero_extendqisi2
1162:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   __enable_irq();
 1079              		.loc 1 1162 0
 1080 002c 43F00503 		orr	r3, r3, #5
 1081 0030 1371     		strb	r3, [r2, #4]
 1082              	.LBB16:
 1083              	.LBB17:
 131:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 1084              		.loc 2 131 0
 1085              		.syntax unified
 1086              	@ 131 "Drivers/CMSIS/Include/cmsis_gcc.h" 1
 1087 0032 62B6     		cpsie i
 1088              	@ 0 "" 2
 1089              		.thumb
 1090              		.syntax unified
 1091 0034 00E0     		b	.L97
 1092              	.L98:
 1093              	.LBE17:
 1094              	.LBE16:
1167:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
 1095              		.loc 1 1167 0
 1096              		.syntax unified
 1097              	@ 1167 "Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c" 1
 1098 0036 00BF     		nop
 1099              	@ 0 "" 2
 1100              		.thumb
 1101              		.syntax unified
 1102              	.L97:
1165:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 1103              		.loc 1 1165 0
 1104 0038 2F4B     		ldr	r3, .L114+12
 1105 003a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1106 003c 13F0010F 		tst	r3, #1
 1107 0040 F9D1     		bne	.L98
1165:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 1108              		.loc 1 1165 0 is_stmt 0 discriminator 1
 1109 0042 2D4B     		ldr	r3, .L114+12
 1110 0044 5B68     		ldr	r3, [r3, #4]
 1111 0046 002B     		cmp	r3, #0
 1112 0048 F5D1     		bne	.L98
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 46


1171:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 1113              		.loc 1 1171 0 is_stmt 1
 1114 004a 2A4B     		ldr	r3, .L114+8
 1115 004c 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1116 004e 6FF30002 		bfc	r2, #0, #1
 1117 0052 1A70     		strb	r2, [r3]
1174:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 1118              		.loc 1 1174 0
 1119 0054 284B     		ldr	r3, .L114+12
 1120 0056 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1121 0058 13F0200F 		tst	r3, #32
 1122 005c 1ED1     		bne	.L99
1176:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       while(!IO_status_flag.data_mode && wifi_client_connected)
 1123              		.loc 1 1176 0
 1124 005e FFF7FEFF 		bl	WiFi_switch_to_data_mode
 1125              	.LVL124:
1177:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         {
 1126              		.loc 1 1177 0
 1127 0062 00E0     		b	.L100
 1128              	.L102:
1180:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         }
 1129              		.loc 1 1180 0
 1130              		.syntax unified
 1131              	@ 1180 "Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c" 1
 1132 0064 00BF     		nop
 1133              	@ 0 "" 2
 1134              		.thumb
 1135              		.syntax unified
 1136              	.L100:
1177:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         {
 1137              		.loc 1 1177 0
 1138 0066 244B     		ldr	r3, .L114+12
 1139 0068 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1140 006a 13F0200F 		tst	r3, #32
 1141 006e 03D1     		bne	.L101
1177:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         {
 1142              		.loc 1 1177 0 is_stmt 0 discriminator 1
 1143 0070 1E4B     		ldr	r3, .L114
 1144 0072 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1145 0074 002B     		cmp	r3, #0
 1146 0076 F5D1     		bne	.L102
 1147              	.L101:
1183:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         {
 1148              		.loc 1 1183 0 is_stmt 1
 1149 0078 1C4B     		ldr	r3, .L114
 1150 007a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1151 007c 73B9     		cbnz	r3, .L99
1185:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           __disable_irq();
 1152              		.loc 1 1185 0
 1153 007e 1D4B     		ldr	r3, .L114+8
 1154 0080 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1155 0082 42F00102 		orr	r2, r2, #1
 1156 0086 1A70     		strb	r2, [r3]
 1157              	.LBB18:
 1158              	.LBB19:
 1159              		.loc 2 142 0
 1160              		.syntax unified
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 47


 1161              	@ 142 "Drivers/CMSIS/Include/cmsis_gcc.h" 1
 1162 0088 72B6     		cpsid i
 1163              	@ 0 "" 2
 1164              		.thumb
 1165              		.syntax unified
 1166              	.LBE19:
 1167              	.LBE18:
1187:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           WiFi_Control_Variables.do_not_reset_push_WIFI_event = WIFI_FALSE;
 1168              		.loc 1 1187 0
 1169 008a 1A79     		ldrb	r2, [r3, #4]	@ zero_extendqisi2
1188:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           __enable_irq();
 1170              		.loc 1 1188 0
 1171 008c 02F0FE02 		and	r2, r2, #254
 1172 0090 6FF38202 		bfc	r2, #2, #1
 1173 0094 1A71     		strb	r2, [r3, #4]
 1174              	.LBB20:
 1175              	.LBB21:
 131:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 1176              		.loc 2 131 0
 1177              		.syntax unified
 1178              	@ 131 "Drivers/CMSIS/Include/cmsis_gcc.h" 1
 1179 0096 62B6     		cpsie i
 1180              	@ 0 "" 2
 1181              		.thumb
 1182              		.syntax unified
 1183              	.LBE21:
 1184              	.LBE20:
1190:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         }
 1185              		.loc 1 1190 0
 1186 0098 0224     		movs	r4, #2
 1187              	.LVL125:
 1188 009a B6E7     		b	.L95
 1189              	.LVL126:
 1190              	.L99:
1195:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 1191              		.loc 1 1195 0
 1192 009c 4FF47A73 		mov	r3, #1000
 1193 00a0 A2B2     		uxth	r2, r4
 1194 00a2 2946     		mov	r1, r5
 1195 00a4 1548     		ldr	r0, .L114+16
 1196 00a6 FFF7FEFF 		bl	HAL_UART_Transmit
 1197              	.LVL127:
 1198 00aa 90B9     		cbnz	r0, .L112
1149:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Can only write if there is a client connected */
 1199              		.loc 1 1149 0
 1200 00ac 0024     		movs	r4, #0
 1201              	.LVL128:
 1202              	.L103:
1203:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 1203              		.loc 1 1203 0
 1204 00ae 124B     		ldr	r3, .L114+12
 1205 00b0 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1206 00b2 DB09     		lsrs	r3, r3, #7
 1207 00b4 11D0     		beq	.L113
 1208              	.L104:
1213:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 1209              		.loc 1 1213 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 48


 1210 00b6 0F4B     		ldr	r3, .L114+8
 1211 00b8 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1212 00ba 42F00102 		orr	r2, r2, #1
 1213 00be 1A70     		strb	r2, [r3]
 1214              	.LBB22:
 1215              	.LBB23:
 1216              		.loc 2 142 0
 1217              		.syntax unified
 1218              	@ 142 "Drivers/CMSIS/Include/cmsis_gcc.h" 1
 1219 00c0 72B6     		cpsid i
 1220              	@ 0 "" 2
 1221              		.thumb
 1222              		.syntax unified
 1223              	.LBE23:
 1224              	.LBE22:
1216:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Control_Variables.do_not_reset_push_WIFI_event = WIFI_FALSE;
 1225              		.loc 1 1216 0
 1226 00c2 1A79     		ldrb	r2, [r3, #4]	@ zero_extendqisi2
1217:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   __enable_irq();
 1227              		.loc 1 1217 0
 1228 00c4 02F0FE02 		and	r2, r2, #254
 1229 00c8 6FF38202 		bfc	r2, #2, #1
 1230 00cc 1A71     		strb	r2, [r3, #4]
 1231              	.LBB24:
 1232              	.LBB25:
 131:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 1233              		.loc 2 131 0
 1234              		.syntax unified
 1235              	@ 131 "Drivers/CMSIS/Include/cmsis_gcc.h" 1
 1236 00ce 62B6     		cpsie i
 1237              	@ 0 "" 2
 1238              		.thumb
 1239              		.syntax unified
 1240              	.LBE25:
 1241              	.LBE24:
1220:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 1242              		.loc 1 1220 0
 1243 00d0 9BE7     		b	.L95
 1244              	.LVL129:
 1245              	.L112:
1197:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = WiFi_HAL_UART_ERROR;
 1246              		.loc 1 1197 0
 1247 00d2 FFF7FEFF 		bl	WiFi_UART_Error_Handler
 1248              	.LVL130:
1198:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
 1249              		.loc 1 1198 0
 1250 00d6 0F24     		movs	r4, #15
 1251              	.LVL131:
 1252 00d8 E9E7     		b	.L103
 1253              	.LVL132:
 1254              	.L113:
1205:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       while(!IO_status_flag.command_mode)
 1255              		.loc 1 1205 0
 1256 00da FFF7FEFF 		bl	WiFi_switch_to_command_mode
 1257              	.LVL133:
1206:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         {
 1258              		.loc 1 1206 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 49


 1259 00de 00E0     		b	.L105
 1260              	.L106:
1209:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         }
 1261              		.loc 1 1209 0
 1262              		.syntax unified
 1263              	@ 1209 "Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c" 1
 1264 00e0 00BF     		nop
 1265              	@ 0 "" 2
 1266              		.thumb
 1267              		.syntax unified
 1268              	.L105:
1206:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         {
 1269              		.loc 1 1206 0
 1270 00e2 054B     		ldr	r3, .L114+12
 1271 00e4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1272 00e6 DB09     		lsrs	r3, r3, #7
 1273 00e8 FAD0     		beq	.L106
 1274 00ea E4E7     		b	.L104
 1275              	.L115:
 1276              		.align	2
 1277              	.L114:
 1278 00ec 00000000 		.word	wifi_client_connected
 1279 00f0 00000000 		.word	WiFi_Counter_Variables
 1280 00f4 00000000 		.word	WiFi_Control_Variables
 1281 00f8 00000000 		.word	IO_status_flag
 1282 00fc 00000000 		.word	UartWiFiHandle
 1283              		.cfi_endproc
 1284              	.LFE288:
 1286              		.section	.text.wifi_file_delete,"ax",%progbits
 1287              		.align	1
 1288              		.global	wifi_file_delete
 1289              		.syntax unified
 1290              		.thumb
 1291              		.thumb_func
 1292              		.fpu fpv4-sp-d16
 1294              	wifi_file_delete:
 1295              	.LFB291:
1271:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
1272:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1273:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04
1274:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1275:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_file_rename
1276:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Rename an existing file
1277:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  FileName : Filename to be renamed
1278:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Mod_FileName : New File Name
1279:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of AT cmd request
1280:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1281:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_file_rename(char *FileName, char *Mod_FileName)
1282:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1283:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1284:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1285:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(FileName ==NULL || Mod_FileName == NULL)
1286:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_MODULE_ERROR;
1287:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1288:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_File_Event(FileName,Mod_FileName,-1,-1);
1289:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1290:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 50


1291:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1292:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
1293:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1294:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04
1295:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifndef WIFI_USE_VCOM  
1296:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1297:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_unmount_user_memory
1298:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Unmount/erase user memory volumes
1299:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  Volume : Indicates the memory volume. Default: 0.  <1:User Flash 0:SD Card>
1300:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Erase  : Default: 0. when 1, the specified volume is erased.
1301:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of AT cmd request
1302:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1303:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_unmount_user_memory(int8_t volume, int8_t erase)
1304:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1305:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1306:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1307:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   volume = (volume==-1)?0:volume;
1308:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   erase = (erase==-1)?0:erase;
1309:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_File_Event(NULL,NULL,volume,erase);
1310:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1311:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
1312:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1313:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
1314:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
1315:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1316:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1317:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_file_delete
1318:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Delete a file
1319:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  FileName : File Name to be deleted
1320:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of delete file request
1321:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1322:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_file_delete(char *FileName)
1323:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 1296              		.loc 1 1323 0
 1297              		.cfi_startproc
 1298              		@ args = 0, pretend = 0, frame = 0
 1299              		@ frame_needed = 0, uses_anonymous_args = 0
 1300              	.LVL134:
1324:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(FileName==NULL)
 1301              		.loc 1 1324 0
 1302 0000 48B1     		cbz	r0, .L118
1323:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(FileName==NULL)
 1303              		.loc 1 1323 0
 1304 0002 08B5     		push	{r3, lr}
 1305              	.LCFI17:
 1306              		.cfi_def_cfa_offset 8
 1307              		.cfi_offset 3, -8
 1308              		.cfi_offset 14, -4
 1309              	.LVL135:
1325:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_MODULE_ERROR;
1326:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1327:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;  
1328:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_File_Event(FileName,NULL,-1,-1);
 1310              		.loc 1 1328 0
 1311 0004 4FF0FF33 		mov	r3, #-1
 1312 0008 1A46     		mov	r2, r3
 1313 000a 0021     		movs	r1, #0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 51


 1314 000c FFF7FEFF 		bl	Queue_File_Event
 1315              	.LVL136:
1329:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1330:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
 1316              		.loc 1 1330 0
 1317 0010 FFF7FEFF 		bl	USART_Receive_AT_Resp
 1318              	.LVL137:
1331:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1332:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
 1319              		.loc 1 1332 0
 1320 0014 08BD     		pop	{r3, pc}
 1321              	.LVL138:
 1322              	.L118:
 1323              	.LCFI18:
 1324              		.cfi_def_cfa_offset 0
 1325              		.cfi_restore 3
 1326              		.cfi_restore 14
1325:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 1327              		.loc 1 1325 0
 1328 0016 0220     		movs	r0, #2
 1329              	.LVL139:
 1330 0018 7047     		bx	lr
 1331              		.cfi_endproc
 1332              	.LFE291:
 1334              		.section	.text.wifi_file_list,"ax",%progbits
 1335              		.align	1
 1336              		.global	wifi_file_list
 1337              		.syntax unified
 1338              		.thumb
 1339              		.thumb_func
 1340              		.fpu fpv4-sp-d16
 1342              	wifi_file_list:
 1343              	.LFB292:
1333:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1334:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1335:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1336:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1337:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_file_list
1338:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         List existing filename
1339:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  None
1340:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of AT cmd request
1341:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1342:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1343:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_file_list()
1344:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 1344              		.loc 1 1344 0
 1345              		.cfi_startproc
 1346              		@ args = 0, pretend = 0, frame = 0
 1347              		@ frame_needed = 0, uses_anonymous_args = 0
 1348 0000 00B5     		push	{lr}
 1349              	.LCFI19:
 1350              		.cfi_def_cfa_offset 4
 1351              		.cfi_offset 14, -4
 1352 0002 83B0     		sub	sp, sp, #12
 1353              	.LCFI20:
 1354              		.cfi_def_cfa_offset 16
 1355              	.LVL140:
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 52


1345:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;  
1346:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Wifi_File_Event(NULL,NULL,0,-1,-1);
 1356              		.loc 1 1346 0
 1357 0004 4FF0FF33 		mov	r3, #-1
 1358 0008 0093     		str	r3, [sp]
 1359 000a 0022     		movs	r2, #0
 1360 000c 1146     		mov	r1, r2
 1361 000e 1046     		mov	r0, r2
 1362 0010 FFF7FEFF 		bl	Queue_Wifi_File_Event
 1363              	.LVL141:
1347:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
 1364              		.loc 1 1347 0
 1365 0014 FFF7FEFF 		bl	USART_Receive_AT_Resp
 1366              	.LVL142:
1348:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
1349:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 1367              		.loc 1 1349 0
 1368 0018 03B0     		add	sp, sp, #12
 1369              	.LCFI21:
 1370              		.cfi_def_cfa_offset 4
 1371              		@ sp needed
 1372 001a 5DF804FB 		ldr	pc, [sp], #4
 1373              		.cfi_endproc
 1374              	.LFE292:
 1376              		.section	.text.wifi_file_print_content,"ax",%progbits
 1377              		.align	1
 1378              		.global	wifi_file_print_content
 1379              		.syntax unified
 1380              		.thumb
 1381              		.thumb_func
 1382              		.fpu fpv4-sp-d16
 1384              	wifi_file_print_content:
 1385              	.LFB293:
1350:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1351:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1352:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_file_print_content
1353:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Print the contents of an existing file
1354:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  FileName : Name of the File whose content is to be printed.
1355:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of AT cmd request
1356:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1357:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_file_print_content(uint8_t * FileName)
1358:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 1386              		.loc 1 1358 0
 1387              		.cfi_startproc
 1388              		@ args = 0, pretend = 0, frame = 0
 1389              		@ frame_needed = 0, uses_anonymous_args = 0
 1390              	.LVL143:
1359:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(FileName==NULL)
 1391              		.loc 1 1359 0
 1392 0000 70B1     		cbz	r0, .L127
1358:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(FileName==NULL)
 1393              		.loc 1 1358 0
 1394 0002 00B5     		push	{lr}
 1395              	.LCFI22:
 1396              		.cfi_def_cfa_offset 4
 1397              		.cfi_offset 14, -4
 1398 0004 83B0     		sub	sp, sp, #12
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 53


 1399              	.LCFI23:
 1400              		.cfi_def_cfa_offset 16
 1401 0006 0146     		mov	r1, r0
 1402              	.LVL144:
1360:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       return WiFi_MODULE_ERROR;
1361:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1362:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;  
1363:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Wifi_File_Event(NULL,FileName,0,-1,-1);
 1403              		.loc 1 1363 0
 1404 0008 4FF0FF33 		mov	r3, #-1
 1405 000c 0093     		str	r3, [sp]
 1406 000e 0022     		movs	r2, #0
 1407 0010 1046     		mov	r0, r2
 1408              	.LVL145:
 1409 0012 FFF7FEFF 		bl	Queue_Wifi_File_Event
 1410              	.LVL146:
1364:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
 1411              		.loc 1 1364 0
 1412 0016 FFF7FEFF 		bl	USART_Receive_AT_Resp
 1413              	.LVL147:
1365:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
1366:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 1414              		.loc 1 1366 0
 1415 001a 03B0     		add	sp, sp, #12
 1416              	.LCFI24:
 1417              		.cfi_def_cfa_offset 4
 1418              		@ sp needed
 1419 001c 5DF804FB 		ldr	pc, [sp], #4
 1420              	.LVL148:
 1421              	.L127:
 1422              	.LCFI25:
 1423              		.cfi_def_cfa_offset 0
 1424              		.cfi_restore 14
1360:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 1425              		.loc 1 1360 0
 1426 0020 0220     		movs	r0, #2
 1427              	.LVL149:
 1428 0022 7047     		bx	lr
 1429              		.cfi_endproc
 1430              	.LFE293:
 1432              		.section	.text.wifi_file_create,"ax",%progbits
 1433              		.align	1
 1434              		.global	wifi_file_create
 1435              		.syntax unified
 1436              		.thumb
 1437              		.thumb_func
 1438              		.fpu fpv4-sp-d16
 1440              	wifi_file_create:
 1441              	.LFB294:
1367:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1368:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(SPWF01) && defined(CONSOLE_UART_ENABLED)
1369:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1370:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_file_create
1371:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Create file for HTTP server
1372:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  FileName : Name of the file to be created
1373:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         length   : length of file
1374:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         UserFileBuff : pointer to the buffer
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 54


1375:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of AT cmd request
1376:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1377:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_file_create(char *FileName, uint16_t length, char *UserFileBuff)
1378:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 1442              		.loc 1 1378 0
 1443              		.cfi_startproc
 1444              		@ args = 0, pretend = 0, frame = 0
 1445              		@ frame_needed = 0, uses_anonymous_args = 0
 1446              	.LVL150:
 1447 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 1448              	.LCFI26:
 1449              		.cfi_def_cfa_offset 24
 1450              		.cfi_offset 3, -24
 1451              		.cfi_offset 4, -20
 1452              		.cfi_offset 5, -16
 1453              		.cfi_offset 6, -12
 1454              		.cfi_offset 7, -8
 1455              		.cfi_offset 14, -4
 1456              	.LVL151:
1379:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1380:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  
1381:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(length >1024)
 1457              		.loc 1 1381 0
 1458 0002 B1F5806F 		cmp	r1, #1024
 1459 0006 02D9     		bls	.L137
1382:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_AT_FILE_LENGTH_ERROR;
 1460              		.loc 1 1382 0
 1461 0008 0E23     		movs	r3, #14
 1462              	.LVL152:
 1463              	.L133:
1383:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  
1384:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();
1385:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  
1386:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.FSC=/index.html  */
1387:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff, AT_CREATE_FILE, FileName, length);
1388:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  
1389:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
1390:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
1391:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
1392:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
1393:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     int len = strlen(UserFileBuff);
1394:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  
1395:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(len >= 1024)
1396:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****        return WiFi_AT_FILE_LENGTH_ERROR;
1397:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  
1398:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /* AT+S.FSA=/index.html  */
1399:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,AT_APPEND_FILE,FileName,len);
1400:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  
1401:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
1402:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status == WiFi_MODULE_SUCCESS)
1403:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
1404:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       memset(WiFi_AT_Cmd_Buff, 0x00, sizeof WiFi_AT_Cmd_Buff);
1405:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       memcpy((char*)WiFi_AT_Cmd_Buff, (char*) UserFileBuff,len);
1406:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       WiFi_AT_Cmd_Buff[len+1]='\r';
1407:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
1408:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status == WiFi_MODULE_SUCCESS)
1409:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 55


1410:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = USART_Receive_AT_Resp( );
1411:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
1412:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
1413:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
1414:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
1415:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 1464              		.loc 1 1415 0
 1465 000a 1846     		mov	r0, r3
 1466 000c F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1467              	.LVL153:
 1468              	.L137:
 1469 000e 1646     		mov	r6, r2
 1470 0010 0C46     		mov	r4, r1
 1471 0012 0546     		mov	r5, r0
1384:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  
 1472              		.loc 1 1384 0
 1473 0014 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 1474              	.LVL154:
1387:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  
 1475              		.loc 1 1387 0
 1476 0018 224F     		ldr	r7, .L139
 1477 001a 2346     		mov	r3, r4
 1478 001c 2A46     		mov	r2, r5
 1479 001e 2249     		ldr	r1, .L139+4
 1480 0020 3846     		mov	r0, r7
 1481 0022 FFF7FEFF 		bl	sprintf
 1482              	.LVL155:
1389:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
 1483              		.loc 1 1389 0
 1484 0026 3846     		mov	r0, r7
 1485 0028 FFF7FEFF 		bl	strlen
 1486              	.LVL156:
 1487 002c 80B2     		uxth	r0, r0
 1488 002e FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 1489              	.LVL157:
1390:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
 1490              		.loc 1 1390 0
 1491 0032 0346     		mov	r3, r0
 1492 0034 0028     		cmp	r0, #0
 1493 0036 E8D1     		bne	.L133
 1494              	.LBB26:
1392:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     int len = strlen(UserFileBuff);
 1495              		.loc 1 1392 0
 1496 0038 FFF7FEFF 		bl	USART_Receive_AT_Resp
 1497              	.LVL158:
1393:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  
 1498              		.loc 1 1393 0
 1499 003c 3046     		mov	r0, r6
 1500 003e FFF7FEFF 		bl	strlen
 1501              	.LVL159:
 1502 0042 0446     		mov	r4, r0
 1503              	.LVL160:
1395:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****        return WiFi_AT_FILE_LENGTH_ERROR;
 1504              		.loc 1 1395 0
 1505 0044 B0F5806F 		cmp	r0, #1024
 1506 0048 01DB     		blt	.L138
1396:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 56


 1507              		.loc 1 1396 0
 1508 004a 0E23     		movs	r3, #14
 1509 004c DDE7     		b	.L133
 1510              	.L138:
1399:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  
 1511              		.loc 1 1399 0
 1512 004e 0346     		mov	r3, r0
 1513 0050 2A46     		mov	r2, r5
 1514 0052 1649     		ldr	r1, .L139+8
 1515 0054 3846     		mov	r0, r7
 1516              	.LVL161:
 1517 0056 FFF7FEFF 		bl	sprintf
 1518              	.LVL162:
1401:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status == WiFi_MODULE_SUCCESS)
 1519              		.loc 1 1401 0
 1520 005a 3846     		mov	r0, r7
 1521 005c FFF7FEFF 		bl	strlen
 1522              	.LVL163:
 1523 0060 80B2     		uxth	r0, r0
 1524 0062 FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 1525              	.LVL164:
1402:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 1526              		.loc 1 1402 0
 1527 0066 0346     		mov	r3, r0
 1528 0068 0028     		cmp	r0, #0
 1529 006a CED1     		bne	.L133
1404:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       memcpy((char*)WiFi_AT_Cmd_Buff, (char*) UserFileBuff,len);
 1530              		.loc 1 1404 0
 1531 006c 4FF40062 		mov	r2, #2048
 1532 0070 0021     		movs	r1, #0
 1533 0072 3846     		mov	r0, r7
 1534              	.LVL165:
 1535 0074 FFF7FEFF 		bl	memset
 1536              	.LVL166:
1405:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       WiFi_AT_Cmd_Buff[len+1]='\r';
 1537              		.loc 1 1405 0
 1538 0078 2246     		mov	r2, r4
 1539 007a 3146     		mov	r1, r6
 1540 007c 3846     		mov	r0, r7
 1541 007e FFF7FEFF 		bl	memcpy
 1542              	.LVL167:
1406:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 1543              		.loc 1 1406 0
 1544 0082 0134     		adds	r4, r4, #1
 1545              	.LVL168:
 1546 0084 0D23     		movs	r3, #13
 1547 0086 3B55     		strb	r3, [r7, r4]
1407:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status == WiFi_MODULE_SUCCESS)
 1548              		.loc 1 1407 0
 1549 0088 3846     		mov	r0, r7
 1550 008a FFF7FEFF 		bl	strlen
 1551              	.LVL169:
 1552 008e 80B2     		uxth	r0, r0
 1553 0090 FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 1554              	.LVL170:
1408:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 1555              		.loc 1 1408 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 57


 1556 0094 0346     		mov	r3, r0
 1557 0096 0028     		cmp	r0, #0
 1558 0098 B7D1     		bne	.L133
1410:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 1559              		.loc 1 1410 0
 1560 009a FFF7FEFF 		bl	USART_Receive_AT_Resp
 1561              	.LVL171:
 1562 009e 0346     		mov	r3, r0
 1563              	.LVL172:
 1564 00a0 B3E7     		b	.L133
 1565              	.L140:
 1566 00a2 00BF     		.align	2
 1567              	.L139:
 1568 00a4 00000000 		.word	WiFi_AT_Cmd_Buff
 1569 00a8 00000000 		.word	.LC9
 1570 00ac 14000000 		.word	.LC10
 1571              	.LBE26:
 1572              		.cfi_endproc
 1573              	.LFE294:
 1575              		.section	.text.wifi_fill_input_buffer,"ax",%progbits
 1576              		.align	1
 1577              		.global	wifi_fill_input_buffer
 1578              		.syntax unified
 1579              		.thumb
 1580              		.thumb_func
 1581              		.fpu fpv4-sp-d16
 1583              	wifi_fill_input_buffer:
 1584              	.LFB295:
1416:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
1417:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1418:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_file_create
1419:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Create file for HTTP server
1420:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  FileName : Name of the file to be created
1421:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         length   : length of file
1422:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         UserFileBuff : pointer to the buffer
1423:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of AT cmd request
1424:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1425:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1426:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_file_create(char *FileName, uint16_t length, char *UserFileBuff)
1427:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1428:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1429:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();
1430:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  
1431:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(FileName==NULL || UserFileBuff==NULL)
1432:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_MODULE_ERROR;
1433:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1434:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(length > 1024)
1435:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_AT_FILE_LENGTH_ERROR;
1436:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1437:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Wifi_File_Create_Event((uint8_t *)FileName,length,UserFileBuff);
1438:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1439:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
1440:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1441:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
1442:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1443:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(SPWF04)
1444:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 58


1445:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_mqtt_connect
1446:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Open a connection with MQTT broker
1447:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  Hostname hostname to connect to
1448:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         portnumber portnumber of the Host to connect to
1449:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of mqtt connect request
1450:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1451:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_mqtt_connect(uint8_t * hostname, uint32_t port_num)
1452:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1453:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1454:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1455:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   mqtt_type = CONNECT;
1456:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Mqtt_Connect_Event(hostname, port_num);
1457:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1458:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1459:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
1460:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1461:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1462:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1463:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_mqtt_subscribe
1464:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Subscribe topic to an mqtt broker
1465:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  topic: topic to subscribe to
1466:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of mqtt subscribe request
1467:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1468:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_mqtt_subscribe(uint8_t *topic)
1469:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1470:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1471:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1472:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   mqtt_type = SUBSCRIBE;
1473:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Mqtt_Event(topic);
1474:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1475:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1476:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
1477:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1478:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1479:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1480:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_mqtt_publish
1481:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Publish message to an mqtt broker
1482:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  topic: topic to publish to
1483:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  DataLength: MQTT message length
1484:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  Data: data to publish 
1485:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of mqtt publish request
1486:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1487:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_mqtt_publish(uint8_t *topic, uint32_t DataLength, char *Data)
1488:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1489:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1490:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    
1491:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   mqtt_type = PUBLISH;
1492:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Mqtt_Publish_Event(topic, DataLength, Data);
1493:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1494:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1495:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
1496:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1497:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1498:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1499:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_mqtt_disconnect
1500:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         disconnect from an mqtt broker
1501:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of mqtt disconnect request
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 59


1502:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1503:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_mqtt_disconnect(void)
1504:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1505:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1506:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1507:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   mqtt_type = DISCONNECT;
1508:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Mqtt_Event(NULL);
1509:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1510:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1511:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
1512:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1513:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1514:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1515:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_mqtt_unsubscribe
1516:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Unsubscribe topic from an mqtt broker
1517:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  topic: topic to unsubscribe from 
1518:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of mqtt unsubscribe request
1519:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1520:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_mqtt_unsubscribe(uint8_t *topic)
1521:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1522:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1523:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1524:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   mqtt_type = UNSUBSCRIBE;
1525:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Mqtt_Event(topic);
1526:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1527:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1528:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
1529:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1530:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1531:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1532:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1533:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_list_open_client_socket
1534:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         list opened client sockets
1535:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  None
1536:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status
1537:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1538:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_list_open_client_socket(void)
1539:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1540:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1541:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Client_List_Event(NET_SOCKET);
1542:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1543:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
1544:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1545:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1546:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1547:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_list_open_web_client_socket
1548:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         list opened web client sockets
1549:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  None
1550:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status
1551:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1552:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_list_open_web_client_socket(void)
1553:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1554:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1555:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Client_List_Event(WEB_SOCKET);
1556:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1557:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
1558:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 60


1559:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1560:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1561:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_list_bound_client_socket
1562:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         list all bounded client sockets
1563:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  None
1564:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status
1565:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1566:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_list_bound_client_socket(void)
1567:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1568:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1569:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Server_List_Event();
1570:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1571:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
1572:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1573:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1574:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1575:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1576:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_send_mail
1577:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         SMTP protocol to send a secure mail
1578:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param hostname: DMA resolvable name or IP address of the remote host
1579:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param port:     Server port.
1580:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param From:     Email address on the SMTP server
1581:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param To:       Destinator Email. Multiple email are seperated by semicolon  
1582:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param subject:  Email subject. String message.
1583:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param length:   length of body message
1584:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param Data:     Body of the Mail
1585:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of send mail
1586:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1587:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_send_mail(uint8_t *hostname,
1588:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****                              uint32_t port_num,
1589:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****                              uint8_t *from, 
1590:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****                              uint8_t *to, 
1591:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****                              uint8_t *subject, 
1592:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****                              uint32_t length, 
1593:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****                              char *Data)
1594:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1595:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(length >= 1021 || length <= 0)
1596:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_NOT_SUPPORTED;
1597:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1598:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1599:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Wifi_Send_Mail_Event(hostname,port_num,from,to,subject,length,Data);
1600:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1601:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
1602:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1603:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1604:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1605:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_tftp_get
1606:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Issue an TFTP GET of the given filename to the specified host
1607:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  hostname: Target host. DNS resolvable name or IP address.
1608:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  filename: Document path/name
1609:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  port_number: port number to connect to
1610:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of AT cmd response
1611:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1612:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_tftp_get(uint8_t * hostname, uint32_t port_number, uint8_t * filename)
1613:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1614:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(hostname == NULL || filename == NULL)
1615:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_MODULE_ERROR;
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 61


1616:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1617:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1618:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1619:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.sock_read_ongoing || IO_status_flag.WIND64_count!= 0) //wait till any pendin
1620:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
1621:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       __NOP(); //nothing to do
1622:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
1623:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1624:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   // AT+S.TFTPGET=host.example.com,port_number,filename,NULL<cr>
1625:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //Queue the ftp-get command
1626:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Tftp_Event(hostname, port_number, filename, 0);
1627:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1628:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //Make the user wait anyway
1629:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1630:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
1631:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1632:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1633:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1634:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_tftp_put
1635:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Issue an TFTP PUT of the given filename from the specified host
1636:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  hostname: Target host. DNS resolvable name or IP address.
1637:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  filename: Document path/name
1638:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  port_number: port number to connect to
1639:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of AT cmd response
1640:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1641:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_tftp_put(uint8_t * hostname, uint32_t port_number, uint8_t * filename)
1642:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1643:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(hostname == NULL || filename == NULL)
1644:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_MODULE_ERROR;
1645:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1646:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1647:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1648:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.sock_read_ongoing || IO_status_flag.WIND64_count!= 0) //wait till any pendin
1649:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
1650:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       __NOP(); //nothing to do
1651:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
1652:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1653:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   // AT+S.TFTPPUT=host.example.com,port_number, filename<cr>
1654:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //Queue the ftp-get command
1655:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Tftp_Event(hostname, port_number, filename, 1);
1656:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1657:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //Make the user wait anyway
1658:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1659:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1660:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
1661:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1662:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1663:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1664:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_fill_input_buffer
1665:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Fill buffer for raw text input ssi.
1666:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  DataLength: Length of the data. (maximum internal buffer size is 128 bytes)
1667:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  Data:       Data to save in buffer.
1668:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         NOTE:       {data} used to fill the buffer must be properly set. The first byte is used a
1669:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *                     splitter; so use this special character to fill the buffer with multiple toke
1670:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *                     be directly referred remotely by SSI indexes contained inside the HTML page. 
1671:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *                     example: |hello|world| will create 2 tokens: "hello accessed by <!--|06|In
1672:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *                     world accessed by <!--|06|Input|1|-->. 
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 62


1673:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of AT cmd response
1674:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1675:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1676:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_fill_input_buffer(uint32_t DataLength, char * Data)
1677:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
1678:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.SOCKW=00,11<cr> */
1679:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1680:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1681:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(DataLength >= 128 || DataLength<=0)
1682:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_NOT_SUPPORTED;
1683:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1684:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();
1685:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1686:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.INPUTSSI=<length><cr>{data} */
1687:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* should not queue, we have a minimal window of 30sec to write the data*/
1688:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #if defined(CONSOLE_UART_ENABLED)
1689:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,AT_FILL_INTERNAL_BUFFER,DataLength);
1690:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
1691:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status == WiFi_MODULE_SUCCESS)
1692:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
1693:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       Reset_AT_CMD_Buffer();
1694:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       memcpy((char*)WiFi_AT_Cmd_Buff, (char*)Data, DataLength);
1695:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Transmit_AT_Cmd(DataLength);
1696:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
1697:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #else
1698:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.INPUTSSI=%d %s", DataLength, "DATA");
1699:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.curr_DataLength = DataLength;
1700:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Counter_Variables.curr_data = Data;
1701:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_POLL);
1702:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = WiFi_MODULE_SUCCESS;//@TBD: Check return error code
1703:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
1704:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
1705:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
1706:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.send_data = WIFI_TRUE;
1707:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Control_Variables.fill_buffer_command_ongoing = WIFI_TRUE;
1708:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
1709:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
1710:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   HAL_NVIC_EnableIRQ(TIMx_IRQn);
1711:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
1712:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
1713:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1714:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
1715:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1716:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(SPWF01)
1717:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /* @brief  wifi_fill_input_buffer
1718:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Fill buffer for raw text input ssi.
1719:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  DataLength: Length of the data. (maximum internal buffer size is 128 bytes)
1720:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  Data:       Data to save in buffer.
1721:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of AT cmd response
1722:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1723:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1724:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_fill_input_buffer(uint32_t DataLength, char * Data)
1725:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 1585              		.loc 1 1725 0
 1586              		.cfi_startproc
 1587              		@ args = 0, pretend = 0, frame = 0
 1588              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 63


 1589              	.LVL173:
 1590 0000 38B5     		push	{r3, r4, r5, lr}
 1591              	.LCFI27:
 1592              		.cfi_def_cfa_offset 16
 1593              		.cfi_offset 3, -16
 1594              		.cfi_offset 4, -12
 1595              		.cfi_offset 5, -8
 1596              		.cfi_offset 14, -4
1726:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(DataLength >1024 || DataLength <=0)
 1597              		.loc 1 1726 0
 1598 0002 431E     		subs	r3, r0, #1
 1599 0004 B3F5806F 		cmp	r3, #1024
 1600 0008 02D3     		bcc	.L145
1727:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_NOT_SUPPORTED;
 1601              		.loc 1 1727 0
 1602 000a 0424     		movs	r4, #4
 1603              	.LVL174:
 1604              	.L142:
1728:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1729:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1730:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();
1731:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1732:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   memcpy((char*)WiFi_AT_Cmd_Buff,Data,DataLength);
1733:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(DataLength);
1734:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1735:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   HAL_NVIC_EnableIRQ(TIMx_IRQn);
1736:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
1737:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 1605              		.loc 1 1737 0
 1606 000c 2046     		mov	r0, r4
 1607 000e 38BD     		pop	{r3, r4, r5, pc}
 1608              	.LVL175:
 1609              	.L145:
 1610 0010 0D46     		mov	r5, r1
 1611 0012 0446     		mov	r4, r0
 1612              	.LVL176:
1730:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 1613              		.loc 1 1730 0
 1614 0014 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 1615              	.LVL177:
1732:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(DataLength);
 1616              		.loc 1 1732 0
 1617 0018 2246     		mov	r2, r4
 1618 001a 2946     		mov	r1, r5
 1619 001c 0548     		ldr	r0, .L146
 1620 001e FFF7FEFF 		bl	memcpy
 1621              	.LVL178:
1733:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 1622              		.loc 1 1733 0
 1623 0022 A0B2     		uxth	r0, r4
 1624 0024 FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 1625              	.LVL179:
 1626 0028 0446     		mov	r4, r0
 1627              	.LVL180:
1735:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
 1628              		.loc 1 1735 0
 1629 002a 1D20     		movs	r0, #29
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 64


 1630 002c FFF7FEFF 		bl	HAL_NVIC_EnableIRQ
 1631              	.LVL181:
1736:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 1632              		.loc 1 1736 0
 1633 0030 ECE7     		b	.L142
 1634              	.L147:
 1635 0032 00BF     		.align	2
 1636              	.L146:
 1637 0034 00000000 		.word	WiFi_AT_Cmd_Buff
 1638              		.cfi_endproc
 1639              	.LFE295:
 1641              		.section	.text.wifi_http_get,"ax",%progbits
 1642              		.align	1
 1643              		.global	wifi_http_get
 1644              		.syntax unified
 1645              		.thumb
 1646              		.thumb_func
 1647              		.fpu fpv4-sp-d16
 1649              	wifi_http_get:
 1650              	.LFB296:
1738:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
1739:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1740:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1741:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_http_get
1742:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Issue an HTTP GET of the given path to the specified host
1743:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  hostname: Target host. DNS resolvable name or IP address.
1744:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  path : Document path
1745:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  port_number: port number to connect to
1746:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : return status of AT cmd response
1747:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1748:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1749:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_http_get(uint8_t * hostname, uint8_t * path, uint32_t port_number)
1750:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 1651              		.loc 1 1750 0
 1652              		.cfi_startproc
 1653              		@ args = 0, pretend = 0, frame = 0
 1654              		@ frame_needed = 0, uses_anonymous_args = 0
 1655              	.LVL182:
1751:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(hostname == NULL || path == NULL)
 1656              		.loc 1 1751 0
 1657 0000 A0B1     		cbz	r0, .L152
1750:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(hostname == NULL || path == NULL)
 1658              		.loc 1 1750 0 discriminator 1
 1659 0002 10B5     		push	{r4, lr}
 1660              	.LCFI28:
 1661              		.cfi_def_cfa_offset 8
 1662              		.cfi_offset 4, -8
 1663              		.cfi_offset 14, -4
 1664 0004 0446     		mov	r4, r0
 1665              		.loc 1 1751 0 discriminator 1
 1666 0006 11B9     		cbnz	r1, .L150
1752:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_MODULE_ERROR;
 1667              		.loc 1 1752 0
 1668 0008 0220     		movs	r0, #2
 1669              	.LVL183:
1753:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1754:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 65


1755:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1756:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.sock_read_ongoing || IO_status_flag.WIND64_count!= 0) //wait till any pendin
1757:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
1758:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       __NOP(); //nothing to do
1759:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
1760:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1761:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   // AT+S.HTTPGET=host.example.com,/index.html, port_number<cr>
1762:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //Queue the http-get command
1763:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Http_Event(hostname, path, port_number,0);
1764:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1765:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //Make the user wait anyway
1766:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1767:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1768:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
1769:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 1670              		.loc 1 1769 0
 1671 000a 10BD     		pop	{r4, pc}
 1672              	.LVL184:
 1673              	.L151:
1758:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
 1674              		.loc 1 1758 0
 1675              		.syntax unified
 1676              	@ 1758 "Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c" 1
 1677 000c 00BF     		nop
 1678              	@ 0 "" 2
 1679              		.thumb
 1680              		.syntax unified
 1681              	.L150:
1756:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 1682              		.loc 1 1756 0
 1683 000e 084B     		ldr	r3, .L158
 1684 0010 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1685 0012 13F0010F 		tst	r3, #1
 1686 0016 F9D1     		bne	.L151
1756:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 1687              		.loc 1 1756 0 is_stmt 0 discriminator 1
 1688 0018 054B     		ldr	r3, .L158
 1689 001a 5B68     		ldr	r3, [r3, #4]
 1690 001c 002B     		cmp	r3, #0
 1691 001e F5D1     		bne	.L151
 1692 0020 2046     		mov	r0, r4
 1693              	.LVL185:
1763:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 1694              		.loc 1 1763 0 is_stmt 1
 1695 0022 FFF7FEFF 		bl	Queue_Http_Event
 1696              	.LVL186:
1766:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 1697              		.loc 1 1766 0
 1698 0026 FFF7FEFF 		bl	USART_Receive_AT_Resp
 1699              	.LVL187:
1768:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 1700              		.loc 1 1768 0
 1701 002a 10BD     		pop	{r4, pc}
 1702              	.LVL188:
 1703              	.L152:
 1704              	.LCFI29:
 1705              		.cfi_def_cfa_offset 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 66


 1706              		.cfi_restore 4
 1707              		.cfi_restore 14
1752:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 1708              		.loc 1 1752 0
 1709 002c 0220     		movs	r0, #2
 1710              	.LVL189:
 1711 002e 7047     		bx	lr
 1712              	.L159:
 1713              		.align	2
 1714              	.L158:
 1715 0030 00000000 		.word	IO_status_flag
 1716              		.cfi_endproc
 1717              	.LFE296:
 1719              		.section	.text.wifi_http_post,"ax",%progbits
 1720              		.align	1
 1721              		.global	wifi_http_post
 1722              		.syntax unified
 1723              		.thumb
 1724              		.thumb_func
 1725              		.fpu fpv4-sp-d16
 1727              	wifi_http_post:
 1728              	.LFB297:
1770:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1771:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1772:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_http_post
1773:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Issue an HTTP GET of the given path to the specified host
1774:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  hostname: Target host. DNS resolvable name or IP address.
1775:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  path: Document path
1776:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  port_number: port number to connect to
1777:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : status of Http Post Request
1778:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1779:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1780:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_http_post(uint8_t * hostname, uint8_t * path, uint32_t port_number)
1781:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 1729              		.loc 1 1781 0
 1730              		.cfi_startproc
 1731              		@ args = 0, pretend = 0, frame = 0
 1732              		@ frame_needed = 0, uses_anonymous_args = 0
 1733              	.LVL190:
1782:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(hostname == NULL || path == NULL)
 1734              		.loc 1 1782 0
 1735 0000 A8B1     		cbz	r0, .L164
1781:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(hostname == NULL || path == NULL)
 1736              		.loc 1 1781 0 discriminator 1
 1737 0002 10B5     		push	{r4, lr}
 1738              	.LCFI30:
 1739              		.cfi_def_cfa_offset 8
 1740              		.cfi_offset 4, -8
 1741              		.cfi_offset 14, -4
 1742 0004 0446     		mov	r4, r0
 1743              		.loc 1 1782 0 discriminator 1
 1744 0006 11B9     		cbnz	r1, .L162
1783:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_MODULE_ERROR;
 1745              		.loc 1 1783 0
 1746 0008 0220     		movs	r0, #2
 1747              	.LVL191:
1784:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 67


1785:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1786:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1787:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.sock_read_ongoing || IO_status_flag.WIND64_count!= 0)//wait till any pending
1788:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
1789:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       __NOP(); //nothing to do
1790:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
1791:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1792:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   // AT+S.HTTPPOST = posttestserver.com,/post.php,name=demo&email=mymail&subject=subj&body=message<
1793:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Http_Event(hostname, path, port_number,1);
1794:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1795:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //Make the user wait anyway
1796:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
1797:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
1798:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 1748              		.loc 1 1798 0
 1749 000a 10BD     		pop	{r4, pc}
 1750              	.LVL192:
 1751              	.L163:
1789:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
 1752              		.loc 1 1789 0
 1753              		.syntax unified
 1754              	@ 1789 "Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c" 1
 1755 000c 00BF     		nop
 1756              	@ 0 "" 2
 1757              		.thumb
 1758              		.syntax unified
 1759              	.L162:
1787:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 1760              		.loc 1 1787 0
 1761 000e 094B     		ldr	r3, .L170
 1762 0010 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1763 0012 13F0010F 		tst	r3, #1
 1764 0016 F9D1     		bne	.L163
1787:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 1765              		.loc 1 1787 0 is_stmt 0 discriminator 1
 1766 0018 064B     		ldr	r3, .L170
 1767 001a 5B68     		ldr	r3, [r3, #4]
 1768 001c 002B     		cmp	r3, #0
 1769 001e F5D1     		bne	.L163
 1770 0020 2046     		mov	r0, r4
 1771              	.LVL193:
1793:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 1772              		.loc 1 1793 0 is_stmt 1
 1773 0022 0123     		movs	r3, #1
 1774 0024 FFF7FEFF 		bl	Queue_Http_Event
 1775              	.LVL194:
1796:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
 1776              		.loc 1 1796 0
 1777 0028 FFF7FEFF 		bl	USART_Receive_AT_Resp
 1778              	.LVL195:
1797:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 1779              		.loc 1 1797 0
 1780 002c 10BD     		pop	{r4, pc}
 1781              	.LVL196:
 1782              	.L164:
 1783              	.LCFI31:
 1784              		.cfi_def_cfa_offset 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 68


 1785              		.cfi_restore 4
 1786              		.cfi_restore 14
1783:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 1787              		.loc 1 1783 0
 1788 002e 0220     		movs	r0, #2
 1789              	.LVL197:
 1790 0030 7047     		bx	lr
 1791              	.L171:
 1792 0032 00BF     		.align	2
 1793              	.L170:
 1794 0034 00000000 		.word	IO_status_flag
 1795              		.cfi_endproc
 1796              	.LFE297:
 1798              		.section	.text.wifi_file_image_create,"ax",%progbits
 1799              		.align	1
 1800              		.global	wifi_file_image_create
 1801              		.syntax unified
 1802              		.thumb
 1803              		.thumb_func
 1804              		.fpu fpv4-sp-d16
 1806              	wifi_file_image_create:
 1807              	.LFB298:
1799:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1800:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1801:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_file_image_create
1802:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Downloads an updated file system via a single HTTP GET request to the
1803:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         named host and path.
1804:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  HostName: Target host. DNS resolvable name or IP address.
1805:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  FileName: Document path/name
1806:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  port_number: port number to connect to
1807:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t
1808:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1809:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_file_image_create(uint8_t * HostName, uint8_t * FileName, uint32_t port_number)
1810:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 1808              		.loc 1 1810 0
 1809              		.cfi_startproc
 1810              		@ args = 0, pretend = 0, frame = 0
 1811              		@ frame_needed = 0, uses_anonymous_args = 0
 1812              	.LVL198:
 1813 0000 10B5     		push	{r4, lr}
 1814              	.LCFI32:
 1815              		.cfi_def_cfa_offset 8
 1816              		.cfi_offset 4, -8
 1817              		.cfi_offset 14, -4
 1818 0002 82B0     		sub	sp, sp, #8
 1819              	.LCFI33:
 1820              		.cfi_def_cfa_offset 16
1811:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(HostName == NULL || FileName == NULL ||  port_number ==0)
 1821              		.loc 1 1811 0
 1822 0004 98B1     		cbz	r0, .L174
 1823              		.loc 1 1811 0 is_stmt 0 discriminator 1
 1824 0006 A1B1     		cbz	r1, .L175
 1825              		.loc 1 1811 0 discriminator 2
 1826 0008 1AB9     		cbnz	r2, .L178
1812:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_MODULE_ERROR;
 1827              		.loc 1 1812 0 is_stmt 1
 1828 000a 0224     		movs	r4, #2
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 69


 1829              	.LVL199:
 1830              	.L173:
1813:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1814:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1815:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Queue_Wifi_File_Event(HostName,FileName,port_number,-1,-1);
1816:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
1817:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
1818:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****      if(status == WiFi_MODULE_SUCCESS) 
1819:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
1820:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* Soft reset the module */
1821:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #ifdef SPWF04
1822:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         Soft_Reset();
1823:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #else
1824:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         SET_Power_State(PowerSave_State); 
1825:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #endif
1826:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
1827:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return status;
1828:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 1831              		.loc 1 1828 0
 1832 000c 2046     		mov	r0, r4
 1833 000e 02B0     		add	sp, sp, #8
 1834              	.LCFI34:
 1835              		.cfi_remember_state
 1836              		.cfi_def_cfa_offset 8
 1837              		@ sp needed
 1838 0010 10BD     		pop	{r4, pc}
 1839              	.LVL200:
 1840              	.L178:
 1841              	.LCFI35:
 1842              		.cfi_restore_state
1815:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
 1843              		.loc 1 1815 0
 1844 0012 4FF0FF33 		mov	r3, #-1
 1845 0016 0093     		str	r3, [sp]
 1846 0018 FFF7FEFF 		bl	Queue_Wifi_File_Event
 1847              	.LVL201:
1816:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
 1848              		.loc 1 1816 0
 1849 001c FFF7FEFF 		bl	USART_Receive_AT_Resp
 1850              	.LVL202:
1818:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
 1851              		.loc 1 1818 0
 1852 0020 0446     		mov	r4, r0
 1853 0022 0028     		cmp	r0, #0
 1854 0024 F2D1     		bne	.L173
1824:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #endif
 1855              		.loc 1 1824 0
 1856 0026 0120     		movs	r0, #1
 1857              	.LVL203:
 1858 0028 FFF7FEFF 		bl	SET_Power_State
 1859              	.LVL204:
 1860 002c EEE7     		b	.L173
 1861              	.LVL205:
 1862              	.L174:
1812:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 1863              		.loc 1 1812 0
 1864 002e 0224     		movs	r4, #2
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 70


 1865 0030 ECE7     		b	.L173
 1866              	.L175:
 1867 0032 0224     		movs	r4, #2
 1868 0034 EAE7     		b	.L173
 1869              		.cfi_endproc
 1870              	.LFE298:
 1872              		.section	.text.wifi_file_erase_external_flash,"ax",%progbits
 1873              		.align	1
 1874              		.global	wifi_file_erase_external_flash
 1875              		.syntax unified
 1876              		.thumb
 1877              		.thumb_func
 1878              		.fpu fpv4-sp-d16
 1880              	wifi_file_erase_external_flash:
 1881              	.LFB299:
1829:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1830:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1831:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_file_erase_external_flash
1832:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         This API allows to erase the content of the external flash
1833:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  None
1834:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t
1835:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1836:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_file_erase_external_flash()
1837:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 1882              		.loc 1 1837 0
 1883              		.cfi_startproc
 1884              		@ args = 0, pretend = 0, frame = 0
 1885              		@ frame_needed = 0, uses_anonymous_args = 0
 1886 0000 38B5     		push	{r3, r4, r5, lr}
 1887              	.LCFI36:
 1888              		.cfi_def_cfa_offset 16
 1889              		.cfi_offset 3, -16
 1890              		.cfi_offset 4, -12
 1891              		.cfi_offset 5, -8
 1892              		.cfi_offset 14, -4
 1893              	.LVL206:
1838:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;  
1839:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1840:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();
 1894              		.loc 1 1840 0
 1895 0002 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 1896              	.LVL207:
1841:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   ResetBuffer();
 1897              		.loc 1 1841 0
 1898 0006 FFF7FEFF 		bl	ResetBuffer
 1899              	.LVL208:
1842:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1843:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.HTTPDFSERASE */
1844:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_ERASE_FLASH_MEMORY);  
 1900              		.loc 1 1844 0
 1901 000a 0B4D     		ldr	r5, .L181
 1902 000c 0B4C     		ldr	r4, .L181+4
 1903 000e 0FCC     		ldmia	r4!, {r0, r1, r2, r3}
 1904 0010 2860     		str	r0, [r5]	@ unaligned
 1905 0012 6960     		str	r1, [r5, #4]	@ unaligned
 1906 0014 AA60     		str	r2, [r5, #8]	@ unaligned
 1907 0016 EB60     		str	r3, [r5, #12]	@ unaligned
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 71


 1908 0018 2288     		ldrh	r2, [r4]	@ unaligned
 1909 001a A378     		ldrb	r3, [r4, #2]	@ zero_extendqisi2
 1910 001c 2A82     		strh	r2, [r5, #16]	@ unaligned
 1911 001e AB74     		strb	r3, [r5, #18]
1845:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 1912              		.loc 1 1845 0
 1913 0020 2846     		mov	r0, r5
 1914 0022 FFF7FEFF 		bl	strlen
 1915              	.LVL209:
 1916 0026 80B2     		uxth	r0, r0
 1917 0028 FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 1918              	.LVL210:
 1919 002c 0446     		mov	r4, r0
 1920              	.LVL211:
1846:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1847:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Soft reset the module */
1848:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04
1849:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Soft reset the module */
1850:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    Soft_Reset();
1851:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
1852:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Soft reset the module */
1853:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    SET_Power_State(PowerSave_State); 
 1921              		.loc 1 1853 0
 1922 002e 0120     		movs	r0, #1
 1923 0030 FFF7FEFF 		bl	SET_Power_State
 1924              	.LVL212:
1854:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
1855:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1856:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    return status;
1857:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 1925              		.loc 1 1857 0
 1926 0034 2046     		mov	r0, r4
 1927 0036 38BD     		pop	{r3, r4, r5, pc}
 1928              	.LVL213:
 1929              	.L182:
 1930              		.align	2
 1931              	.L181:
 1932 0038 00000000 		.word	WiFi_AT_Cmd_Buff
 1933 003c 00000000 		.word	.LC11
 1934              		.cfi_endproc
 1935              	.LFE299:
 1937              		.section	.text.wifi_fw_update,"ax",%progbits
 1938              		.align	1
 1939              		.global	wifi_fw_update
 1940              		.syntax unified
 1941              		.thumb
 1942              		.thumb_func
 1943              		.fpu fpv4-sp-d16
 1945              	wifi_fw_update:
 1946              	.LFB300:
1858:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1859:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1860:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_fw_update
1861:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Issue an HTTP GET of the given path to the specified host and get the firmware updated
1862:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  hostname: Target host. DNS resolvable name or IP address.
1863:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  FileName: Document path/name
1864:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  port_number: port number to connect to
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 72


1865:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval None
1866:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1867:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_fw_update(uint8_t * hostname, uint8_t * filename_path, uint32_t port_number)
1868:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 1947              		.loc 1 1868 0
 1948              		.cfi_startproc
 1949              		@ args = 0, pretend = 0, frame = 0
 1950              		@ frame_needed = 0, uses_anonymous_args = 0
 1951              	.LVL214:
 1952 0000 10B5     		push	{r4, lr}
 1953              	.LCFI37:
 1954              		.cfi_def_cfa_offset 8
 1955              		.cfi_offset 4, -8
 1956              		.cfi_offset 14, -4
 1957              	.LVL215:
1869:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1870:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Queue_Wifi_FW_Update_Event(hostname,filename_path,port_number);
 1958              		.loc 1 1870 0
 1959 0002 FFF7FEFF 		bl	Queue_Wifi_FW_Update_Event
 1960              	.LVL216:
1871:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
 1961              		.loc 1 1871 0
 1962 0006 FFF7FEFF 		bl	USART_Receive_AT_Resp
 1963              	.LVL217:
1872:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1873:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS) {
 1964              		.loc 1 1873 0
 1965 000a 0446     		mov	r4, r0
 1966 000c 08B1     		cbz	r0, .L186
 1967              	.LVL218:
 1968              	.L184:
1874:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(CONSOLE_UART_ENABLED)
1875:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* Soft reset the module */
1876:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #ifdef SPWF04
1877:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****          Soft_Reset();
1878:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #else
1879:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****          SET_Power_State(PowerSave_State); 
1880:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #endif
1881:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
1882:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       printf("\r\nFW Updated...\r\nResetting module...");
1883:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       Reset_AT_CMD_Buffer();
1884:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.RESET");
1885:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);     
1886:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       //status = USART_Receive_AT_Resp( );//there is no OK after this?
1887:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       //wifi_connected = 0; //reset wifi_connected to get user callback
1888:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       IO_status_flag.WiFi_WIND_State = Undefine_state;
1889:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       while(IO_status_flag.WiFi_WIND_State != WiFiHWStarted)
1890:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
1891:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         //__NOP(); //nothing to do
1892:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
1893:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
1894:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
1895:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
1896:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 1969              		.loc 1 1896 0
 1970 000e 2046     		mov	r0, r4
 1971 0010 10BD     		pop	{r4, pc}
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 73


 1972              	.LVL219:
 1973              	.L186:
1879:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #endif
 1974              		.loc 1 1879 0
 1975 0012 0120     		movs	r0, #1
 1976              	.LVL220:
 1977 0014 FFF7FEFF 		bl	SET_Power_State
 1978              	.LVL221:
 1979 0018 F9E7     		b	.L184
 1980              		.cfi_endproc
 1981              	.LFE300:
 1983              		.section	.text.wifi_network_scan,"ax",%progbits
 1984              		.align	1
 1985              		.global	wifi_network_scan
 1986              		.syntax unified
 1987              		.thumb
 1988              		.thumb_func
 1989              		.fpu fpv4-sp-d16
 1991              	wifi_network_scan:
 1992              	.LFB301:
1897:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1898:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1899:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_network_scan
1900:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Performs an immediate scan for available network
1901:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  None
1902:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : WiFi status error
1903:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1904:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_network_scan(wifi_scan *scan_result, uint16_t max_scan_number)
1905:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 1993              		.loc 1 1905 0
 1994              		.cfi_startproc
 1995              		@ args = 0, pretend = 0, frame = 0
 1996              		@ frame_needed = 0, uses_anonymous_args = 0
 1997              	.LVL222:
 1998 0000 08B5     		push	{r3, lr}
 1999              	.LCFI38:
 2000              		.cfi_def_cfa_offset 8
 2001              		.cfi_offset 3, -8
 2002              		.cfi_offset 14, -4
 2003              	.LVL223:
1906:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
1907:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   wifi_scanned_list = scan_result;
 2004              		.loc 1 1907 0
 2005 0002 164B     		ldr	r3, .L194
 2006 0004 1860     		str	r0, [r3]
1908:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(max_scan_number>MAX_WIFI_SCAN_NETWORK)
 2007              		.loc 1 1908 0
 2008 0006 B1F5807F 		cmp	r1, #256
 2009 000a 02D9     		bls	.L192
1909:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_NOT_SUPPORTED;
 2010              		.loc 1 1909 0
 2011 000c 0423     		movs	r3, #4
 2012              	.LVL224:
 2013              	.L188:
1910:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Counter_Variables.user_scan_number = max_scan_number;
1911:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1912:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(WiFi_Control_Variables.Scan_Ongoing)
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 74


1913:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
1914:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_AT_CMD_BUSY;
1915:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
1916:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1917:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Control_Variables.Scan_Ongoing = WIFI_TRUE;
1918:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1919:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT+S.SCAN: performs an immediate scan for available networks */
1920:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();
1921:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(CONSOLE_UART_ENABLED)
1922:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_WiFi_SCAN);  
1923:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
1924:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else  
1925:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.SCAN=s,NULL");
1926:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
1927:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   IO_status_flag.AT_event_processing = WIFI_SCAN_EVENT;
1928:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = WiFi_MODULE_SUCCESS;
1929:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
1930:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1931:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
1932:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
1933:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
1934:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
1935:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1936:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*At this point we have WiFi_Scan_Buffer filled with RSSI and SSID values*/
1937:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
1938:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 2014              		.loc 1 1938 0
 2015 000e 1846     		mov	r0, r3
 2016 0010 08BD     		pop	{r3, pc}
 2017              	.LVL225:
 2018              	.L192:
1910:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Counter_Variables.user_scan_number = max_scan_number;
 2019              		.loc 1 1910 0
 2020 0012 134B     		ldr	r3, .L194+4
 2021 0014 1973     		strb	r1, [r3, #12]
1912:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
 2022              		.loc 1 1912 0
 2023 0016 134B     		ldr	r3, .L194+8
 2024 0018 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 2025 001a 13F0020F 		tst	r3, #2
 2026 001e 01D0     		beq	.L193
1914:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 2027              		.loc 1 1914 0
 2028 0020 0723     		movs	r3, #7
 2029 0022 F4E7     		b	.L188
 2030              	.L193:
1917:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 2031              		.loc 1 1917 0
 2032 0024 0F4A     		ldr	r2, .L194+8
 2033 0026 43F00203 		orr	r3, r3, #2
 2034 002a 5370     		strb	r3, [r2, #1]
1920:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(CONSOLE_UART_ENABLED)
 2035              		.loc 1 1920 0
 2036 002c FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 2037              	.LVL226:
1922:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 2038              		.loc 1 1922 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 75


 2039 0030 0D4A     		ldr	r2, .L194+12
 2040 0032 0E4B     		ldr	r3, .L194+16
 2041 0034 03CB     		ldmia	r3!, {r0, r1}
 2042 0036 1060     		str	r0, [r2]	@ unaligned
 2043 0038 5160     		str	r1, [r2, #4]	@ unaligned
 2044 003a 1988     		ldrh	r1, [r3]	@ unaligned
 2045 003c 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
 2046 003e 1181     		strh	r1, [r2, #8]	@ unaligned
 2047 0040 9372     		strb	r3, [r2, #10]
1923:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else  
 2048              		.loc 1 1923 0
 2049 0042 1046     		mov	r0, r2
 2050 0044 FFF7FEFF 		bl	strlen
 2051              	.LVL227:
 2052 0048 80B2     		uxth	r0, r0
 2053 004a FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 2054              	.LVL228:
1931:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
 2055              		.loc 1 1931 0
 2056 004e 0346     		mov	r3, r0
 2057 0050 0028     		cmp	r0, #0
 2058 0052 DCD1     		bne	.L188
1933:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 2059              		.loc 1 1933 0
 2060 0054 FFF7FEFF 		bl	USART_Receive_AT_Resp
 2061              	.LVL229:
 2062 0058 0346     		mov	r3, r0
 2063              	.LVL230:
 2064 005a D8E7     		b	.L188
 2065              	.L195:
 2066              		.align	2
 2067              	.L194:
 2068 005c 00000000 		.word	wifi_scanned_list
 2069 0060 00000000 		.word	WiFi_Counter_Variables
 2070 0064 00000000 		.word	WiFi_Control_Variables
 2071 0068 00000000 		.word	WiFi_AT_Cmd_Buff
 2072 006c 00000000 		.word	.LC12
 2073              		.cfi_endproc
 2074              	.LFE301:
 2076              		.section	.text.wifi_ap_start,"ax",%progbits
 2077              		.align	1
 2078              		.global	wifi_ap_start
 2079              		.syntax unified
 2080              		.thumb
 2081              		.thumb_func
 2082              		.fpu fpv4-sp-d16
 2084              	wifi_ap_start:
 2085              	.LFB302:
1939:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
1940:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
1941:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  Set_MiniAP_Mode
1942:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Configure Wi-Fi module in AP mode.
1943:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           MiniAP is always configured in open mode (WEP not supported)
1944:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  SSID      : SSID name of the AP
1945:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  sec_key   : security key
1946:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  channel_num   : channel number
1947:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  priv_mode : privacy mode
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 76


1948:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : status of AT cmd 
1949:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
1950:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_ap_start(uint8_t * ssid, char * sec_key, uint8_t channel_num, WiFi_Priv_Mode pri
1951:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 2086              		.loc 1 1951 0
 2087              		.cfi_startproc
 2088              		@ args = 0, pretend = 0, frame = 0
 2089              		@ frame_needed = 0, uses_anonymous_args = 0
 2090              	.LVL231:
 2091 0000 70B5     		push	{r4, r5, r6, lr}
 2092              	.LCFI39:
 2093              		.cfi_def_cfa_offset 16
 2094              		.cfi_offset 4, -16
 2095              		.cfi_offset 5, -12
 2096              		.cfi_offset 6, -8
 2097              		.cfi_offset 14, -4
 2098 0002 0446     		mov	r4, r0
 2099 0004 1646     		mov	r6, r2
 2100 0006 1D46     		mov	r5, r3
 2101              	.LVL232:
1952:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;  
1953:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1954:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(sec_key) {
 2102              		.loc 1 1954 0
 2103 0008 31B1     		cbz	r1, .L197
 2104 000a 0846     		mov	r0, r1
 2105              	.LVL233:
1955:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = SET_WiFi_SecKey((char*)sec_key);
 2106              		.loc 1 1955 0
 2107 000c FFF7FEFF 		bl	SET_WiFi_SecKey
 2108              	.LVL234:
1956:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS)
 2109              		.loc 1 1956 0
 2110 0010 10B1     		cbz	r0, .L197
1957:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         return WiFi_SecKey_ERROR;
 2111              		.loc 1 1957 0
 2112 0012 0924     		movs	r4, #9
 2113              	.LVL235:
 2114              	.L198:
1958:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
1959:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1960:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set the SSID : AT+S.SSIDTXT=<SSID>*/    
1961:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(ssid)
1962:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = SET_SSID((char*)ssid);
1963:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   else 
1964:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /* default SSID : AT+S.SSIDTXT=SPWF_AP*/
1965:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = SET_SSID(WiFi_Config_Variables.wifi_ssid);
1966:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1967:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
1968:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_SSID_ERROR;
1969:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
1970:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(CONSOLE_UART_ENABLED)
1971:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1972:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04
1973:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /*AT+S.WIFI=0<cr>*/  
1974:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_WIFI_ENABLE, 0);  
1975:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 77


1976:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
1977:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
1978:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
1979:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status;
1980:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     else IO_status_flag.radio_off = WIFI_TRUE;
1981:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
1982:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1983:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_WIND_State!= WiFiPowerDown);//Till +WIND:38:WiFi Powered Down arrives
1984:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif    
1985:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1986:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set the network privacy mode : AT+S.SCFG=wifi_priv_mode,mode*/ 
1987:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    status = SET_Configuration_Value(WIFI_PRIV_MODE, priv_mode); 
1988:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
1989:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
1990:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
1991:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set the network mode (1 = STA, 2 = IBSS, 3 = MiniAP) :: AT+S.SCFG=wifi_mode,3*/  
1992:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    status = SET_Configuration_Value(WIFI_MODE, WiFi_MiniAP_MODE);
1993:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    if(status != WiFi_MODULE_SUCCESS)
1994:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
1995:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    
1996:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set the channel number */  
1997:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    status = SET_Configuration_Value(WIFI_CHANNEL_NUMBER, channel_num);
1998:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    if(status != WiFi_MODULE_SUCCESS)
1999:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;    
2000:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
2001:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04  
2002:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /*AT+S.WIFI=1<cr>*/  
2003:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_WIFI_ENABLE, 1);  
2004:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
2005:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
2006:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
2007:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
2008:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status;
2009:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     else IO_status_flag.radio_off = WIFI_FALSE;
2010:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
2011:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2012:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_Enabled != WIFI_TRUE);//Till Hardware Started arrives
2013:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif    
2014:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    
2015:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF01
2016:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Save the settings on the flash memory : AT&W*/ 
2017:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    Save_Current_Setting();
2018:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    WiFi_Control_Variables.WiFi_Configuration_Done = WIFI_TRUE;
2019:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2020:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Soft reset the module */
2021:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    SET_Power_State(PowerSave_State); 
2022:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2023:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2024:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2025:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    /* Set radio OFF */
2026:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();  
2027:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.WIFI=%d", 0);  
2028:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2029:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
2030:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS) return status;
2031:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_WIND_State!= WiFiPowerDown);//Till +WIND:38:WiFi Powered Down arrives
2032:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 78


2033:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    /* Set the network privacy mode : AT+S.SCFG=wifi_priv_mode,mode*/ 
2034:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    status = SET_Configuration_Value(WIFI_PRIV_MODE, priv_mode);
2035:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
2036:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
2037:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2038:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set the network mode (1 = STA, 2 = IBSS, 3 = MiniAP) :: AT+S.SCFG=wifi_mode,3*/  
2039:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    status = SET_Configuration_Value(WIFI_MODE, WiFi_MiniAP_MODE);
2040:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    if(status != WiFi_MODULE_SUCCESS)
2041:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
2042:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2043:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set the SSID : AT+S.SSIDTXT=<SSID>*/    
2044:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(ssid)
2045:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = SET_SSID((char*)ssid);
2046:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   else 
2047:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /* default SSID : AT+S.SSIDTXT=SPWF_AP*/
2048:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = SET_SSID(WiFi_Config_Variables.wifi_ssid);
2049:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2050:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
2051:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_SSID_ERROR;
2052:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2053:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set the channel number */  
2054:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    status = SET_Configuration_Value(WIFI_CHANNEL_NUMBER, channel_num);
2055:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    if(status != WiFi_MODULE_SUCCESS)
2056:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR; 
2057:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2058:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set radio ON */  
2059:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();  
2060:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.WIFI=%d", 1);  
2061:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2062:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
2063:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS) return status;
2064:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_Enabled != WIFI_TRUE);//Till Hardware Started arrives
2065:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Control_Variables.WiFi_Configuration_Done = WIFI_TRUE;
2066:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2067:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2068:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2069:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
2070:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 2115              		.loc 1 2070 0
 2116 0014 2046     		mov	r0, r4
 2117 0016 70BD     		pop	{r4, r5, r6, pc}
 2118              	.LVL236:
 2119              	.L197:
1961:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = SET_SSID((char*)ssid);
 2120              		.loc 1 1961 0
 2121 0018 2CB1     		cbz	r4, .L199
1962:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   else 
 2122              		.loc 1 1962 0
 2123 001a 2046     		mov	r0, r4
 2124 001c FFF7FEFF 		bl	SET_SSID
 2125              	.LVL237:
 2126              	.L200:
1967:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_SSID_ERROR;
 2127              		.loc 1 1967 0
 2128 0020 30B1     		cbz	r0, .L207
1968:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
 2129              		.loc 1 1968 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 79


 2130 0022 0824     		movs	r4, #8
 2131              	.LVL238:
 2132 0024 F6E7     		b	.L198
 2133              	.LVL239:
 2134              	.L199:
1965:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 2135              		.loc 1 1965 0
 2136 0026 134B     		ldr	r3, .L211
 2137 0028 5868     		ldr	r0, [r3, #4]
 2138 002a FFF7FEFF 		bl	SET_SSID
 2139              	.LVL240:
 2140 002e F7E7     		b	.L200
 2141              	.L207:
1987:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
 2142              		.loc 1 1987 0
 2143 0030 2946     		mov	r1, r5
 2144 0032 1148     		ldr	r0, .L211+4
 2145              	.LVL241:
 2146 0034 FFF7FEFF 		bl	SET_Configuration_Value
 2147              	.LVL242:
1988:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
 2148              		.loc 1 1988 0
 2149 0038 08B1     		cbz	r0, .L208
1989:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 2150              		.loc 1 1989 0
 2151 003a 0A24     		movs	r4, #10
 2152              	.LVL243:
 2153 003c EAE7     		b	.L198
 2154              	.LVL244:
 2155              	.L208:
1992:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    if(status != WiFi_MODULE_SUCCESS)
 2156              		.loc 1 1992 0
 2157 003e 0321     		movs	r1, #3
 2158 0040 0E48     		ldr	r0, .L211+8
 2159              	.LVL245:
 2160 0042 FFF7FEFF 		bl	SET_Configuration_Value
 2161              	.LVL246:
1993:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
 2162              		.loc 1 1993 0
 2163 0046 08B1     		cbz	r0, .L209
1994:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    
 2164              		.loc 1 1994 0
 2165 0048 0A24     		movs	r4, #10
 2166              	.LVL247:
 2167 004a E3E7     		b	.L198
 2168              	.LVL248:
 2169              	.L209:
1997:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    if(status != WiFi_MODULE_SUCCESS)
 2170              		.loc 1 1997 0
 2171 004c 3146     		mov	r1, r6
 2172 004e 0C48     		ldr	r0, .L211+12
 2173              	.LVL249:
 2174 0050 FFF7FEFF 		bl	SET_Configuration_Value
 2175              	.LVL250:
1998:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;    
 2176              		.loc 1 1998 0
 2177 0054 0446     		mov	r4, r0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 80


 2178              	.LVL251:
 2179 0056 08B1     		cbz	r0, .L210
1999:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
 2180              		.loc 1 1999 0
 2181 0058 0A24     		movs	r4, #10
 2182 005a DBE7     		b	.L198
 2183              	.L210:
2017:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    WiFi_Control_Variables.WiFi_Configuration_Done = WIFI_TRUE;
 2184              		.loc 1 2017 0
 2185 005c FFF7FEFF 		bl	Save_Current_Setting
 2186              	.LVL252:
2018:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 2187              		.loc 1 2018 0
 2188 0060 084A     		ldr	r2, .L211+16
 2189 0062 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 2190 0064 43F00403 		orr	r3, r3, #4
 2191 0068 1370     		strb	r3, [r2]
2021:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
 2192              		.loc 1 2021 0
 2193 006a 0120     		movs	r0, #1
 2194 006c FFF7FEFF 		bl	SET_Power_State
 2195              	.LVL253:
2069:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 2196              		.loc 1 2069 0
 2197 0070 D0E7     		b	.L198
 2198              	.L212:
 2199 0072 00BF     		.align	2
 2200              	.L211:
 2201 0074 00000000 		.word	WiFi_Config_Variables
 2202 0078 00000000 		.word	.LC13
 2203 007c 10000000 		.word	.LC14
 2204 0080 1C000000 		.word	.LC15
 2205 0084 00000000 		.word	WiFi_Control_Variables
 2206              		.cfi_endproc
 2207              	.LFE302:
 2209              		.section	.text.wifi_connect,"ax",%progbits
 2210              		.align	1
 2211              		.global	wifi_connect
 2212              		.syntax unified
 2213              		.thumb
 2214              		.thumb_func
 2215              		.fpu fpv4-sp-d16
 2217              	wifi_connect:
 2218              	.LFB303:
2071:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2072:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2073:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
2074:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  SET_WiFi_STA_Mode
2075:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Configure Wi-Fi module in STA mode
2076:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  SSID     : SSID name
2077:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  sec_key  : security key
2078:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  priv_mode : network privecy mode
2079:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : status of AT cmd 
2080:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
2081:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_connect(char * ssid, char * sec_key, WiFi_Priv_Mode priv_mode)
2082:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 2219              		.loc 1 2082 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 81


 2220              		.cfi_startproc
 2221              		@ args = 0, pretend = 0, frame = 0
 2222              		@ frame_needed = 0, uses_anonymous_args = 0
 2223              	.LVL254:
 2224 0000 38B5     		push	{r3, r4, r5, lr}
 2225              	.LCFI40:
 2226              		.cfi_def_cfa_offset 16
 2227              		.cfi_offset 3, -16
 2228              		.cfi_offset 4, -12
 2229              		.cfi_offset 5, -8
 2230              		.cfi_offset 14, -4
 2231              	.LVL255:
2083:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
2084:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    if(WiFi_Control_Variables.AT_Cmd_Ongoing == WIFI_FALSE)
 2232              		.loc 1 2084 0
 2233 0002 1F4B     		ldr	r3, .L228
 2234 0004 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 2235 0006 13F0040F 		tst	r3, #4
 2236 000a 02D0     		beq	.L224
2085:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Control_Variables.AT_Cmd_Ongoing = WIFI_TRUE;
2086:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   else 
2087:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
2088:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_AT_CMD_BUSY;
 2237              		.loc 1 2088 0
 2238 000c 0724     		movs	r4, #7
 2239              	.LVL256:
 2240              	.L214:
2089:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
2090:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2091:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(sec_key) {
2092:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = SET_WiFi_SecKey((char*)sec_key);
2093:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS)
2094:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         return WiFi_SecKey_ERROR;
2095:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
2096:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  
2097:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set the SSID : AT+S.SSIDTXT=<SSID>*/    
2098:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(ssid)
2099:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = SET_SSID((char*)ssid);
2100:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   else 
2101:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /* default SSID : AT+S.SSIDTXT=SPWF_STA*/
2102:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = SET_SSID(WiFi_Config_Variables.wifi_ssid);
2103:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2104:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    if(status != WiFi_MODULE_SUCCESS)
2105:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_SSID_ERROR;
2106:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2107:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(CONSOLE_UART_ENABLED)
2108:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    
2109:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04
2110:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    /*AT+S.WIFI=0<cr>*/  
2111:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_WIFI_ENABLE, 0);  
2112:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
2113:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
2114:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
2115:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
2116:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status;
2117:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     else IO_status_flag.radio_off = WIFI_TRUE;
2118:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 82


2119:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_WIND_State != WiFiPowerDown);//Till +WIND:38:WiFi Powered Down arrives
2120:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2121:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2122:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    /* Set the network privacy mode : AT+S.SCFG=wifi_priv_mode,2*/ 
2123:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    status = SET_Configuration_Value(WIFI_PRIV_MODE, priv_mode);
2124:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    if(status != WiFi_MODULE_SUCCESS)
2125:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
2126:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2127:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    /* Set the network mode (1 = STA, 2 = IBSS, 3 = MiniAP) :: AT+S.SCFG=wifi_mode,1*/  
2128:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    status = SET_Configuration_Value(WIFI_MODE, WiFi_STA_MODE);
2129:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    if(status != WiFi_MODULE_SUCCESS)
2130:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
2131:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2132:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04
2133:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*AT+S.WIFI=1<cr>*/  
2134:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_WIFI_ENABLE, 1);  
2135:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
2136:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
2137:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
2138:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
2139:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status;
2140:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     else IO_status_flag.radio_off = WIFI_TRUE;
2141:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
2142:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_Enabled != WIFI_TRUE);//Till Hardware Started arrives
2143:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2144:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Save the settings on the flash memory : AT&W*/ 
2145:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Save_Current_Setting();
2146:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2147:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   SET_Power_State(PowerSave_State);
2148:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2149:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2150:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2151:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2152:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    /* Set radio OFF */
2153:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();  
2154:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.WIFI=%d", 0);  
2155:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2156:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
2157:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS) return status;
2158:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_WIND_State!= WiFiPowerDown);//Till +WIND:38:WiFi Powered Down arrives
2159:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2160:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(sec_key) {
2161:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = SET_WiFi_SecKey((char*)sec_key);
2162:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS)
2163:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         return WiFi_SecKey_ERROR;
2164:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
2165:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****  
2166:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set the SSID : AT+S.SSIDTXT=<SSID>*/    
2167:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(ssid)
2168:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = SET_SSID((char*)ssid);
2169:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   else 
2170:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /* default SSID : AT+S.SSIDTXT=SPWF_STA*/
2171:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = SET_SSID(WiFi_Config_Variables.wifi_ssid);
2172:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2173:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
2174:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    return WiFi_SSID_ERROR;
2175:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 83


2176:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    /* Set the network privacy mode : AT+S.SCFG=wifi_priv_mode,2 */  
2177:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = SET_Configuration_Value(WIFI_PRIV_MODE, priv_mode);
2178:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS) return status;
2179:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2180:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set wifi_mode to STA */  
2181:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = SET_Configuration_Value(WIFI_MODE, WiFi_STA_MODE);
2182:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS) return status;
2183:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2184:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set radio ON */  
2185:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();  
2186:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.WIFI=%d", 1);  
2187:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2188:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
2189:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS) return status;
2190:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_Enabled != WIFI_TRUE);//Till Hardware Started arrives
2191:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2192:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2193:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2194:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Control_Variables.WiFi_Configuration_Done = WIFI_TRUE;  
2195:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Control_Variables.AT_Cmd_Ongoing = WIFI_FALSE;
2196:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2197:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status; 
2198:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 2241              		.loc 1 2198 0
 2242 000e 2046     		mov	r0, r4
 2243 0010 38BD     		pop	{r3, r4, r5, pc}
 2244              	.LVL257:
 2245              	.L224:
 2246 0012 1546     		mov	r5, r2
 2247 0014 0446     		mov	r4, r0
2085:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Control_Variables.AT_Cmd_Ongoing = WIFI_TRUE;
 2248              		.loc 1 2085 0
 2249 0016 1A4A     		ldr	r2, .L228
 2250              	.LVL258:
 2251 0018 43F00403 		orr	r3, r3, #4
 2252 001c 5370     		strb	r3, [r2, #1]
2091:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = SET_WiFi_SecKey((char*)sec_key);
 2253              		.loc 1 2091 0
 2254 001e 29B1     		cbz	r1, .L215
2092:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS)
 2255              		.loc 1 2092 0
 2256 0020 0846     		mov	r0, r1
 2257              	.LVL259:
 2258 0022 FFF7FEFF 		bl	SET_WiFi_SecKey
 2259              	.LVL260:
2093:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         return WiFi_SecKey_ERROR;
 2260              		.loc 1 2093 0
 2261 0026 08B1     		cbz	r0, .L215
2094:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 2262              		.loc 1 2094 0
 2263 0028 0924     		movs	r4, #9
 2264              	.LVL261:
 2265 002a F0E7     		b	.L214
 2266              	.LVL262:
 2267              	.L215:
2098:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = SET_SSID((char*)ssid);
 2268              		.loc 1 2098 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 84


 2269 002c 2CB1     		cbz	r4, .L216
2099:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   else 
 2270              		.loc 1 2099 0
 2271 002e 2046     		mov	r0, r4
 2272 0030 FFF7FEFF 		bl	SET_SSID
 2273              	.LVL263:
 2274              	.L217:
2104:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_SSID_ERROR;
 2275              		.loc 1 2104 0
 2276 0034 30B1     		cbz	r0, .L225
2105:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 2277              		.loc 1 2105 0
 2278 0036 0824     		movs	r4, #8
 2279              	.LVL264:
 2280 0038 E9E7     		b	.L214
 2281              	.LVL265:
 2282              	.L216:
2102:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 2283              		.loc 1 2102 0
 2284 003a 124B     		ldr	r3, .L228+4
 2285 003c 5868     		ldr	r0, [r3, #4]
 2286 003e FFF7FEFF 		bl	SET_SSID
 2287              	.LVL266:
 2288 0042 F7E7     		b	.L217
 2289              	.L225:
2123:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    if(status != WiFi_MODULE_SUCCESS)
 2290              		.loc 1 2123 0
 2291 0044 2946     		mov	r1, r5
 2292 0046 1048     		ldr	r0, .L228+8
 2293              	.LVL267:
 2294 0048 FFF7FEFF 		bl	SET_Configuration_Value
 2295              	.LVL268:
2124:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
 2296              		.loc 1 2124 0
 2297 004c 08B1     		cbz	r0, .L226
2125:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 2298              		.loc 1 2125 0
 2299 004e 0A24     		movs	r4, #10
 2300              	.LVL269:
 2301 0050 DDE7     		b	.L214
 2302              	.LVL270:
 2303              	.L226:
2128:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    if(status != WiFi_MODULE_SUCCESS)
 2304              		.loc 1 2128 0
 2305 0052 0121     		movs	r1, #1
 2306 0054 0D48     		ldr	r0, .L228+12
 2307              	.LVL271:
 2308 0056 FFF7FEFF 		bl	SET_Configuration_Value
 2309              	.LVL272:
2129:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
 2310              		.loc 1 2129 0
 2311 005a 0446     		mov	r4, r0
 2312              	.LVL273:
 2313 005c 08B1     		cbz	r0, .L227
2130:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 2314              		.loc 1 2130 0
 2315 005e 0A24     		movs	r4, #10
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 85


 2316 0060 D5E7     		b	.L214
 2317              	.L227:
2145:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 2318              		.loc 1 2145 0
 2319 0062 FFF7FEFF 		bl	Save_Current_Setting
 2320              	.LVL274:
2147:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
 2321              		.loc 1 2147 0
 2322 0066 0120     		movs	r0, #1
 2323 0068 FFF7FEFF 		bl	SET_Power_State
 2324              	.LVL275:
2194:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Control_Variables.AT_Cmd_Ongoing = WIFI_FALSE;
 2325              		.loc 1 2194 0
 2326 006c 044B     		ldr	r3, .L228
 2327 006e 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 2328 0070 42F00402 		orr	r2, r2, #4
 2329 0074 1A70     		strb	r2, [r3]
2195:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 2330              		.loc 1 2195 0
 2331 0076 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 2332 0078 6FF38202 		bfc	r2, #2, #1
 2333 007c 5A70     		strb	r2, [r3, #1]
2197:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 2334              		.loc 1 2197 0
 2335 007e C6E7     		b	.L214
 2336              	.L229:
 2337              		.align	2
 2338              	.L228:
 2339 0080 00000000 		.word	WiFi_Control_Variables
 2340 0084 00000000 		.word	WiFi_Config_Variables
 2341 0088 00000000 		.word	.LC13
 2342 008c 10000000 		.word	.LC14
 2343              		.cfi_endproc
 2344              	.LFE303:
 2346              		.section	.text.wifi_adhoc_create,"ax",%progbits
 2347              		.align	1
 2348              		.global	wifi_adhoc_create
 2349              		.syntax unified
 2350              		.thumb
 2351              		.thumb_func
 2352              		.fpu fpv4-sp-d16
 2354              	wifi_adhoc_create:
 2355              	.LFB304:
2199:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2200:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
2201:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  SET_WiFi_IBSS_Mode
2202:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Configure Wi-Fi module in IBSS mode
2203:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  SSID     : SSID name
2204:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  priv_mode : network privecy mode
2205:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : status of AT cmd
2206:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
2207:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_adhoc_create(uint8_t * ssid, WiFi_Priv_Mode priv_mode)
2208:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 2356              		.loc 1 2208 0
 2357              		.cfi_startproc
 2358              		@ args = 0, pretend = 0, frame = 0
 2359              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 86


 2360              	.LVL276:
 2361 0000 10B5     		push	{r4, lr}
 2362              	.LCFI41:
 2363              		.cfi_def_cfa_offset 8
 2364              		.cfi_offset 4, -8
 2365              		.cfi_offset 14, -4
 2366 0002 0C46     		mov	r4, r1
 2367              	.LVL277:
2209:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
2210:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2211:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set the SSID : AT+S.SSIDTXT=<SSID>*/    
2212:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = SET_SSID((char*)ssid);  
 2368              		.loc 1 2212 0
 2369 0004 FFF7FEFF 		bl	SET_SSID
 2370              	.LVL278:
2213:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
 2371              		.loc 1 2213 0
 2372 0008 10B1     		cbz	r0, .L240
2214:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_SSID_ERROR;
 2373              		.loc 1 2214 0
 2374 000a 0824     		movs	r4, #8
 2375              	.LVL279:
 2376              	.L231:
2215:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2216:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #ifdef SPWF04
2217:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /*AT+S.WIFI=0<cr>*/
2218:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,AT_WIFI_ENABLE, 0);
2219:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2220:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #ifdef CONSOLE_UART_ENABLED
2221:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
2222:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status == WiFi_MODULE_SUCCESS)
2223:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
2224:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = USART_Receive_AT_Resp( );
2225:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
2226:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         else IO_status_flag.radio_off = WIFI_TRUE;
2227:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
2228:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #else
2229:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2230:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Receive_AT_Resp( );
2231:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;  
2232:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif //end of CONSOLE_UART_ENABLED
2233:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     while(IO_status_flag.WiFi_WIND_State!= WiFiPowerDown);//Till +WIND:38:WiFi Powered Down arrives
2234:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif // end of SPWF04
2235:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2236:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set the network privacy mode : AT+S.SCFG=wifi_priv_mode,0*/ 
2237:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = SET_Configuration_Value(WIFI_PRIV_MODE, priv_mode);
2238:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
2239:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;  
2240:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2241:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set the network mode (1 = STA, 2 = IBSS, 3 = MiniAP) :: AT+S.SCFG=wifi_mode,2*/  
2242:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = SET_Configuration_Value(WIFI_MODE, WiFi_IBSS_MODE);
2243:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
2244:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
2245:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2246:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set IP address */
2247:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = SET_Configuration_Addr(WIFI_IP_ADDRESS, WIFI_IBSS_IP_ADDR);
2248:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 87


2249:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
2250:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2251:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set IP default gateway */
2252:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = SET_Configuration_Addr(WIFI_IP_DEFAULT_GATEWAY, WIFI_IBSS_DEFAULT_GATEWAY);
2253:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
2254:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;  
2255:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2256:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set IP DNS */
2257:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #ifdef SPWF04
2258:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = SET_Configuration_Addr(WIFI_IP_DNS1, WIFI_IBSS_IP_DNS_ADDR);
2259:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #else
2260:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = SET_Configuration_Addr(WIFI_IP_DNS, WIFI_IBSS_IP_DNS_ADDR);
2261:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
2262:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
2263:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
2264:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2265:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set IP netmask */
2266:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = SET_Configuration_Addr(WIFI_IP_NETMASK, WIFI_IBSS_IP_MASK);
2267:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
2268:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
2269:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2270:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Turn OFF the DHCP */
2271:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   SET_Configuration_Value(IP_USE_DHCP_SERVER, WIFI_IP_USE_DHCP);   
2272:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
2273:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
2274:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2275:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #ifdef SPWF04  
2276:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /*AT+S.WIFI=1<cr>*/  
2277:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,AT_WIFI_ENABLE, 1);
2278:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2279:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #ifdef CONSOLE_UART_ENABLED
2280:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
2281:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status == WiFi_MODULE_SUCCESS)
2282:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
2283:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = USART_Receive_AT_Resp( );
2284:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
2285:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         else IO_status_flag.radio_off = WIFI_TRUE;
2286:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
2287:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #else
2288:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2289:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Receive_AT_Resp( );
2290:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;
2291:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif //end of CONSOLE_UART_ENABLED
2292:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     while(IO_status_flag.WiFi_Enabled != WIFI_TRUE);//Till Hardware Started arrives
2293:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif  //end of SPWF04  
2294:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2295:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Save the settings on the flash memory : AT&W*/ 
2296:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Save_Current_Setting();
2297:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2298:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Soft reset the module */
2299:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #ifdef SPWF04
2300:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Soft_Reset();
2301:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #else
2302:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     SET_Power_State(PowerSave_State);   
2303:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
2304:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2305:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 88


2306:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 2377              		.loc 1 2306 0
 2378 000c 2046     		mov	r0, r4
 2379 000e 10BD     		pop	{r4, pc}
 2380              	.LVL280:
 2381              	.L240:
2237:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
 2382              		.loc 1 2237 0
 2383 0010 2146     		mov	r1, r4
 2384 0012 1A48     		ldr	r0, .L246
 2385              	.LVL281:
 2386 0014 FFF7FEFF 		bl	SET_Configuration_Value
 2387              	.LVL282:
2238:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;  
 2388              		.loc 1 2238 0
 2389 0018 08B1     		cbz	r0, .L241
2239:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 2390              		.loc 1 2239 0
 2391 001a 0A24     		movs	r4, #10
 2392 001c F6E7     		b	.L231
 2393              	.L241:
2242:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
 2394              		.loc 1 2242 0
 2395 001e 0221     		movs	r1, #2
 2396 0020 1748     		ldr	r0, .L246+4
 2397              	.LVL283:
 2398 0022 FFF7FEFF 		bl	SET_Configuration_Value
 2399              	.LVL284:
2243:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
 2400              		.loc 1 2243 0
 2401 0026 08B1     		cbz	r0, .L242
2244:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 2402              		.loc 1 2244 0
 2403 0028 0A24     		movs	r4, #10
 2404 002a EFE7     		b	.L231
 2405              	.L242:
2247:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
 2406              		.loc 1 2247 0
 2407 002c 1549     		ldr	r1, .L246+8
 2408 002e 1648     		ldr	r0, .L246+12
 2409              	.LVL285:
 2410 0030 FFF7FEFF 		bl	SET_Configuration_Addr
 2411              	.LVL286:
2248:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
 2412              		.loc 1 2248 0
 2413 0034 08B1     		cbz	r0, .L243
2249:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 2414              		.loc 1 2249 0
 2415 0036 0A24     		movs	r4, #10
 2416 0038 E8E7     		b	.L231
 2417              	.L243:
2252:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
 2418              		.loc 1 2252 0
 2419 003a 1449     		ldr	r1, .L246+16
 2420 003c 1448     		ldr	r0, .L246+20
 2421              	.LVL287:
 2422 003e FFF7FEFF 		bl	SET_Configuration_Addr
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 89


 2423              	.LVL288:
2253:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;  
 2424              		.loc 1 2253 0
 2425 0042 08B1     		cbz	r0, .L244
2254:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
 2426              		.loc 1 2254 0
 2427 0044 0A24     		movs	r4, #10
 2428 0046 E1E7     		b	.L231
 2429              	.L244:
2260:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
 2430              		.loc 1 2260 0
 2431 0048 1049     		ldr	r1, .L246+16
 2432 004a 1248     		ldr	r0, .L246+24
 2433              	.LVL289:
 2434 004c FFF7FEFF 		bl	SET_Configuration_Addr
 2435              	.LVL290:
2262:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
 2436              		.loc 1 2262 0
 2437 0050 08B1     		cbz	r0, .L245
2263:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 2438              		.loc 1 2263 0
 2439 0052 0A24     		movs	r4, #10
 2440 0054 DAE7     		b	.L231
 2441              	.L245:
2266:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
 2442              		.loc 1 2266 0
 2443 0056 1049     		ldr	r1, .L246+28
 2444 0058 1048     		ldr	r0, .L246+32
 2445              	.LVL291:
 2446 005a FFF7FEFF 		bl	SET_Configuration_Addr
 2447              	.LVL292:
2267:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_CONFIG_ERROR;
 2448              		.loc 1 2267 0
 2449 005e 0446     		mov	r4, r0
 2450 0060 48B9     		cbnz	r0, .L238
2271:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS)
 2451              		.loc 1 2271 0
 2452 0062 0021     		movs	r1, #0
 2453 0064 0E48     		ldr	r0, .L246+36
 2454              	.LVL293:
 2455 0066 FFF7FEFF 		bl	SET_Configuration_Value
 2456              	.LVL294:
2296:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 2457              		.loc 1 2296 0
 2458 006a FFF7FEFF 		bl	Save_Current_Setting
 2459              	.LVL295:
2302:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
 2460              		.loc 1 2302 0
 2461 006e 0120     		movs	r0, #1
 2462 0070 FFF7FEFF 		bl	SET_Power_State
 2463              	.LVL296:
2305:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 2464              		.loc 1 2305 0
 2465 0074 CAE7     		b	.L231
 2466              	.LVL297:
 2467              	.L238:
2268:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 90


 2468              		.loc 1 2268 0
 2469 0076 0A24     		movs	r4, #10
 2470 0078 C8E7     		b	.L231
 2471              	.L247:
 2472 007a 00BF     		.align	2
 2473              	.L246:
 2474 007c 00000000 		.word	.LC13
 2475 0080 10000000 		.word	.LC14
 2476 0084 00000000 		.word	.LC16
 2477 0088 10000000 		.word	.LC17
 2478 008c 1C000000 		.word	.LC18
 2479 0090 28000000 		.word	.LC19
 2480 0094 30000000 		.word	.LC20
 2481 0098 38000000 		.word	.LC21
 2482 009c 48000000 		.word	.LC22
 2483 00a0 54000000 		.word	.LC23
 2484              		.cfi_endproc
 2485              	.LFE304:
 2487              		.section	.text.wifi_standby,"ax",%progbits
 2488              		.align	1
 2489              		.global	wifi_standby
 2490              		.syntax unified
 2491              		.thumb
 2492              		.thumb_func
 2493              		.fpu fpv4-sp-d16
 2495              	wifi_standby:
 2496              	.LFB305:
2307:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2308:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
2309:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_standby
2310:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Configured WiFi module to enter standby
2311:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  arg_standby_time: standby time (in seconds)
2312:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : status of AT cmd
2313:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
2314:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_standby(uint8_t arg_standby_time)
2315:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 2497              		.loc 1 2315 0
 2498              		.cfi_startproc
 2499              		@ args = 0, pretend = 0, frame = 0
 2500              		@ frame_needed = 0, uses_anonymous_args = 0
 2501              	.LVL298:
 2502 0000 10B5     		push	{r4, lr}
 2503              	.LCFI42:
 2504              		.cfi_def_cfa_offset 8
 2505              		.cfi_offset 4, -8
 2506              		.cfi_offset 14, -4
 2507 0002 0446     		mov	r4, r0
 2508              	.LVL299:
2316:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*
2317:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   For SPWF01:
2318:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   For Standby, the presence of Jumpers on JP4 and JP3 has the following behaviour:
2319:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   JP3 (middle and bottom): prevents standby and immediately wakes-up module
2320:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   JP3 (middle and top): no effect on standby
2321:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   JP4 (middle and right): prevents wakeup and standby runs forever
2322:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   JP4 (middle and left): no effect on standby
2323:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   */
2324:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 91


2325:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
2326:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2327:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*if(arg_standby_time<2)
2328:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_NOT_SUPPORTED;*/
2329:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
2330:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   SET_Configuration_Value(WIFI_SLEEP_ENABLED, 0);  
 2509              		.loc 1 2330 0
 2510 0004 0021     		movs	r1, #0
 2511 0006 1248     		ldr	r0, .L251
 2512              	.LVL300:
 2513 0008 FFF7FEFF 		bl	SET_Configuration_Value
 2514              	.LVL301:
2331:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   SET_Configuration_Value(WIFI_STANDBY_ENABLED, 1);  
 2515              		.loc 1 2331 0
 2516 000c 0121     		movs	r1, #1
 2517 000e 1148     		ldr	r0, .L251+4
 2518 0010 FFF7FEFF 		bl	SET_Configuration_Value
 2519              	.LVL302:
2332:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = SET_Configuration_Value(WIFI_STANDBY_TIME, arg_standby_time);  
 2520              		.loc 1 2332 0
 2521 0014 2146     		mov	r1, r4
 2522 0016 1048     		ldr	r0, .L251+8
 2523 0018 FFF7FEFF 		bl	SET_Configuration_Value
 2524              	.LVL303:
2333:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2334:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF01  
2335:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* save current setting in flash */
2336:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Save_Current_Setting();
 2525              		.loc 1 2336 0
 2526 001c FFF7FEFF 		bl	Save_Current_Setting
 2527              	.LVL304:
2337:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2338:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2339:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Soft reset the module/ Set the PMS mode */
2340:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04  
2341:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef CONSOLE_UART_ENABLED
2342:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.PMS=%d\r",3);//3->standby
2343:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
2344:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2345:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.PMS=%d",3);//3->standby
2346:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);  
2347:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif  
2348:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(WiFi_Control_Variables.in_standby_mode != WIFI_TRUE);//Till WIND:67 arrives
2349:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
2350:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else //if SPWF01
2351:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_SET_POWER_STATE,1);//cfun=1->simple reset (SPWF01)
 2528              		.loc 1 2351 0
 2529 0020 0E4C     		ldr	r4, .L251+12
 2530 0022 0122     		movs	r2, #1
 2531 0024 0E49     		ldr	r1, .L251+16
 2532 0026 2046     		mov	r0, r4
 2533 0028 FFF7FEFF 		bl	sprintf
 2534              	.LVL305:
2352:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 2535              		.loc 1 2352 0
 2536 002c 2046     		mov	r0, r4
 2537 002e FFF7FEFF 		bl	strlen
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 92


 2538              	.LVL306:
 2539 0032 80B2     		uxth	r0, r0
 2540 0034 FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 2541              	.LVL307:
2353:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   IO_status_flag.WiFi_Enabled=WIFI_FALSE;
 2542              		.loc 1 2353 0
 2543 0038 0A4A     		ldr	r2, .L251+20
 2544 003a 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 2545 003c 6FF30413 		bfc	r3, #4, #1
 2546 0040 1370     		strb	r3, [r2]
 2547              	.L249:
2354:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_Enabled != WIFI_TRUE);//Till Hardware Started arrives
 2548              		.loc 1 2354 0 discriminator 1
 2549 0042 084B     		ldr	r3, .L251+20
 2550 0044 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2551 0046 13F0100F 		tst	r3, #16
 2552 004a FAD0     		beq	.L249
2355:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
2356:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2357:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 2553              		.loc 1 2357 0
 2554 004c 10BD     		pop	{r4, pc}
 2555              	.L252:
 2556 004e 00BF     		.align	2
 2557              	.L251:
 2558 0050 00000000 		.word	.LC24
 2559 0054 10000000 		.word	.LC25
 2560 0058 20000000 		.word	.LC26
 2561 005c 00000000 		.word	WiFi_AT_Cmd_Buff
 2562 0060 30000000 		.word	.LC27
 2563 0064 00000000 		.word	IO_status_flag
 2564              		.cfi_endproc
 2565              	.LFE305:
 2567              		.section	.text.wifi_wakeup,"ax",%progbits
 2568              		.align	1
 2569              		.global	wifi_wakeup
 2570              		.syntax unified
 2571              		.thumb
 2572              		.thumb_func
 2573              		.fpu fpv4-sp-d16
 2575              	wifi_wakeup:
 2576              	.LFB306:
2358:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2359:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04
2360:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
2361:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_sleep
2362:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Configured WiFi module to enter sleep mode
2363:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Needs to be woken up by wifi_wakeup()
2364:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  None
2365:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : status of AT cmd
2366:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
2367:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_powersave(power_mode mode)
2368:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
2369:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
2370:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2371:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef CONSOLE_UART_ENABLED
2372:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.PMS=%d\r",mode);
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 93


2373:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
2374:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2375:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.PMS=%d",mode);
2376:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);  
2377:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2378:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2379:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(mode==wifi_sleep)
2380:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
2381:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Control_Variables.Deep_Sleep_Enabled = WIFI_FALSE; 
2382:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     while(WiFi_Control_Variables.Deep_Sleep_Enabled != WIFI_TRUE);//Till WIND:69 arrives    
2383:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
2384:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   else if(mode==wifi_reactive)
2385:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
2386:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Control_Variables.LowPowerMode_Enabled = WIFI_FALSE;
2387:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     while(WiFi_Control_Variables.LowPowerMode_Enabled != WIFI_TRUE);//Till WIND:66 arrives
2388:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
2389:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   else if(mode==wifi_active)
2390:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
2391:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.WiFi_Enabled=WIFI_FALSE;
2392:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     while(IO_status_flag.WiFi_Enabled != WIFI_TRUE);//Till Hardware Started arrives
2393:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
2394:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
2395:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2396:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
2397:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2398:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2399:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
2400:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_wakeup
2401:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         wakeup the module from sleep by setting the GPIO6 through PC13
2402:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         or allow it to go to sleep
2403:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Jumper needed on JP4
2404:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  wakeup wakeup (WIFI_TRUE) or allow sleep(WIFI_FALSE)
2405:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : status of function call 
2406:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
2407:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_wakeup(wifi_bool wakeup)
2408:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 2577              		.loc 1 2408 0
 2578              		.cfi_startproc
 2579              		@ args = 0, pretend = 0, frame = 24
 2580              		@ frame_needed = 0, uses_anonymous_args = 0
 2581              	.LVL308:
 2582 0000 10B5     		push	{r4, lr}
 2583              	.LCFI43:
 2584              		.cfi_def_cfa_offset 8
 2585              		.cfi_offset 4, -8
 2586              		.cfi_offset 14, -4
 2587 0002 86B0     		sub	sp, sp, #24
 2588              	.LCFI44:
 2589              		.cfi_def_cfa_offset 32
 2590 0004 0446     		mov	r4, r0
 2591              	.LVL309:
 2592              	.LBB27:
2409:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;    
2410:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2411:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   GPIO_InitTypeDef  WAKEUP_InitStruct;
2412:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   RESET_WAKEUP_GPIO_CLK_ENABLE();
 2593              		.loc 1 2412 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 94


 2594 0006 0021     		movs	r1, #0
 2595 0008 0091     		str	r1, [sp]
 2596 000a 134B     		ldr	r3, .L258
 2597 000c 1A6B     		ldr	r2, [r3, #48]
 2598 000e 42F00402 		orr	r2, r2, #4
 2599 0012 1A63     		str	r2, [r3, #48]
 2600 0014 1B6B     		ldr	r3, [r3, #48]
 2601 0016 03F00403 		and	r3, r3, #4
 2602 001a 0093     		str	r3, [sp]
 2603 001c 009B     		ldr	r3, [sp]
 2604              	.LBE27:
2413:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2414:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WAKEUP_InitStruct.Pin       = WiFi_WAKEUP_GPIO_PIN;
 2605              		.loc 1 2414 0
 2606 001e 4FF48073 		mov	r3, #256
 2607 0022 0193     		str	r3, [sp, #4]
2415:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WAKEUP_InitStruct.Mode      = GPIO_MODE_OUTPUT_PP;
 2608              		.loc 1 2415 0
 2609 0024 0123     		movs	r3, #1
 2610 0026 0293     		str	r3, [sp, #8]
2416:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WAKEUP_InitStruct.Pull      = GPIO_NOPULL;
 2611              		.loc 1 2416 0
 2612 0028 0391     		str	r1, [sp, #12]
2417:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WAKEUP_InitStruct.Speed     = GPIO_SPEED_HIGH;
 2613              		.loc 1 2417 0
 2614 002a 0323     		movs	r3, #3
 2615 002c 0493     		str	r3, [sp, #16]
2418:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2419:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   HAL_GPIO_Init(WiFi_WAKEUP_GPIO_PORT, &WAKEUP_InitStruct);;
 2616              		.loc 1 2419 0
 2617 002e 01A9     		add	r1, sp, #4
 2618 0030 0A48     		ldr	r0, .L258+4
 2619              	.LVL310:
 2620 0032 FFF7FEFF 		bl	HAL_GPIO_Init
 2621              	.LVL311:
2420:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2421:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(wakeup)
 2622              		.loc 1 2421 0
 2623 0036 44B9     		cbnz	r4, .L257
2422:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     HAL_GPIO_WritePin(WiFi_WAKEUP_GPIO_PORT, WiFi_WAKEUP_GPIO_PIN, GPIO_PIN_SET);
2423:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   else
2424:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     HAL_GPIO_WritePin(WiFi_WAKEUP_GPIO_PORT, WiFi_WAKEUP_GPIO_PIN, GPIO_PIN_RESET);
 2624              		.loc 1 2424 0
 2625 0038 0022     		movs	r2, #0
 2626 003a 4FF48071 		mov	r1, #256
 2627 003e 0748     		ldr	r0, .L258+4
 2628 0040 FFF7FEFF 		bl	HAL_GPIO_WritePin
 2629              	.LVL312:
 2630              	.L255:
2425:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2426:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
2427:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 2631              		.loc 1 2427 0
 2632 0044 0020     		movs	r0, #0
 2633 0046 06B0     		add	sp, sp, #24
 2634              	.LCFI45:
 2635              		.cfi_remember_state
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 95


 2636              		.cfi_def_cfa_offset 8
 2637              		@ sp needed
 2638 0048 10BD     		pop	{r4, pc}
 2639              	.L257:
 2640              	.LCFI46:
 2641              		.cfi_restore_state
2422:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     HAL_GPIO_WritePin(WiFi_WAKEUP_GPIO_PORT, WiFi_WAKEUP_GPIO_PIN, GPIO_PIN_SET);
 2642              		.loc 1 2422 0
 2643 004a 0122     		movs	r2, #1
 2644 004c 4FF48071 		mov	r1, #256
 2645 0050 0248     		ldr	r0, .L258+4
 2646 0052 FFF7FEFF 		bl	HAL_GPIO_WritePin
 2647              	.LVL313:
 2648 0056 F5E7     		b	.L255
 2649              	.L259:
 2650              		.align	2
 2651              	.L258:
 2652 0058 00380240 		.word	1073887232
 2653 005c 00080240 		.word	1073874944
 2654              		.cfi_endproc
 2655              	.LFE306:
 2657              		.section	.text.wifi_init,"ax",%progbits
 2658              		.align	1
 2659              		.global	wifi_init
 2660              		.syntax unified
 2661              		.thumb
 2662              		.thumb_func
 2663              		.fpu fpv4-sp-d16
 2665              	wifi_init:
 2666              	.LFB275:
  82:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
 2667              		.loc 1 82 0
 2668              		.cfi_startproc
 2669              		@ args = 0, pretend = 0, frame = 0
 2670              		@ frame_needed = 0, uses_anonymous_args = 0
 2671              	.LVL314:
 2672 0000 70B5     		push	{r4, r5, r6, lr}
 2673              	.LCFI47:
 2674              		.cfi_def_cfa_offset 16
 2675              		.cfi_offset 4, -16
 2676              		.cfi_offset 5, -12
 2677              		.cfi_offset 6, -8
 2678              		.cfi_offset 14, -4
 2679 0002 0546     		mov	r5, r0
 2680              	.LVL315:
  86:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #if defined(USE_STM32F4XX_NUCLEO)  
 2681              		.loc 1 86 0
 2682 0004 A248     		ldr	r0, .L295
 2683              	.LVL316:
 2684 0006 FFF7FEFF 		bl	printf
 2685              	.LVL317:
  88:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif
 2686              		.loc 1 88 0
 2687 000a A248     		ldr	r0, .L295+4
 2688 000c FFF7FEFF 		bl	puts
 2689              	.LVL318:
 102:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 96


 2690              		.loc 1 102 0
 2691 0010 A148     		ldr	r0, .L295+8
 2692 0012 FFF7FEFF 		bl	puts
 2693              	.LVL319:
 105:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #else
 2694              		.loc 1 105 0
 2695 0016 A148     		ldr	r0, .L295+12
 2696 0018 FFF7FEFF 		bl	puts
 2697              	.LVL320:
 111:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 2698              		.loc 1 111 0
 2699 001c FFF7FEFF 		bl	WiFi_Module_Init
 2700              	.LVL321:
 114:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 2701              		.loc 1 114 0
 2702 0020 0120     		movs	r0, #1
 2703 0022 FFF7FEFF 		bl	wifi_wakeup
 2704              	.LVL322:
 117:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 2705              		.loc 1 117 0
 2706 0026 FFF7FEFF 		bl	wifi_reset
 2707              	.LVL323:
 121:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) 
 2708              		.loc 1 121 0
 2709 002a FFF7FEFF 		bl	Restore_Default_Setting
 2710              	.LVL324:
 122:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         return status;
 2711              		.loc 1 122 0
 2712 002e 0446     		mov	r4, r0
 2713 0030 08B1     		cbz	r0, .L290
 2714              	.LVL325:
 2715              	.L261:
 475:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 2716              		.loc 1 475 0
 2717 0032 2046     		mov	r0, r4
 2718 0034 70BD     		pop	{r4, r5, r6, pc}
 2719              	.LVL326:
 2720              	.L290:
 129:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status; 
 2721              		.loc 1 129 0
 2722 0036 696B     		ldr	r1, [r5, #52]
 2723 0038 9948     		ldr	r0, .L295+16
 2724              	.LVL327:
 2725 003a FFF7FEFF 		bl	SET_Configuration_Value
 2726              	.LVL328:
 130:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         
 2727              		.loc 1 130 0
 2728 003e 0446     		mov	r4, r0
 2729 0040 0028     		cmp	r0, #0
 2730 0042 F6D1     		bne	.L261
 133:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         sprintf((char*)WiFi_AT_Cmd_Buff,AT_SAVE_CURRENT_SETTING);  
 2731              		.loc 1 133 0
 2732 0044 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 2733              	.LVL329:
 134:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 2734              		.loc 1 134 0
 2735 0048 964B     		ldr	r3, .L295+20
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 97


 2736 004a 974A     		ldr	r2, .L295+24
 2737 004c 1068     		ldr	r0, [r2]
 2738 004e 1860     		str	r0, [r3]	@ unaligned
 2739 0050 9288     		ldrh	r2, [r2, #4]	@ unaligned
 2740 0052 9A80     		strh	r2, [r3, #4]	@ unaligned
 135:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status == WiFi_MODULE_SUCCESS)
 2741              		.loc 1 135 0
 2742 0054 1846     		mov	r0, r3
 2743 0056 FFF7FEFF 		bl	strlen
 2744              	.LVL330:
 2745 005a 80B2     		uxth	r0, r0
 2746 005c FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 2747              	.LVL331:
 136:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         {
 2748              		.loc 1 136 0
 2749 0060 20B9     		cbnz	r0, .L262
 138:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 2750              		.loc 1 138 0
 2751 0062 FFF7FEFF 		bl	USART_Receive_AT_Resp
 2752              	.LVL332:
 139:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         } 
 2753              		.loc 1 139 0
 2754 0066 0446     		mov	r4, r0
 2755 0068 0028     		cmp	r0, #0
 2756 006a E2D1     		bne	.L261
 2757              	.L262:
 143:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #endif
 2758              		.loc 1 143 0
 2759 006c FFF7FEFF 		bl	wifi_reset
 2760              	.LVL333:
 150:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       #endif
 2761              		.loc 1 150 0
 2762 0070 0121     		movs	r1, #1
 2763 0072 8E48     		ldr	r0, .L295+28
 2764 0074 FFF7FEFF 		bl	SET_Configuration_Value
 2765              	.LVL334:
 153:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 2766              		.loc 1 153 0
 2767 0078 0446     		mov	r4, r0
 2768 007a 0028     		cmp	r0, #0
 2769 007c D9D1     		bne	.L261
 155:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 2770              		.loc 1 155 0
 2771 007e 296B     		ldr	r1, [r5, #48]
 2772 0080 29B1     		cbz	r1, .L263
 158:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status; 
 2773              		.loc 1 158 0
 2774 0082 8748     		ldr	r0, .L295+16
 2775              	.LVL335:
 2776 0084 FFF7FEFF 		bl	SET_Configuration_Value
 2777              	.LVL336:
 159:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 2778              		.loc 1 159 0
 2779 0088 0446     		mov	r4, r0
 2780 008a 0028     		cmp	r0, #0
 2781 008c D1D1     		bne	.L261
 2782              	.L263:
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 98


 177:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status != WiFi_MODULE_SUCCESS) return status;   
 2783              		.loc 1 177 0
 2784 008e 0021     		movs	r1, #0
 2785 0090 8748     		ldr	r0, .L295+32
 2786              	.LVL337:
 2787 0092 FFF7FEFF 		bl	SET_Configuration_Value
 2788              	.LVL338:
 178:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
 2789              		.loc 1 178 0
 2790 0096 0446     		mov	r4, r0
 2791 0098 0028     		cmp	r0, #0
 2792 009a CAD1     		bne	.L261
 180:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 2793              		.loc 1 180 0
 2794 009c 2B78     		ldrb	r3, [r5]	@ zero_extendqisi2
 2795 009e 002B     		cmp	r3, #0
 2796 00a0 00F0BA80 		beq	.L265
 2797 00a4 012B     		cmp	r3, #1
 2798 00a6 00F0C880 		beq	.L266
 2799              	.L264:
 198:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 2800              		.loc 1 198 0
 2801 00aa 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 2802 00ac 012B     		cmp	r3, #1
 2803 00ae 00F02781 		beq	.L268
 2804 00b2 002B     		cmp	r3, #0
 2805 00b4 00F0D280 		beq	.L269
 2806 00b8 022B     		cmp	r3, #2
 2807 00ba 00F05281 		beq	.L270
 2808              	.L267:
 240:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 2809              		.loc 1 240 0
 2810 00be AB78     		ldrb	r3, [r5, #2]	@ zero_extendqisi2
 2811 00c0 032B     		cmp	r3, #3
 2812 00c2 40F27F81 		bls	.L291
 2813              	.L271:
 253:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 2814              		.loc 1 253 0
 2815 00c6 E978     		ldrb	r1, [r5, #3]	@ zero_extendqisi2
 2816 00c8 0229     		cmp	r1, #2
 2817 00ca 40F28681 		bls	.L292
 2818              	.L273:
 266:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 2819              		.loc 1 266 0
 2820 00ce 6968     		ldr	r1, [r5, #4]
 2821 00d0 29B1     		cbz	r1, .L275
 268:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 2822              		.loc 1 268 0
 2823 00d2 7848     		ldr	r0, .L295+36
 2824              	.LVL339:
 2825 00d4 FFF7FEFF 		bl	SET_Configuration_Addr
 2826              	.LVL340:
 269:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 2827              		.loc 1 269 0
 2828 00d8 0446     		mov	r4, r0
 2829 00da 0028     		cmp	r0, #0
 2830 00dc A9D1     		bne	.L261
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 99


 2831              	.L275:
 272:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 2832              		.loc 1 272 0
 2833 00de A968     		ldr	r1, [r5, #8]
 2834 00e0 29B1     		cbz	r1, .L276
 274:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 2835              		.loc 1 274 0
 2836 00e2 7548     		ldr	r0, .L295+40
 2837              	.LVL341:
 2838 00e4 FFF7FEFF 		bl	SET_Configuration_Addr
 2839              	.LVL342:
 275:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 2840              		.loc 1 275 0
 2841 00e8 0446     		mov	r4, r0
 2842 00ea 0028     		cmp	r0, #0
 2843 00ec A1D1     		bne	.L261
 2844              	.L276:
 278:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 2845              		.loc 1 278 0
 2846 00ee E968     		ldr	r1, [r5, #12]
 2847 00f0 29B1     		cbz	r1, .L277
 280:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 2848              		.loc 1 280 0
 2849 00f2 7248     		ldr	r0, .L295+44
 2850              	.LVL343:
 2851 00f4 FFF7FEFF 		bl	SET_Configuration_Addr
 2852              	.LVL344:
 281:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 2853              		.loc 1 281 0
 2854 00f8 0446     		mov	r4, r0
 2855 00fa 0028     		cmp	r0, #0
 2856 00fc 99D1     		bne	.L261
 2857              	.L277:
 284:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 2858              		.loc 1 284 0
 2859 00fe 2969     		ldr	r1, [r5, #16]
 2860 0100 29B1     		cbz	r1, .L278
 289:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         #endif
 2861              		.loc 1 289 0
 2862 0102 6F48     		ldr	r0, .L295+48
 2863              	.LVL345:
 2864 0104 FFF7FEFF 		bl	SET_Configuration_Addr
 2865              	.LVL346:
 291:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 2866              		.loc 1 291 0
 2867 0108 0446     		mov	r4, r0
 2868 010a 0028     		cmp	r0, #0
 2869 010c 91D1     		bne	.L261
 2870              	.L278:
 294:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 2871              		.loc 1 294 0
 2872 010e 6969     		ldr	r1, [r5, #20]
 2873 0110 29B1     		cbz	r1, .L279
 296:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 2874              		.loc 1 296 0
 2875 0112 6C48     		ldr	r0, .L295+52
 2876              	.LVL347:
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 100


 2877 0114 FFF7FEFF 		bl	SET_Configuration_Addr
 2878              	.LVL348:
 297:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 2879              		.loc 1 297 0
 2880 0118 0446     		mov	r4, r0
 2881 011a 0028     		cmp	r0, #0
 2882 011c 89D1     		bne	.L261
 2883              	.L279:
 300:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 2884              		.loc 1 300 0
 2885 011e E969     		ldr	r1, [r5, #28]
 2886 0120 29B1     		cbz	r1, .L280
 302:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 2887              		.loc 1 302 0
 2888 0122 6948     		ldr	r0, .L295+56
 2889              	.LVL349:
 2890 0124 FFF7FEFF 		bl	SET_Configuration_Addr
 2891              	.LVL350:
 303:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 2892              		.loc 1 303 0
 2893 0128 0446     		mov	r4, r0
 2894 012a 0028     		cmp	r0, #0
 2895 012c 81D1     		bne	.L261
 2896              	.L280:
 306:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 2897              		.loc 1 306 0
 2898 012e 296A     		ldr	r1, [r5, #32]
 2899 0130 31B1     		cbz	r1, .L281
 308:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 2900              		.loc 1 308 0
 2901 0132 6648     		ldr	r0, .L295+60
 2902              	.LVL351:
 2903 0134 FFF7FEFF 		bl	SET_Configuration_Addr
 2904              	.LVL352:
 309:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 2905              		.loc 1 309 0
 2906 0138 0446     		mov	r4, r0
 2907 013a 0028     		cmp	r0, #0
 2908 013c 7FF479AF 		bne	.L261
 2909              	.L281:
 312:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 2910              		.loc 1 312 0
 2911 0140 6B6A     		ldr	r3, [r5, #36]
 2912 0142 002B     		cmp	r3, #0
 2913 0144 40F05181 		bne	.L293
 2914              	.L282:
 317:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 2915              		.loc 1 317 0
 2916 0148 A96A     		ldr	r1, [r5, #40]
 2917 014a 0029     		cmp	r1, #0
 2918 014c 40F05981 		bne	.L294
 2919              	.L283:
 322:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 2920              		.loc 1 322 0
 2921 0150 95F82C10 		ldrb	r1, [r5, #44]	@ zero_extendqisi2
 2922 0154 31B1     		cbz	r1, .L284
 324:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 101


 2923              		.loc 1 324 0
 2924 0156 5E48     		ldr	r0, .L295+64
 2925              	.LVL353:
 2926 0158 FFF7FEFF 		bl	SET_Configuration_Value
 2927              	.LVL354:
 325:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }   
 2928              		.loc 1 325 0
 2929 015c 0446     		mov	r4, r0
 2930 015e 0028     		cmp	r0, #0
 2931 0160 7FF467AF 		bne	.L261
 2932              	.L284:
 329:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         sprintf((char*)WiFi_AT_Cmd_Buff,AT_HTTPD, config->web_server);  
 2933              		.loc 1 329 0
 2934 0164 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 2935              	.LVL355:
 330:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 2936              		.loc 1 330 0
 2937 0168 4E4C     		ldr	r4, .L295+20
 2938 016a 2A7E     		ldrb	r2, [r5, #24]	@ zero_extendqisi2
 2939 016c 5949     		ldr	r1, .L295+68
 2940 016e 2046     		mov	r0, r4
 2941 0170 FFF7FEFF 		bl	sprintf
 2942              	.LVL356:
 331:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status == WiFi_MODULE_SUCCESS)
 2943              		.loc 1 331 0
 2944 0174 2046     		mov	r0, r4
 2945 0176 FFF7FEFF 		bl	strlen
 2946              	.LVL357:
 2947 017a 80B2     		uxth	r0, r0
 2948 017c FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 2949              	.LVL358:
 332:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         {
 2950              		.loc 1 332 0
 2951 0180 28B9     		cbnz	r0, .L285
 334:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 2952              		.loc 1 334 0
 2953 0182 FFF7FEFF 		bl	USART_Receive_AT_Resp
 2954              	.LVL359:
 335:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         }  
 2955              		.loc 1 335 0
 2956 0186 0446     		mov	r4, r0
 2957 0188 0028     		cmp	r0, #0
 2958 018a 7FF452AF 		bne	.L261
 2959              	.L285:
 367:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.TLSCERT2=clean,all\r");        
 2960              		.loc 1 367 0
 2961 018e FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 2962              	.LVL360:
 368:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 2963              		.loc 1 368 0
 2964 0192 444E     		ldr	r6, .L295+20
 2965 0194 504C     		ldr	r4, .L295+72
 2966 0196 0FCC     		ldmia	r4!, {r0, r1, r2, r3}
 2967 0198 3060     		str	r0, [r6]	@ unaligned
 2968 019a 7160     		str	r1, [r6, #4]	@ unaligned
 2969 019c B260     		str	r2, [r6, #8]	@ unaligned
 2970 019e F360     		str	r3, [r6, #12]	@ unaligned
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 102


 2971 01a0 03CC     		ldmia	r4!, {r0, r1}
 2972 01a2 3061     		str	r0, [r6, #16]	@ unaligned
 2973 01a4 7161     		str	r1, [r6, #20]	@ unaligned
 2974 01a6 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 2975 01a8 3376     		strb	r3, [r6, #24]
 369:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status == WiFi_MODULE_SUCCESS)
 2976              		.loc 1 369 0
 2977 01aa 3046     		mov	r0, r6
 2978 01ac FFF7FEFF 		bl	strlen
 2979              	.LVL361:
 2980 01b0 80B2     		uxth	r0, r0
 2981 01b2 FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 2982              	.LVL362:
 370:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           {
 2983              		.loc 1 370 0
 2984 01b6 28B9     		cbnz	r0, .L286
 372:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****             if(status != WiFi_MODULE_SUCCESS) return status;
 2985              		.loc 1 372 0
 2986 01b8 FFF7FEFF 		bl	USART_Receive_AT_Resp
 2987              	.LVL363:
 373:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           }
 2988              		.loc 1 373 0
 2989 01bc 0446     		mov	r4, r0
 2990 01be 0028     		cmp	r0, #0
 2991 01c0 7FF437AF 		bne	.L261
 2992              	.L286:
 378:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,AT_SAVE_CURRENT_SETTING);  
 2993              		.loc 1 378 0
 2994 01c4 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 2995              	.LVL364:
 379:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 2996              		.loc 1 379 0
 2997 01c8 364B     		ldr	r3, .L295+20
 2998 01ca 374A     		ldr	r2, .L295+24
 2999 01cc 1068     		ldr	r0, [r2]
 3000 01ce 1860     		str	r0, [r3]	@ unaligned
 3001 01d0 9288     		ldrh	r2, [r2, #4]	@ unaligned
 3002 01d2 9A80     		strh	r2, [r3, #4]	@ unaligned
 380:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if(status == WiFi_MODULE_SUCCESS)
 3003              		.loc 1 380 0
 3004 01d4 1846     		mov	r0, r3
 3005 01d6 FFF7FEFF 		bl	strlen
 3006              	.LVL365:
 3007 01da 80B2     		uxth	r0, r0
 3008 01dc FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 3009              	.LVL366:
 381:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 3010              		.loc 1 381 0
 3011 01e0 0446     		mov	r4, r0
 3012 01e2 28B9     		cbnz	r0, .L287
 383:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 3013              		.loc 1 383 0
 3014 01e4 FFF7FEFF 		bl	USART_Receive_AT_Resp
 3015              	.LVL367:
 384:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }   
 3016              		.loc 1 384 0
 3017 01e8 0446     		mov	r4, r0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 103


 3018 01ea 0028     		cmp	r0, #0
 3019 01ec 7FF421AF 		bne	.L261
 3020              	.L287:
 3021              	.LVL368:
 387:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 3022              		.loc 1 387 0
 3023 01f0 286B     		ldr	r0, [r5, #48]
 3024 01f2 18B1     		cbz	r0, .L288
 389:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         #if defined(SPWF01) 
 3025              		.loc 1 389 0
 3026 01f4 FFF7FEFF 		bl	UART_Configuration
 3027              	.LVL369:
 391:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         #else
 3028              		.loc 1 391 0
 3029 01f8 FFF7FEFF 		bl	Receive_Data
 3030              	.LVL370:
 3031              	.L288:
 400:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 3032              		.loc 1 400 0
 3033 01fc FFF7FEFF 		bl	wifi_reset
 3034              	.LVL371:
 461:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif  //WIFI_USE_VCOM
 3035              		.loc 1 461 0
 3036 0200 0020     		movs	r0, #0
 3037 0202 FFF7FEFF 		bl	wifi_wakeup
 3038              	.LVL372:
 471:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     fflush(stdout);
 3039              		.loc 1 471 0
 3040 0206 3548     		ldr	r0, .L295+76
 3041 0208 FFF7FEFF 		bl	puts
 3042              	.LVL373:
 472:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
 3043              		.loc 1 472 0
 3044 020c 344B     		ldr	r3, .L295+80
 3045 020e 1B68     		ldr	r3, [r3]
 3046 0210 9868     		ldr	r0, [r3, #8]
 3047 0212 FFF7FEFF 		bl	fflush
 3048              	.LVL374:
 474:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 3049              		.loc 1 474 0
 3050 0216 0CE7     		b	.L261
 3051              	.LVL375:
 3052              	.L265:
 183:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3053              		.loc 1 183 0
 3054 0218 0021     		movs	r1, #0
 3055 021a 3248     		ldr	r0, .L295+84
 3056              	.LVL376:
 3057 021c FFF7FEFF 		bl	SET_Configuration_Value
 3058              	.LVL377:
 184:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Addr(WIFI_OPR_RATE_MASK, "0x00003FCF");
 3059              		.loc 1 184 0
 3060 0220 0446     		mov	r4, r0
 3061 0222 0028     		cmp	r0, #0
 3062 0224 7FF405AF 		bne	.L261
 185:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3063              		.loc 1 185 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 104


 3064 0228 2F49     		ldr	r1, .L295+88
 3065 022a 3048     		ldr	r0, .L295+92
 3066              	.LVL378:
 3067 022c FFF7FEFF 		bl	SET_Configuration_Addr
 3068              	.LVL379:
 186:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 3069              		.loc 1 186 0
 3070 0230 0446     		mov	r4, r0
 3071 0232 0028     		cmp	r0, #0
 3072 0234 3FF439AF 		beq	.L264
 3073 0238 FBE6     		b	.L261
 3074              	.L266:
 189:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3075              		.loc 1 189 0
 3076 023a 0121     		movs	r1, #1
 3077 023c 2948     		ldr	r0, .L295+84
 3078              	.LVL380:
 3079 023e FFF7FEFF 		bl	SET_Configuration_Value
 3080              	.LVL381:
 190:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Addr(WIFI_OPR_RATE_MASK, "0x003FFFCF");
 3081              		.loc 1 190 0
 3082 0242 0446     		mov	r4, r0
 3083 0244 0028     		cmp	r0, #0
 3084 0246 7FF4F4AE 		bne	.L261
 191:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3085              		.loc 1 191 0
 3086 024a 2949     		ldr	r1, .L295+96
 3087 024c 2748     		ldr	r0, .L295+92
 3088              	.LVL382:
 3089 024e FFF7FEFF 		bl	SET_Configuration_Addr
 3090              	.LVL383:
 192:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 3091              		.loc 1 192 0
 3092 0252 0446     		mov	r4, r0
 3093 0254 0028     		cmp	r0, #0
 3094 0256 3FF428AF 		beq	.L264
 3095 025a EAE6     		b	.L261
 3096              	.L269:
 201:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3097              		.loc 1 201 0
 3098 025c 0021     		movs	r1, #0
 3099 025e 2548     		ldr	r0, .L295+100
 3100              	.LVL384:
 3101 0260 FFF7FEFF 		bl	SET_Configuration_Value
 3102              	.LVL385:
 202:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_SLEEP_ENABLED, 0);  
 3103              		.loc 1 202 0
 3104 0264 0446     		mov	r4, r0
 3105 0266 0028     		cmp	r0, #0
 3106 0268 7FF4E3AE 		bne	.L261
 203:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3107              		.loc 1 203 0
 3108 026c 0021     		movs	r1, #0
 3109 026e 2248     		ldr	r0, .L295+104
 3110              	.LVL386:
 3111 0270 FFF7FEFF 		bl	SET_Configuration_Value
 3112              	.LVL387:
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 105


 204:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_STANDBY_ENABLED, 0);  
 3113              		.loc 1 204 0
 3114 0274 0446     		mov	r4, r0
 3115 0276 0028     		cmp	r0, #0
 3116 0278 7FF4DBAE 		bne	.L261
 205:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3117              		.loc 1 205 0
 3118 027c 0021     		movs	r1, #0
 3119 027e 1F48     		ldr	r0, .L295+108
 3120              	.LVL388:
 3121 0280 FFF7FEFF 		bl	SET_Configuration_Value
 3122              	.LVL389:
 206:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 3123              		.loc 1 206 0
 3124 0284 0446     		mov	r4, r0
 3125 0286 0028     		cmp	r0, #0
 3126 0288 3FF419AF 		beq	.L267
 3127 028c D1E6     		b	.L261
 3128              	.L296:
 3129 028e 00BF     		.align	2
 3130              	.L295:
 3131 0290 00000000 		.word	.LC28
 3132 0294 18000000 		.word	.LC29
 3133 0298 34000000 		.word	.LC30
 3134 029c 50000000 		.word	.LC31
 3135 02a0 64000000 		.word	.LC32
 3136 02a4 00000000 		.word	WiFi_AT_Cmd_Buff
 3137 02a8 74000000 		.word	.LC33
 3138 02ac 7C000000 		.word	.LC34
 3139 02b0 10000000 		.word	.LC14
 3140 02b4 10000000 		.word	.LC17
 3141 02b8 48000000 		.word	.LC22
 3142 02bc 28000000 		.word	.LC19
 3143 02c0 30000000 		.word	.LC20
 3144 02c4 2C010000 		.word	.LC44
 3145 02c8 38010000 		.word	.LC45
 3146 02cc 48010000 		.word	.LC46
 3147 02d0 84010000 		.word	.LC49
 3148 02d4 98010000 		.word	.LC50
 3149 02d8 00000000 		.word	.LC0
 3150 02dc A8010000 		.word	.LC51
 3151 02e0 00000000 		.word	_impure_ptr
 3152 02e4 8C000000 		.word	.LC35
 3153 02e8 9C000000 		.word	.LC36
 3154 02ec A8000000 		.word	.LC37
 3155 02f0 BC000000 		.word	.LC38
 3156 02f4 C8000000 		.word	.LC39
 3157 02f8 00000000 		.word	.LC24
 3158 02fc 10000000 		.word	.LC25
 3159              	.L268:
 209:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3160              		.loc 1 209 0
 3161 0300 0121     		movs	r1, #1
 3162 0302 4448     		ldr	r0, .L297
 3163              	.LVL390:
 3164 0304 FFF7FEFF 		bl	SET_Configuration_Value
 3165              	.LVL391:
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 106


 210:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_OPERATIONAL_MODE, 11);  
 3166              		.loc 1 210 0
 3167 0308 0446     		mov	r4, r0
 3168 030a 0028     		cmp	r0, #0
 3169 030c 7FF491AE 		bne	.L261
 211:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3170              		.loc 1 211 0
 3171 0310 0B21     		movs	r1, #11
 3172 0312 4148     		ldr	r0, .L297+4
 3173              	.LVL392:
 3174 0314 FFF7FEFF 		bl	SET_Configuration_Value
 3175              	.LVL393:
 212:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_BEACON_WAKEUP, 0);
 3176              		.loc 1 212 0
 3177 0318 0446     		mov	r4, r0
 3178 031a 0028     		cmp	r0, #0
 3179 031c 7FF489AE 		bne	.L261
 213:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3180              		.loc 1 213 0
 3181 0320 0021     		movs	r1, #0
 3182 0322 3E48     		ldr	r0, .L297+8
 3183              	.LVL394:
 3184 0324 FFF7FEFF 		bl	SET_Configuration_Value
 3185              	.LVL395:
 214:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_LISTEN_INTERVAL, 0);
 3186              		.loc 1 214 0
 3187 0328 0446     		mov	r4, r0
 3188 032a 0028     		cmp	r0, #0
 3189 032c 7FF481AE 		bne	.L261
 215:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3190              		.loc 1 215 0
 3191 0330 0021     		movs	r1, #0
 3192 0332 3B48     		ldr	r0, .L297+12
 3193              	.LVL396:
 3194 0334 FFF7FEFF 		bl	SET_Configuration_Value
 3195              	.LVL397:
 216:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_SLEEP_ENABLED, 0);  
 3196              		.loc 1 216 0
 3197 0338 0446     		mov	r4, r0
 3198 033a 0028     		cmp	r0, #0
 3199 033c 7FF479AE 		bne	.L261
 217:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3200              		.loc 1 217 0
 3201 0340 0021     		movs	r1, #0
 3202 0342 3848     		ldr	r0, .L297+16
 3203              	.LVL398:
 3204 0344 FFF7FEFF 		bl	SET_Configuration_Value
 3205              	.LVL399:
 218:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_STANDBY_ENABLED, 0);  
 3206              		.loc 1 218 0
 3207 0348 0446     		mov	r4, r0
 3208 034a 0028     		cmp	r0, #0
 3209 034c 7FF471AE 		bne	.L261
 219:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3210              		.loc 1 219 0
 3211 0350 0021     		movs	r1, #0
 3212 0352 3548     		ldr	r0, .L297+20
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 107


 3213              	.LVL400:
 3214 0354 FFF7FEFF 		bl	SET_Configuration_Value
 3215              	.LVL401:
 220:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 3216              		.loc 1 220 0
 3217 0358 0446     		mov	r4, r0
 3218 035a 0028     		cmp	r0, #0
 3219 035c 3FF4AFAE 		beq	.L267
 3220 0360 67E6     		b	.L261
 3221              	.L270:
 223:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3222              		.loc 1 223 0
 3223 0362 0121     		movs	r1, #1
 3224 0364 2B48     		ldr	r0, .L297
 3225              	.LVL402:
 3226 0366 FFF7FEFF 		bl	SET_Configuration_Value
 3227              	.LVL403:
 224:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_OPERATIONAL_MODE, 12);  
 3228              		.loc 1 224 0
 3229 036a 0446     		mov	r4, r0
 3230 036c 0028     		cmp	r0, #0
 3231 036e 7FF460AE 		bne	.L261
 225:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3232              		.loc 1 225 0
 3233 0372 0C21     		movs	r1, #12
 3234 0374 2848     		ldr	r0, .L297+4
 3235              	.LVL404:
 3236 0376 FFF7FEFF 		bl	SET_Configuration_Value
 3237              	.LVL405:
 226:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_BEACON_WAKEUP, 10);
 3238              		.loc 1 226 0
 3239 037a 0446     		mov	r4, r0
 3240 037c 0028     		cmp	r0, #0
 3241 037e 7FF458AE 		bne	.L261
 227:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3242              		.loc 1 227 0
 3243 0382 0A21     		movs	r1, #10
 3244 0384 2548     		ldr	r0, .L297+8
 3245              	.LVL406:
 3246 0386 FFF7FEFF 		bl	SET_Configuration_Value
 3247              	.LVL407:
 228:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_LISTEN_INTERVAL, 1);
 3248              		.loc 1 228 0
 3249 038a 0446     		mov	r4, r0
 3250 038c 0028     		cmp	r0, #0
 3251 038e 7FF450AE 		bne	.L261
 229:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3252              		.loc 1 229 0
 3253 0392 0121     		movs	r1, #1
 3254 0394 2248     		ldr	r0, .L297+12
 3255              	.LVL408:
 3256 0396 FFF7FEFF 		bl	SET_Configuration_Value
 3257              	.LVL409:
 230:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_SLEEP_ENABLED, 1);  
 3258              		.loc 1 230 0
 3259 039a 0446     		mov	r4, r0
 3260 039c 0028     		cmp	r0, #0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 108


 3261 039e 7FF448AE 		bne	.L261
 231:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3262              		.loc 1 231 0
 3263 03a2 0121     		movs	r1, #1
 3264 03a4 1F48     		ldr	r0, .L297+16
 3265              	.LVL410:
 3266 03a6 FFF7FEFF 		bl	SET_Configuration_Value
 3267              	.LVL411:
 232:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           status = SET_Configuration_Value(WIFI_STANDBY_ENABLED, 0);  
 3268              		.loc 1 232 0
 3269 03aa 0446     		mov	r4, r0
 3270 03ac 0028     		cmp	r0, #0
 3271 03ae 7FF440AE 		bne	.L261
 233:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3272              		.loc 1 233 0
 3273 03b2 0021     		movs	r1, #0
 3274 03b4 1C48     		ldr	r0, .L297+20
 3275              	.LVL412:
 3276 03b6 FFF7FEFF 		bl	SET_Configuration_Value
 3277              	.LVL413:
 234:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 3278              		.loc 1 234 0
 3279 03ba 0446     		mov	r4, r0
 3280 03bc 0028     		cmp	r0, #0
 3281 03be 3FF47EAE 		beq	.L267
 3282 03c2 36E6     		b	.L261
 3283              	.L291:
 246:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3284              		.loc 1 246 0
 3285 03c4 03EB4303 		add	r3, r3, r3, lsl #1
 3286 03c8 5900     		lsls	r1, r3, #1
 3287 03ca 1848     		ldr	r0, .L297+24
 3288              	.LVL414:
 3289 03cc FFF7FEFF 		bl	SET_Configuration_Value
 3290              	.LVL415:
 247:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 3291              		.loc 1 247 0
 3292 03d0 0446     		mov	r4, r0
 3293 03d2 0028     		cmp	r0, #0
 3294 03d4 3FF477AE 		beq	.L271
 3295 03d8 2BE6     		b	.L261
 3296              	.L292:
 258:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           if(status != WiFi_MODULE_SUCCESS) return status;
 3297              		.loc 1 258 0
 3298 03da 1548     		ldr	r0, .L297+28
 3299              	.LVL416:
 3300 03dc FFF7FEFF 		bl	SET_Configuration_Value
 3301              	.LVL417:
 259:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****           break;
 3302              		.loc 1 259 0
 3303 03e0 0446     		mov	r4, r0
 3304 03e2 0028     		cmp	r0, #0
 3305 03e4 3FF473AE 		beq	.L273
 3306 03e8 23E6     		b	.L261
 3307              	.L293:
 314:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 3308              		.loc 1 314 0
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 109


 3309 03ea 4FF47A71 		mov	r1, #1000
 3310 03ee 01FB03F1 		mul	r1, r1, r3
 3311 03f2 1048     		ldr	r0, .L297+32
 3312              	.LVL418:
 3313 03f4 FFF7FEFF 		bl	SET_Configuration_Value
 3314              	.LVL419:
 315:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 3315              		.loc 1 315 0
 3316 03f8 0446     		mov	r4, r0
 3317 03fa 0028     		cmp	r0, #0
 3318 03fc 3FF4A4AE 		beq	.L282
 3319 0400 17E6     		b	.L261
 3320              	.L294:
 319:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         if(status != WiFi_MODULE_SUCCESS) return status;
 3321              		.loc 1 319 0
 3322 0402 0D48     		ldr	r0, .L297+36
 3323              	.LVL420:
 3324 0404 FFF7FEFF 		bl	SET_Configuration_Value
 3325              	.LVL421:
 320:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 3326              		.loc 1 320 0
 3327 0408 0446     		mov	r4, r0
 3328 040a 0028     		cmp	r0, #0
 3329 040c 3FF4A0AE 		beq	.L283
 3330 0410 0FE6     		b	.L261
 3331              	.L298:
 3332 0412 00BF     		.align	2
 3333              	.L297:
 3334 0414 C8000000 		.word	.LC39
 3335 0418 D8000000 		.word	.LC40
 3336 041c F0000000 		.word	.LC41
 3337 0420 04010000 		.word	.LC42
 3338 0424 00000000 		.word	.LC24
 3339 0428 10000000 		.word	.LC25
 3340 042c 1C010000 		.word	.LC43
 3341 0430 54000000 		.word	.LC23
 3342 0434 58010000 		.word	.LC47
 3343 0438 74010000 		.word	.LC48
 3344              		.cfi_endproc
 3345              	.LFE275:
 3347              		.section	.text.wifi_disconnect,"ax",%progbits
 3348              		.align	1
 3349              		.global	wifi_disconnect
 3350              		.syntax unified
 3351              		.thumb
 3352              		.thumb_func
 3353              		.fpu fpv4-sp-d16
 3355              	wifi_disconnect:
 3356              	.LFB307:
2428:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2429:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
2430:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_disconnect
2431:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         disconnect the module from any AP
2432:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  None
2433:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : status of AT cmd
2434:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
2435:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_disconnect(void)
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 110


2436:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 3357              		.loc 1 2436 0
 3358              		.cfi_startproc
 3359              		@ args = 0, pretend = 0, frame = 0
 3360              		@ frame_needed = 0, uses_anonymous_args = 0
 3361 0000 08B5     		push	{r3, lr}
 3362              	.LCFI48:
 3363              		.cfi_def_cfa_offset 8
 3364              		.cfi_offset 3, -8
 3365              		.cfi_offset 14, -4
 3366              	.LVL422:
2437:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;  
2438:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2439:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();  
 3367              		.loc 1 2439 0
 3368 0002 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 3369              	.LVL423:
2440:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2441:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04  
2442:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*AT+S.WIFI=0<cr>*/  
2443:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(CONSOLE_UART_ENABLED)
2444:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_WIFI_ENABLE, 0);  
2445:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
2446:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2447:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.WIFI=%d", 0);  
2448:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2449:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = WiFi_MODULE_SUCCESS;
2450:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2451:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
2452:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
2453:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
2454:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status;
2455:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     else IO_status_flag.radio_off = WIFI_TRUE;
2456:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
2457:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2458:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_WIND_State!= WiFiPowerDown);//Till +WIND:38:WiFi Powered Down arrives
2459:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2460:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2461:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set wifi_mode to idle*/
2462:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = SET_Configuration_Value(WIFI_MODE, WiFi_IDLE_MODE);
 3370              		.loc 1 2462 0
 3371 0006 0021     		movs	r1, #0
 3372 0008 0848     		ldr	r0, .L303
 3373 000a FFF7FEFF 		bl	SET_Configuration_Value
 3374              	.LVL424:
2463:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2464:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*If module was connected, reset the status*/
2465:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(wifi_connected == 1)
 3375              		.loc 1 2465 0
 3376 000e 084B     		ldr	r3, .L303+4
 3377 0010 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3378 0012 DBB2     		uxtb	r3, r3
 3379 0014 012B     		cmp	r3, #1
 3380 0016 05D0     		beq	.L302
 3381              	.L300:
2466:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
2467:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         wifi_connected = 0;//this will allow the TIM handler to make the callback on connection(WiF
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 111


2468:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }  
2469:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2470:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04  
2471:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*AT+S.WIFI=1<cr>*/  
2472:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer(); 
2473:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #if defined(CONSOLE_UART_ENABLED)
2474:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_WIFI_ENABLE, 1);  
2475:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
2476:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2477:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.WIFI=%d", 1);  
2478:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2479:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = WiFi_MODULE_SUCCESS;
2480:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2481:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2482:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
2483:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
2484:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
2485:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status;
2486:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     else IO_status_flag.radio_off = WIFI_FALSE;
2487:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }  
2488:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2489:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_Enabled != WIFI_TRUE);//Till Hardware Started arrives
2490:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2491:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2492:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* save current setting in flash */
2493:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Save_Current_Setting();
 3382              		.loc 1 2493 0
 3383 0018 FFF7FEFF 		bl	Save_Current_Setting
 3384              	.LVL425:
2494:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2495:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2496:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Soft reset the module */
2497:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined (SPWF04)
2498:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //status = Soft_Reset();
2499:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2500:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = SET_Power_State((WiFi_Power_State_t)PowerSave_State);//CFUN=1
 3385              		.loc 1 2500 0
 3386 001c 0120     		movs	r0, #1
 3387 001e FFF7FEFF 		bl	SET_Power_State
 3388              	.LVL426:
2501:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2502:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****        
2503:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
2504:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 3389              		.loc 1 2504 0
 3390 0022 08BD     		pop	{r3, pc}
 3391              	.LVL427:
 3392              	.L302:
2467:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }  
 3393              		.loc 1 2467 0
 3394 0024 0022     		movs	r2, #0
 3395 0026 024B     		ldr	r3, .L303+4
 3396 0028 1A70     		strb	r2, [r3]
 3397 002a F5E7     		b	.L300
 3398              	.L304:
 3399              		.align	2
 3400              	.L303:
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 112


 3401 002c 10000000 		.word	.LC14
 3402 0030 00000000 		.word	wifi_connected
 3403              		.cfi_endproc
 3404              	.LFE307:
 3406              		.section	.text.wifi_enable,"ax",%progbits
 3407              		.align	1
 3408              		.global	wifi_enable
 3409              		.syntax unified
 3410              		.thumb
 3411              		.thumb_func
 3412              		.fpu fpv4-sp-d16
 3414              	wifi_enable:
 3415              	.LFB308:
2505:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2506:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
2507:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_enable
2508:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Enable/Disable the Wi-Fi interface
2509:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  enable enable Wi-Fi (WIFI_TRUE) disable Wi-Fi (WIFI_FALSE)
2510:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : status of AT cmd
2511:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
2512:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_enable(wifi_bool enable)
2513:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 3416              		.loc 1 2513 0
 3417              		.cfi_startproc
 3418              		@ args = 0, pretend = 0, frame = 0
 3419              		@ frame_needed = 0, uses_anonymous_args = 0
 3420              	.LVL428:
 3421 0000 38B5     		push	{r3, r4, r5, lr}
 3422              	.LCFI49:
 3423              		.cfi_def_cfa_offset 16
 3424              		.cfi_offset 3, -16
 3425              		.cfi_offset 4, -12
 3426              		.cfi_offset 5, -8
 3427              		.cfi_offset 14, -4
 3428              	.LVL429:
2514:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
2515:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2516:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if((enable && IO_status_flag.WiFi_Enabled == WIFI_TRUE) || (!enable && IO_status_flag.WiFi_Enable
 3429              		.loc 1 2516 0
 3430 0002 0446     		mov	r4, r0
 3431 0004 20B1     		cbz	r0, .L306
 3432              		.loc 1 2516 0 is_stmt 0 discriminator 1
 3433 0006 204B     		ldr	r3, .L318
 3434 0008 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3435 000a 13F0100F 		tst	r3, #16
 3436 000e 36D1     		bne	.L314
 3437              	.L306:
 3438              		.loc 1 2516 0 discriminator 3
 3439 0010 24B9     		cbnz	r4, .L308
 3440              		.loc 1 2516 0 discriminator 4
 3441 0012 1D4B     		ldr	r3, .L318
 3442 0014 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3443 0016 13F0100F 		tst	r3, #16
 3444 001a 32D0     		beq	.L315
 3445              	.L308:
2517:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return status;//already in desired state
2518:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 113


2519:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Enable or Disable wifi interface*/  
2520:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();  
 3446              		.loc 1 2520 0 is_stmt 1
 3447 001c FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 3448              	.LVL430:
2521:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2522:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(CONSOLE_UART_ENABLED)
2523:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2524:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_WIFI_ENABLE, enable);  
 3449              		.loc 1 2524 0
 3450 0020 1A4D     		ldr	r5, .L318+4
 3451 0022 2246     		mov	r2, r4
 3452 0024 1A49     		ldr	r1, .L318+8
 3453 0026 2846     		mov	r0, r5
 3454 0028 FFF7FEFF 		bl	sprintf
 3455              	.LVL431:
2525:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(HAL_UART_Transmit(&UartWiFiHandle, (uint8_t *)WiFi_AT_Cmd_Buff, strlen((char*)WiFi_AT_Cmd_Buff
 3456              		.loc 1 2525 0
 3457 002c 2846     		mov	r0, r5
 3458 002e FFF7FEFF 		bl	strlen
 3459              	.LVL432:
 3460 0032 4FF47A73 		mov	r3, #1000
 3461 0036 82B2     		uxth	r2, r0
 3462 0038 2946     		mov	r1, r5
 3463 003a 1648     		ldr	r0, .L318+12
 3464 003c FFF7FEFF 		bl	HAL_UART_Transmit
 3465              	.LVL433:
 3466 0040 20B1     		cbz	r0, .L309
2526:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
2527:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_UART_Error_Handler();
 3467              		.loc 1 2527 0
 3468 0042 FFF7FEFF 		bl	WiFi_UART_Error_Handler
 3469              	.LVL434:
2528:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #if DEBUG_PRINT
2529:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     printf("HAL_UART_Transmit Error");
2530:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     #endif
2531:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return WiFi_HAL_UART_ERROR;
 3470              		.loc 1 2531 0
 3471 0046 0F23     		movs	r3, #15
 3472              	.LVL435:
 3473              	.L307:
2532:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }  
2533:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2534:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2535:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*AT+S.WIFI=0<cr>*/  
2536:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.WIFI=%d", 0);  
2537:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2538:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = WiFi_MODULE_SUCCESS;  
2539:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2540:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2541:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2542:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
2543:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
2544:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
2545:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status;
2546:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     else IO_status_flag.radio_off = WIFI_TRUE;
2547:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 114


2548:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2549:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //wait for power down/hw started
2550:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(enable)
2551:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_Enabled != WIFI_TRUE) {
2552:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         __NOP(); //nothing to do
2553:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
2554:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   else
2555:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     while(IO_status_flag.WiFi_Enabled != WIFI_FALSE) {
2556:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         __NOP(); //nothing to do
2557:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
2558:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2559:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
2560:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 3474              		.loc 1 2560 0
 3475 0048 1846     		mov	r0, r3
 3476 004a 38BD     		pop	{r3, r4, r5, pc}
 3477              	.LVL436:
 3478              	.L309:
2544:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status;
 3479              		.loc 1 2544 0
 3480 004c FFF7FEFF 		bl	USART_Receive_AT_Resp
 3481              	.LVL437:
2545:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     else IO_status_flag.radio_off = WIFI_TRUE;
 3482              		.loc 1 2545 0
 3483 0050 0346     		mov	r3, r0
 3484 0052 0028     		cmp	r0, #0
 3485 0054 F8D1     		bne	.L307
2546:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
 3486              		.loc 1 2546 0
 3487 0056 0C49     		ldr	r1, .L318
 3488 0058 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 3489 005a 42F04002 		orr	r2, r2, #64
 3490 005e 0A70     		strb	r2, [r1]
 3491              	.LVL438:
2550:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_Enabled != WIFI_TRUE) {
 3492              		.loc 1 2550 0
 3493 0060 34B9     		cbnz	r4, .L310
 3494              	.L311:
2555:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         __NOP(); //nothing to do
 3495              		.loc 1 2555 0
 3496 0062 094A     		ldr	r2, .L318
 3497 0064 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 3498 0066 12F0100F 		tst	r2, #16
 3499 006a EDD0     		beq	.L307
2556:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 3500              		.loc 1 2556 0
 3501              		.syntax unified
 3502              	@ 2556 "Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c" 1
 3503 006c 00BF     		nop
 3504              	@ 0 "" 2
 3505              		.thumb
 3506              		.syntax unified
 3507 006e F8E7     		b	.L311
 3508              	.L310:
2551:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         __NOP(); //nothing to do
 3509              		.loc 1 2551 0
 3510 0070 054A     		ldr	r2, .L318
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 115


 3511 0072 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 3512 0074 12F0100F 		tst	r2, #16
 3513 0078 E6D1     		bne	.L307
2552:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 3514              		.loc 1 2552 0
 3515              		.syntax unified
 3516              	@ 2552 "Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c" 1
 3517 007a 00BF     		nop
 3518              	@ 0 "" 2
 3519              		.thumb
 3520              		.syntax unified
 3521 007c F8E7     		b	.L310
 3522              	.LVL439:
 3523              	.L314:
2517:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
 3524              		.loc 1 2517 0
 3525 007e 0023     		movs	r3, #0
 3526 0080 E2E7     		b	.L307
 3527              	.L315:
 3528 0082 0023     		movs	r3, #0
 3529 0084 E0E7     		b	.L307
 3530              	.L319:
 3531 0086 00BF     		.align	2
 3532              	.L318:
 3533 0088 00000000 		.word	IO_status_flag
 3534 008c 00000000 		.word	WiFi_AT_Cmd_Buff
 3535 0090 00000000 		.word	.LC52
 3536 0094 00000000 		.word	UartWiFiHandle
 3537              		.cfi_endproc
 3538              	.LFE308:
 3540              		.section	.text.wifi_restore,"ax",%progbits
 3541              		.align	1
 3542              		.global	wifi_restore
 3543              		.syntax unified
 3544              		.thumb
 3545              		.thumb_func
 3546              		.fpu fpv4-sp-d16
 3548              	wifi_restore:
 3549              	.LFB309:
2561:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2562:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
2563:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_restore
2564:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Restore the Wi-Fi with default values.
2565:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  None
2566:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : status of AT cmd
2567:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
2568:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_restore()
2569:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 3550              		.loc 1 2569 0
 3551              		.cfi_startproc
 3552              		@ args = 0, pretend = 0, frame = 0
 3553              		@ frame_needed = 0, uses_anonymous_args = 0
 3554 0000 08B5     		push	{r3, lr}
 3555              	.LCFI50:
 3556              		.cfi_def_cfa_offset 8
 3557              		.cfi_offset 3, -8
 3558              		.cfi_offset 14, -4
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 116


 3559              	.LVL440:
2570:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
2571:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2572:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Restore default setting*/
2573:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Restore_Default_Setting();  
 3560              		.loc 1 2573 0
 3561 0002 FFF7FEFF 		bl	Restore_Default_Setting
 3562              	.LVL441:
2574:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2575:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(CONSOLE_UART_ENABLED)
2576:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04    
2577:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*AT+S.WIFI=0<cr>*/  
2578:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_WIFI_ENABLE, 0);  
2579:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
2580:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
2581:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
2582:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
2583:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status;
2584:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     else IO_status_flag.radio_off = WIFI_TRUE;
2585:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
2586:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2587:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_WIND_State!= WiFiPowerDown);//Till +WIND:38:WiFi Powered Down arrives
2588:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif  
2589:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set wifi_mode to idle*/
2590:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   SET_Configuration_Value(WIFI_MODE, WiFi_IDLE_MODE);
 3563              		.loc 1 2590 0
 3564 0006 0021     		movs	r1, #0
 3565 0008 0648     		ldr	r0, .L322
 3566 000a FFF7FEFF 		bl	SET_Configuration_Value
 3567              	.LVL442:
2591:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #ifdef SPWF04    
2592:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /*AT+S.WIFI=1<cr>*/  
2593:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Restore_Default_Setting();  
2594:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_WIFI_ENABLE, 1);  
2595:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
2596:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
2597:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   {
2598:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Receive_AT_Resp( );
2599:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status != WiFi_MODULE_SUCCESS) return status;
2600:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     else IO_status_flag.radio_off = WIFI_FALSE;
2601:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   }
2602:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2603:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_Enabled != WIFI_TRUE);//Till Hardware Started arrives
2604:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif  
2605:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2606:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2607:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set radio OFF */
2608:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();  
2609:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.WIFI=%d", 0);  
2610:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2611:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
2612:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS) return status;
2613:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_WIND_State!= WiFiPowerDown);//Till +WIND:38:WiFi Powered Down arrives
2614:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2615:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    /* Set wifi_mode to idle*/
2616:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   SET_Configuration_Value(WIFI_MODE, WiFi_IDLE_MODE);
2617:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 117


2618:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Set radio ON */  
2619:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer();  
2620:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.WIFI=%d", 1);  
2621:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2622:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Receive_AT_Resp( );
2623:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status != WiFi_MODULE_SUCCESS) return status;
2624:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   while(IO_status_flag.WiFi_Enabled != WIFI_TRUE);//Till Hardware Started arrives
2625:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2626:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif  
2627:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2628:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* set the local echo */
2629:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   SET_Configuration_Value(LOCALECHO1, 0); 
 3568              		.loc 1 2629 0
 3569 000e 0021     		movs	r1, #0
 3570 0010 0548     		ldr	r0, .L322+4
 3571 0012 FFF7FEFF 		bl	SET_Configuration_Value
 3572              	.LVL443:
2630:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2631:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* Soft reset the module */
2632:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined (SPWF04)
2633:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   //status = Soft_Reset();
2634:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2635:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* save current setting in flash */
2636:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Save_Current_Setting();
 3573              		.loc 1 2636 0
 3574 0016 FFF7FEFF 		bl	Save_Current_Setting
 3575              	.LVL444:
2637:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2638:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = SET_Power_State((WiFi_Power_State_t)PowerSave_State);//CFUN=1
 3576              		.loc 1 2638 0
 3577 001a 0120     		movs	r0, #1
 3578 001c FFF7FEFF 		bl	SET_Power_State
 3579              	.LVL445:
2639:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2640:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2641:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
2642:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 3580              		.loc 1 2642 0
 3581 0020 08BD     		pop	{r3, pc}
 3582              	.L323:
 3583 0022 00BF     		.align	2
 3584              	.L322:
 3585 0024 10000000 		.word	.LC14
 3586 0028 00000000 		.word	.LC53
 3587              		.cfi_endproc
 3588              	.LFE309:
 3590              		.section	.text.wifi_gpio_init,"ax",%progbits
 3591              		.align	1
 3592              		.global	wifi_gpio_init
 3593              		.syntax unified
 3594              		.thumb
 3595              		.thumb_func
 3596              		.fpu fpv4-sp-d16
 3598              	wifi_gpio_init:
 3599              	.LFB310:
2643:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2644:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /*GPIO Configuration Functions*/
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 118


2645:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2646:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
2647:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_gpio_init
2648:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Configure a GPIO pin as in or out with IRQ setting
2649:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  pin GPIO pin number
2650:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  irq configuration of the pin
2651:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : status of AT cmd
2652:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
2653:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** uint8_t wifi_gpio_init(GpioPin pin, char* dir, char irq)
2654:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 3600              		.loc 1 2654 0
 3601              		.cfi_startproc
 3602              		@ args = 0, pretend = 0, frame = 0
 3603              		@ frame_needed = 0, uses_anonymous_args = 0
 3604              	.LVL446:
 3605 0000 70B5     		push	{r4, r5, r6, lr}
 3606              	.LCFI51:
 3607              		.cfi_def_cfa_offset 16
 3608              		.cfi_offset 4, -16
 3609              		.cfi_offset 5, -12
 3610              		.cfi_offset 6, -8
 3611              		.cfi_offset 14, -4
 3612 0002 82B0     		sub	sp, sp, #8
 3613              	.LCFI52:
 3614              		.cfi_def_cfa_offset 24
 3615 0004 0546     		mov	r5, r0
 3616 0006 0E46     		mov	r6, r1
 3617 0008 1446     		mov	r4, r2
 3618              	.LVL447:
2655:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Status_t status = WiFi_MODULE_SUCCESS;
2656:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
2657:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /* AT+S.GPIOC=pin,dir,irq */
2658:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Reset_AT_CMD_Buffer();
 3619              		.loc 1 2658 0
 3620 000a FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 3621              	.LVL448:
2659:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(CONSOLE_UART_ENABLED)
2660:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(irq!=GPIO_Off)
 3622              		.loc 1 2660 0
 3623 000e 302C     		cmp	r4, #48
 3624 0010 11D0     		beq	.L325
2661:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.GPIOC=%d,%s,%c\r", pin, dir, irq);
 3625              		.loc 1 2661 0
 3626 0012 0094     		str	r4, [sp]
 3627 0014 3346     		mov	r3, r6
 3628 0016 2A46     		mov	r2, r5
 3629 0018 0C49     		ldr	r1, .L330
 3630 001a 0D48     		ldr	r0, .L330+4
 3631 001c FFF7FEFF 		bl	sprintf
 3632              	.LVL449:
 3633              	.L326:
2662:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     else
2663:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.GPIOC=%d,%s\r", pin, dir);
2664:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
2665:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 3634              		.loc 1 2665 0
 3635 0020 0B48     		ldr	r0, .L330+4
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 119


 3636 0022 FFF7FEFF 		bl	strlen
 3637              	.LVL450:
 3638 0026 80B2     		uxth	r0, r0
 3639 0028 FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 3640              	.LVL451:
2666:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2667:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(irq!=GPIO_Off)
2668:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.GPIOC=%d,%s,%c", pin, dir, irq);
2669:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     else
2670:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.GPIOC=%d,%s", pin, dir);
2671:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2672:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = WiFi_MODULE_SUCCESS;  
2673:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
2674:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2675:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
2676:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status == WiFi_MODULE_SUCCESS)
 3641              		.loc 1 2676 0
 3642 002c 0346     		mov	r3, r0
 3643 002e 48B1     		cbz	r0, .L329
 3644              	.LVL452:
 3645              	.L327:
2677:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
2678:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = USART_Receive_AT_Resp( );
2679:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
2680:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2681:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return status;
2682:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 3646              		.loc 1 2682 0
 3647 0030 1846     		mov	r0, r3
 3648 0032 02B0     		add	sp, sp, #8
 3649              	.LCFI53:
 3650              		.cfi_remember_state
 3651              		.cfi_def_cfa_offset 16
 3652              		@ sp needed
 3653 0034 70BD     		pop	{r4, r5, r6, pc}
 3654              	.LVL453:
 3655              	.L325:
 3656              	.LCFI54:
 3657              		.cfi_restore_state
2663:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
 3658              		.loc 1 2663 0
 3659 0036 3346     		mov	r3, r6
 3660 0038 2A46     		mov	r2, r5
 3661 003a 0649     		ldr	r1, .L330+8
 3662 003c 0448     		ldr	r0, .L330+4
 3663 003e FFF7FEFF 		bl	sprintf
 3664              	.LVL454:
 3665 0042 EDE7     		b	.L326
 3666              	.LVL455:
 3667              	.L329:
2678:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 3668              		.loc 1 2678 0
 3669 0044 FFF7FEFF 		bl	USART_Receive_AT_Resp
 3670              	.LVL456:
 3671 0048 0346     		mov	r3, r0
 3672              	.LVL457:
 3673 004a F1E7     		b	.L327
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 120


 3674              	.L331:
 3675              		.align	2
 3676              	.L330:
 3677 004c 00000000 		.word	.LC54
 3678 0050 00000000 		.word	WiFi_AT_Cmd_Buff
 3679 0054 18000000 		.word	.LC55
 3680              		.cfi_endproc
 3681              	.LFE310:
 3683              		.section	.text.wifi_gpio_read,"ax",%progbits
 3684              		.align	1
 3685              		.global	wifi_gpio_read
 3686              		.syntax unified
 3687              		.thumb
 3688              		.thumb_func
 3689              		.fpu fpv4-sp-d16
 3691              	wifi_gpio_read:
 3692              	.LFB311:
2683:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2684:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
2685:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_gpio_read
2686:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Read the configuration of a GPIO pin
2687:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  pin GPIO pin number
2688:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  val value returned
2689:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  dir configuration direction returned
2690:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : status of AT cmd
2691:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
2692:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** uint8_t wifi_gpio_read(GpioPin pin, uint8_t *val, uint8_t *dir)
2693:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 3693              		.loc 1 2693 0
 3694              		.cfi_startproc
 3695              		@ args = 0, pretend = 0, frame = 0
 3696              		@ frame_needed = 0, uses_anonymous_args = 0
 3697              	.LVL458:
 3698 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 3699              	.LCFI55:
 3700              		.cfi_def_cfa_offset 24
 3701              		.cfi_offset 3, -24
 3702              		.cfi_offset 4, -20
 3703              		.cfi_offset 5, -16
 3704              		.cfi_offset 6, -12
 3705              		.cfi_offset 7, -8
 3706              		.cfi_offset 14, -4
 3707 0002 0746     		mov	r7, r0
 3708 0004 0E46     		mov	r6, r1
 3709 0006 1546     		mov	r5, r2
 3710              	.LVL459:
2694:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Status_t status = WiFi_MODULE_SUCCESS;    
2695:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2696:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /* AT+S.GPIOR=pin */
2697:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Reset_AT_CMD_Buffer();  
 3711              		.loc 1 2697 0
 3712 0008 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 3713              	.LVL460:
2698:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(CONSOLE_UART_ENABLED)
2699:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.GPIOR=%d\r", pin);
 3714              		.loc 1 2699 0
 3715 000c 0C4C     		ldr	r4, .L336
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 121


 3716 000e 3A46     		mov	r2, r7
 3717 0010 0C49     		ldr	r1, .L336+4
 3718 0012 2046     		mov	r0, r4
 3719 0014 FFF7FEFF 		bl	sprintf
 3720              	.LVL461:
2700:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 3721              		.loc 1 2700 0
 3722 0018 2046     		mov	r0, r4
 3723 001a FFF7FEFF 		bl	strlen
 3724              	.LVL462:
 3725 001e 80B2     		uxth	r0, r0
 3726 0020 FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 3727              	.LVL463:
2701:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2702:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.GPIOR=%d", pin);
2703:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2704:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.AT_event_processing = WIFI_GPIO_EVENT;
2705:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = WiFi_MODULE_SUCCESS;
2706:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2707:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2708:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status == WiFi_MODULE_SUCCESS)
 3728              		.loc 1 2708 0
 3729 0024 0246     		mov	r2, r0
 3730 0026 30B1     		cbz	r0, .L335
 3731              	.LVL464:
 3732              	.L333:
2709:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
2710:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = USART_Receive_AT_Resp( );
2711:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
2712:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     *val = WiFi_Counter_Variables.gpio_value;
 3733              		.loc 1 2712 0
 3734 0028 074B     		ldr	r3, .L336+8
 3735 002a 597A     		ldrb	r1, [r3, #9]	@ zero_extendqisi2
 3736 002c 3170     		strb	r1, [r6]
2713:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     *dir = WiFi_Counter_Variables.gpio_dir;
 3737              		.loc 1 2713 0
 3738 002e 9B7A     		ldrb	r3, [r3, #10]	@ zero_extendqisi2
 3739 0030 2B70     		strb	r3, [r5]
2714:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2715:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return status;
2716:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 3740              		.loc 1 2716 0
 3741 0032 1046     		mov	r0, r2
 3742 0034 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 3743              	.LVL465:
 3744              	.L335:
2710:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 3745              		.loc 1 2710 0
 3746 0036 FFF7FEFF 		bl	USART_Receive_AT_Resp
 3747              	.LVL466:
 3748 003a 0246     		mov	r2, r0
 3749              	.LVL467:
 3750 003c F4E7     		b	.L333
 3751              	.L337:
 3752 003e 00BF     		.align	2
 3753              	.L336:
 3754 0040 00000000 		.word	WiFi_AT_Cmd_Buff
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 122


 3755 0044 00000000 		.word	.LC56
 3756 0048 00000000 		.word	WiFi_Counter_Variables
 3757              		.cfi_endproc
 3758              	.LFE311:
 3760              		.section	.text.wifi_gpio_write,"ax",%progbits
 3761              		.align	1
 3762              		.global	wifi_gpio_write
 3763              		.syntax unified
 3764              		.thumb
 3765              		.thumb_func
 3766              		.fpu fpv4-sp-d16
 3768              	wifi_gpio_write:
 3769              	.LFB312:
2717:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2718:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
2719:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_gpio_write
2720:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Read the value of a GPIO pin
2721:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  pin GPIO pin number
2722:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  val value to be configured
2723:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval WiFi_Status_t : status of AT cmd
2724:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
2725:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** uint8_t wifi_gpio_write(GpioPin pin, GpioWriteValue value)
2726:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 3770              		.loc 1 2726 0
 3771              		.cfi_startproc
 3772              		@ args = 0, pretend = 0, frame = 0
 3773              		@ frame_needed = 0, uses_anonymous_args = 0
 3774              	.LVL468:
 3775 0000 70B5     		push	{r4, r5, r6, lr}
 3776              	.LCFI56:
 3777              		.cfi_def_cfa_offset 16
 3778              		.cfi_offset 4, -16
 3779              		.cfi_offset 5, -12
 3780              		.cfi_offset 6, -8
 3781              		.cfi_offset 14, -4
 3782 0002 0546     		mov	r5, r0
 3783 0004 0E46     		mov	r6, r1
 3784              	.LVL469:
2727:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     WiFi_Status_t status = WiFi_MODULE_SUCCESS;
2728:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2729:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     /* AT+S.GPIOW=pin,value */
2730:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     Reset_AT_CMD_Buffer(); 
 3785              		.loc 1 2730 0
 3786 0006 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 3787              	.LVL470:
2731:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(CONSOLE_UART_ENABLED)
2732:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.GPIOW=%d,%d\r", pin, value);
 3788              		.loc 1 2732 0
 3789 000a 0A4C     		ldr	r4, .L342
 3790 000c 3346     		mov	r3, r6
 3791 000e 2A46     		mov	r2, r5
 3792 0010 0949     		ldr	r1, .L342+4
 3793 0012 2046     		mov	r0, r4
 3794 0014 FFF7FEFF 		bl	sprintf
 3795              	.LVL471:
2733:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2734:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 123


 3796              		.loc 1 2734 0
 3797 0018 2046     		mov	r0, r4
 3798 001a FFF7FEFF 		bl	strlen
 3799              	.LVL472:
 3800 001e 80B2     		uxth	r0, r0
 3801 0020 FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 3802              	.LVL473:
2735:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2736:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.GPIOW=%d,%d", pin, value);
2737:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2738:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = WiFi_MODULE_SUCCESS;
2739:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2740:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
2741:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     if(status == WiFi_MODULE_SUCCESS)
 3803              		.loc 1 2741 0
 3804 0024 0346     		mov	r3, r0
 3805 0026 08B1     		cbz	r0, .L341
 3806              	.LVL474:
 3807              	.L339:
2742:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
2743:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         status = USART_Receive_AT_Resp( );
2744:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
2745:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     
2746:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     return status;
2747:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 3808              		.loc 1 2747 0
 3809 0028 1846     		mov	r0, r3
 3810 002a 70BD     		pop	{r4, r5, r6, pc}
 3811              	.LVL475:
 3812              	.L341:
2743:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 3813              		.loc 1 2743 0
 3814 002c FFF7FEFF 		bl	USART_Receive_AT_Resp
 3815              	.LVL476:
 3816 0030 0346     		mov	r3, r0
 3817              	.LVL477:
 3818 0032 F9E7     		b	.L339
 3819              	.L343:
 3820              		.align	2
 3821              	.L342:
 3822 0034 00000000 		.word	WiFi_AT_Cmd_Buff
 3823 0038 00000000 		.word	.LC57
 3824              		.cfi_endproc
 3825              	.LFE312:
 3827              		.section	.text.wifi_get_IP_address,"ax",%progbits
 3828              		.align	1
 3829              		.global	wifi_get_IP_address
 3830              		.syntax unified
 3831              		.thumb
 3832              		.thumb_func
 3833              		.fpu fpv4-sp-d16
 3835              	wifi_get_IP_address:
 3836              	.LFB313:
2748:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2749:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
2750:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_get_IP_address
2751:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Get the ip address
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 124


2752:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  ip_addr : pointer to ip address
2753:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval status  : status of AT cmd request
2754:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
2755:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_get_IP_address(uint8_t *ip_addr)
2756:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 3837              		.loc 1 2756 0
 3838              		.cfi_startproc
 3839              		@ args = 0, pretend = 0, frame = 0
 3840              		@ frame_needed = 0, uses_anonymous_args = 0
 3841              	.LVL478:
 3842 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 3843              	.LCFI57:
 3844              		.cfi_def_cfa_offset 24
 3845              		.cfi_offset 3, -24
 3846              		.cfi_offset 4, -20
 3847              		.cfi_offset 5, -16
 3848              		.cfi_offset 6, -12
 3849              		.cfi_offset 7, -8
 3850              		.cfi_offset 14, -4
 3851 0002 0646     		mov	r6, r0
 3852              	.LVL479:
2757:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
2758:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   int cfg_value_length;
2759:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2760:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    /* AT : send AT command */
2761:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer(); 
 3853              		.loc 1 2761 0
 3854 0004 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 3855              	.LVL480:
2762:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #if defined(CONSOLE_UART_ENABLED)  
2763:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_GET_STATUS_VALUE,"ip_ipaddr");
 3856              		.loc 1 2763 0
 3857 0008 114C     		ldr	r4, .L348
 3858 000a 124A     		ldr	r2, .L348+4
 3859 000c 1249     		ldr	r1, .L348+8
 3860 000e 2046     		mov	r0, r4
 3861 0010 FFF7FEFF 		bl	sprintf
 3862              	.LVL481:
2764:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 3863              		.loc 1 2764 0
 3864 0014 2046     		mov	r0, r4
 3865 0016 FFF7FEFF 		bl	strlen
 3866              	.LVL482:
 3867 001a 80B2     		uxth	r0, r0
 3868 001c FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 3869              	.LVL483:
2765:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2766:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.STS=%s", "ip_ipaddr");  
2767:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2768:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   IO_status_flag.AT_event_processing = WIFI_GCFG_EVENT;
2769:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = WiFi_MODULE_SUCCESS;
2770:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif
2771:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2772:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
 3870              		.loc 1 2772 0
 3871 0020 0446     		mov	r4, r0
 3872 0022 08B1     		cbz	r0, .L347
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 125


 3873              	.LVL484:
 3874              	.L345:
2773:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
2774:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Receive_AT_Resp( );
2775:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       cfg_value_length = strlen((const char*)WiFi_Counter_Variables.get_cfg_value);
2776:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
2777:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* copy user pointer to get_cfg_value */
2778:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       memcpy(ip_addr,WiFi_Counter_Variables.get_cfg_value,cfg_value_length);   
2779:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       memset(WiFi_Counter_Variables.get_cfg_value, 0x00,cfg_value_length);
2780:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
2781:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
2782:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 3875              		.loc 1 2782 0
 3876 0024 2046     		mov	r0, r4
 3877 0026 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 3878              	.LVL485:
 3879              	.L347:
2774:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       cfg_value_length = strlen((const char*)WiFi_Counter_Variables.get_cfg_value);
 3880              		.loc 1 2774 0
 3881 0028 FFF7FEFF 		bl	USART_Receive_AT_Resp
 3882              	.LVL486:
 3883 002c 0446     		mov	r4, r0
 3884              	.LVL487:
2775:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
 3885              		.loc 1 2775 0
 3886 002e 0B4D     		ldr	r5, .L348+12
 3887 0030 2846     		mov	r0, r5
 3888 0032 FFF7FEFF 		bl	strlen
 3889              	.LVL488:
 3890 0036 0746     		mov	r7, r0
 3891              	.LVL489:
2778:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       memset(WiFi_Counter_Variables.get_cfg_value, 0x00,cfg_value_length);
 3892              		.loc 1 2778 0
 3893 0038 0246     		mov	r2, r0
 3894 003a 2946     		mov	r1, r5
 3895 003c 3046     		mov	r0, r6
 3896              	.LVL490:
 3897 003e FFF7FEFF 		bl	memcpy
 3898              	.LVL491:
2779:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
 3899              		.loc 1 2779 0
 3900 0042 3A46     		mov	r2, r7
 3901 0044 0021     		movs	r1, #0
 3902 0046 2846     		mov	r0, r5
 3903 0048 FFF7FEFF 		bl	memset
 3904              	.LVL492:
 3905 004c EAE7     		b	.L345
 3906              	.L349:
 3907 004e 00BF     		.align	2
 3908              	.L348:
 3909 0050 00000000 		.word	WiFi_AT_Cmd_Buff
 3910 0054 10000000 		.word	.LC17
 3911 0058 00000000 		.word	.LC58
 3912 005c 0E000000 		.word	WiFi_Counter_Variables+14
 3913              		.cfi_endproc
 3914              	.LFE313:
 3916              		.section	.text.wifi_get_MAC_address,"ax",%progbits
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 126


 3917              		.align	1
 3918              		.global	wifi_get_MAC_address
 3919              		.syntax unified
 3920              		.thumb
 3921              		.thumb_func
 3922              		.fpu fpv4-sp-d16
 3924              	wifi_get_MAC_address:
 3925              	.LFB314:
2783:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2784:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
2785:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  WiFi_get_MAC_address
2786:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Get the MAC address
2787:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  ip_addr : pointer to MAC address
2788:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval status  : status of AT cmd request
2789:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
2790:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** WiFi_Status_t wifi_get_MAC_address(uint8_t *mac_addr)
2791:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 3926              		.loc 1 2791 0
 3927              		.cfi_startproc
 3928              		@ args = 0, pretend = 0, frame = 0
 3929              		@ frame_needed = 0, uses_anonymous_args = 0
 3930              	.LVL493:
 3931 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 3932              	.LCFI58:
 3933              		.cfi_def_cfa_offset 24
 3934              		.cfi_offset 3, -24
 3935              		.cfi_offset 4, -20
 3936              		.cfi_offset 5, -16
 3937              		.cfi_offset 6, -12
 3938              		.cfi_offset 7, -8
 3939              		.cfi_offset 14, -4
 3940 0002 0646     		mov	r6, r0
 3941              	.LVL494:
2792:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
2793:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   int cfg_value_length;
2794:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2795:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   /* AT : send AT command */
2796:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer(); 
 3942              		.loc 1 2796 0
 3943 0004 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 3944              	.LVL495:
2797:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #if defined(CONSOLE_UART_ENABLED)  
2798:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,AT_GET_CONFIGURATION_VALUE,"nv_wifi_macaddr");
 3945              		.loc 1 2798 0
 3946 0008 114C     		ldr	r4, .L354
 3947 000a 124A     		ldr	r2, .L354+4
 3948 000c 1249     		ldr	r1, .L354+8
 3949 000e 2046     		mov	r0, r4
 3950 0010 FFF7FEFF 		bl	sprintf
 3951              	.LVL496:
2799:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 3952              		.loc 1 2799 0
 3953 0014 2046     		mov	r0, r4
 3954 0016 FFF7FEFF 		bl	strlen
 3955              	.LVL497:
 3956 001a 80B2     		uxth	r0, r0
 3957 001c FFF7FEFF 		bl	USART_Transmit_AT_Cmd
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 127


 3958              	.LVL498:
2800:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #else
2801:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.GCFG=%s", "nv_wifi_macaddr");  
2802:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2803:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   IO_status_flag.AT_event_processing = WIFI_GCFG_EVENT;
2804:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   status = WiFi_MODULE_SUCCESS;
2805:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** #endif   
2806:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   
2807:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
 3959              		.loc 1 2807 0
 3960 0020 0446     		mov	r4, r0
 3961 0022 08B1     		cbz	r0, .L353
 3962              	.LVL499:
 3963              	.L351:
2808:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
2809:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Receive_AT_Resp( );
2810:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       cfg_value_length = strlen((const char*)WiFi_Counter_Variables.get_cfg_value);
2811:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
2812:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* copy user pointer to get_cfg_value */
2813:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       memcpy(mac_addr,&WiFi_Counter_Variables.get_cfg_value,cfg_value_length);  //IP address will h
2814:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       memset(WiFi_Counter_Variables.get_cfg_value, 0x00,cfg_value_length);
2815:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
2816:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return status;
2817:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 3964              		.loc 1 2817 0
 3965 0024 2046     		mov	r0, r4
 3966 0026 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 3967              	.LVL500:
 3968              	.L353:
2809:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       cfg_value_length = strlen((const char*)WiFi_Counter_Variables.get_cfg_value);
 3969              		.loc 1 2809 0
 3970 0028 FFF7FEFF 		bl	USART_Receive_AT_Resp
 3971              	.LVL501:
 3972 002c 0446     		mov	r4, r0
 3973              	.LVL502:
2810:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
 3974              		.loc 1 2810 0
 3975 002e 0B4D     		ldr	r5, .L354+12
 3976 0030 2846     		mov	r0, r5
 3977 0032 FFF7FEFF 		bl	strlen
 3978              	.LVL503:
 3979 0036 0746     		mov	r7, r0
 3980              	.LVL504:
2813:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       memset(WiFi_Counter_Variables.get_cfg_value, 0x00,cfg_value_length);
 3981              		.loc 1 2813 0
 3982 0038 0246     		mov	r2, r0
 3983 003a 2946     		mov	r1, r5
 3984 003c 3046     		mov	r0, r6
 3985              	.LVL505:
 3986 003e FFF7FEFF 		bl	memcpy
 3987              	.LVL506:
2814:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
 3988              		.loc 1 2814 0
 3989 0042 3A46     		mov	r2, r7
 3990 0044 0021     		movs	r1, #0
 3991 0046 2846     		mov	r0, r5
 3992 0048 FFF7FEFF 		bl	memset
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 128


 3993              	.LVL507:
 3994 004c EAE7     		b	.L351
 3995              	.L355:
 3996 004e 00BF     		.align	2
 3997              	.L354:
 3998 0050 00000000 		.word	WiFi_AT_Cmd_Buff
 3999 0054 00000000 		.word	.LC59
 4000 0058 10000000 		.word	.LC60
 4001 005c 0E000000 		.word	WiFi_Counter_Variables+14
 4002              		.cfi_endproc
 4003              	.LFE314:
 4005              		.section	.text.wifi_get_status_variable_value,"ax",%progbits
 4006              		.align	1
 4007              		.global	wifi_get_status_variable_value
 4008              		.syntax unified
 4009              		.thumb
 4010              		.thumb_func
 4011              		.fpu fpv4-sp-d16
 4013              	wifi_get_status_variable_value:
 4014              	.LFB315:
2818:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2819:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** /**
2820:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @brief  wifi_get_status_variable_value
2821:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** *         Get the value of any status variable.
2822:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  status_variable_name  : name of the Status Variable whose value needs to be found. 
2823:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @param  status_variable_value : value of the Status Variable.
2824:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @retval uint32_t : If successful, the total number of charcters written in user buffer is returne
2825:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** * @NOTE:  The user should make sure to allocate enough memory to the buffer pointed by status_varia
2826:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** */
2827:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** uint32_t wifi_get_status_variable_value(uint8_t *status_variable_name, uint8_t *status_variable_val
2828:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** {
 4015              		.loc 1 2828 0
 4016              		.cfi_startproc
 4017              		@ args = 0, pretend = 0, frame = 0
 4018              		@ frame_needed = 0, uses_anonymous_args = 0
 4019              	.LVL508:
 4020 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 4021              	.LCFI59:
 4022              		.cfi_def_cfa_offset 24
 4023              		.cfi_offset 3, -24
 4024              		.cfi_offset 4, -20
 4025              		.cfi_offset 5, -16
 4026              		.cfi_offset 6, -12
 4027              		.cfi_offset 7, -8
 4028              		.cfi_offset 14, -4
 4029 0002 0546     		mov	r5, r0
 4030 0004 0E46     		mov	r6, r1
 4031              	.LVL509:
2829:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   WiFi_Status_t status = WiFi_MODULE_SUCCESS;
2830:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   uint32_t cfg_value_length = 0;
2831:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2832:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****    /* AT : send AT command */
2833:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   Reset_AT_CMD_Buffer(); 
 4032              		.loc 1 2833 0
 4033 0006 FFF7FEFF 		bl	Reset_AT_CMD_Buffer
 4034              	.LVL510:
2834:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #if defined(CONSOLE_UART_ENABLED)  
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 129


2835:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,AT_GET_STATUS_VALUE,status_variable_name);
 4035              		.loc 1 2835 0
 4036 000a 194C     		ldr	r4, .L362
 4037 000c 2A46     		mov	r2, r5
 4038 000e 1949     		ldr	r1, .L362+4
 4039 0010 2046     		mov	r0, r4
 4040 0012 FFF7FEFF 		bl	sprintf
 4041              	.LVL511:
2836:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = USART_Transmit_AT_Cmd(strlen((char*)WiFi_AT_Cmd_Buff));
 4042              		.loc 1 2836 0
 4043 0016 2046     		mov	r0, r4
 4044 0018 FFF7FEFF 		bl	strlen
 4045              	.LVL512:
 4046 001c 80B2     		uxth	r0, r0
 4047 001e FFF7FEFF 		bl	USART_Transmit_AT_Cmd
 4048              	.LVL513:
2837:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #else
2838:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     sprintf((char*)WiFi_AT_Cmd_Buff,"AT+S.STS=%s", status_variable_name);  
2839:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     run_spi_cmd((char*)WiFi_AT_Cmd_Buff, SPI_DMA);
2840:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     IO_status_flag.AT_event_processing = WIFI_GCFG_EVENT;
2841:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     status = WiFi_MODULE_SUCCESS;
2842:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   #endif
2843:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2844:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   if(status == WiFi_MODULE_SUCCESS)
 4049              		.loc 1 2844 0
 4050 0022 10B1     		cbz	r0, .L361
2830:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 4051              		.loc 1 2830 0
 4052 0024 0024     		movs	r4, #0
 4053              	.LVL514:
 4054              	.L356:
2845:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     {
2846:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       status = USART_Receive_AT_Resp( );
2847:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       cfg_value_length = strlen((const char*)WiFi_Counter_Variables.get_cfg_value);
2848:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
2849:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       /* copy user pointer to get_cfg_value */
2850:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       memcpy(status_variable_value,WiFi_Counter_Variables.get_cfg_value,cfg_value_length);
2851:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
2852:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       if((strstr((const char *)status_variable_name,"free_heap")) != NULL)
2853:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
2854:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         uint32_t free_heap_size;
2855:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         free_heap_size = atoi((const char*)WiFi_Counter_Variables.get_cfg_value);
2856:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         /* Update the wifi_socket_write_limit value to 80% of the free heap size Value*/
2857:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         WiFi_Counter_Variables.wifi_socket_write_limit = 80*(free_heap_size/100); //can use upto 80
2858:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
2859:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       memset(WiFi_Counter_Variables.get_cfg_value, 0x00,cfg_value_length);
2860:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
2861:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****   return cfg_value_length;
2862:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** }
 4055              		.loc 1 2862 0
 4056 0026 2046     		mov	r0, r4
 4057 0028 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 4058              	.LVL515:
 4059              	.L361:
2846:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       cfg_value_length = strlen((const char*)WiFi_Counter_Variables.get_cfg_value);
 4060              		.loc 1 2846 0
 4061 002a FFF7FEFF 		bl	USART_Receive_AT_Resp
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 130


 4062              	.LVL516:
2847:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c **** 
 4063              		.loc 1 2847 0
 4064 002e 124F     		ldr	r7, .L362+8
 4065 0030 3846     		mov	r0, r7
 4066 0032 FFF7FEFF 		bl	strlen
 4067              	.LVL517:
 4068 0036 0446     		mov	r4, r0
 4069              	.LVL518:
2850:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       
 4070              		.loc 1 2850 0
 4071 0038 0246     		mov	r2, r0
 4072 003a 3946     		mov	r1, r7
 4073 003c 3046     		mov	r0, r6
 4074              	.LVL519:
 4075 003e FFF7FEFF 		bl	memcpy
 4076              	.LVL520:
2852:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       {
 4077              		.loc 1 2852 0
 4078 0042 0E49     		ldr	r1, .L362+12
 4079 0044 2846     		mov	r0, r5
 4080 0046 FFF7FEFF 		bl	strstr
 4081              	.LVL521:
 4082 004a 58B1     		cbz	r0, .L358
 4083              	.LBB28:
2855:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****         /* Update the wifi_socket_write_limit value to 80% of the free heap size Value*/
 4084              		.loc 1 2855 0
 4085 004c 3846     		mov	r0, r7
 4086 004e FFF7FEFF 		bl	atoi
 4087              	.LVL522:
2857:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****       }
 4088              		.loc 1 2857 0
 4089 0052 0B4B     		ldr	r3, .L362+16
 4090 0054 A3FB0030 		umull	r3, r0, r3, r0
 4091              	.LVL523:
 4092 0058 4009     		lsrs	r0, r0, #5
 4093 005a 00EB8000 		add	r0, r0, r0, lsl #2
 4094 005e 0301     		lsls	r3, r0, #4
 4095 0060 C7F8D630 		str	r3, [r7, #214]
 4096              	.L358:
 4097              	.LBE28:
2859:Middlewares/ST/STM32_SPWF0xSy/wifi_interface.c ****     }
 4098              		.loc 1 2859 0
 4099 0064 2246     		mov	r2, r4
 4100 0066 0021     		movs	r1, #0
 4101 0068 0348     		ldr	r0, .L362+8
 4102 006a FFF7FEFF 		bl	memset
 4103              	.LVL524:
 4104 006e DAE7     		b	.L356
 4105              	.L363:
 4106              		.align	2
 4107              	.L362:
 4108 0070 00000000 		.word	WiFi_AT_Cmd_Buff
 4109 0074 00000000 		.word	.LC58
 4110 0078 0E000000 		.word	WiFi_Counter_Variables+14
 4111 007c 00000000 		.word	.LC61
 4112 0080 1F85EB51 		.word	1374389535
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 131


 4113              		.cfi_endproc
 4114              	.LFE315:
 4116              		.comm	WAKEUP_InitStruct,20,4
 4117              		.section	.rodata.Socket_Pending_Data.str1.4,"aMS",%progbits,1
 4118              		.align	2
 4119              	.LC8:
 4120 0000 41542B53 		.ascii	"AT+S.SOCKQ=%d\015\000"
 4120      2E534F43 
 4120      4B513D25 
 4120      640D00
 4121              		.section	.rodata.Socket_Read.str1.4,"aMS",%progbits,1
 4122              		.align	2
 4123              	.LC7:
 4124 0000 41542B53 		.ascii	"AT+S.SOCKR=%d,%d\015\000"
 4124      2E534F43 
 4124      4B523D25 
 4124      642C2564 
 4124      0D00
 4125              		.section	.rodata.wifi_adhoc_create.str1.4,"aMS",%progbits,1
 4126              		.align	2
 4127              	.LC16:
 4128 0000 3139322E 		.ascii	"192.168.2.100\000"
 4128      3136382E 
 4128      322E3130 
 4128      3000
 4129 000e 0000     		.space	2
 4130              	.LC17:
 4131 0010 69705F69 		.ascii	"ip_ipaddr\000"
 4131      70616464 
 4131      7200
 4132 001a 0000     		.space	2
 4133              	.LC18:
 4134 001c 3139322E 		.ascii	"192.168.2.1\000"
 4134      3136382E 
 4134      322E3100 
 4135              	.LC19:
 4136 0028 69705F67 		.ascii	"ip_gw\000"
 4136      7700
 4137 002e 0000     		.space	2
 4138              	.LC20:
 4139 0030 69705F64 		.ascii	"ip_dns\000"
 4139      6E7300
 4140 0037 00       		.space	1
 4141              	.LC21:
 4142 0038 3235352E 		.ascii	"255.255.255.0\000"
 4142      3235352E 
 4142      3235352E 
 4142      3000
 4143 0046 0000     		.space	2
 4144              	.LC22:
 4145 0048 69705F6E 		.ascii	"ip_netmask\000"
 4145      65746D61 
 4145      736B00
 4146 0053 00       		.space	1
 4147              	.LC23:
 4148 0054 69705F75 		.ascii	"ip_use_dhcp\000"
 4148      73655F64 
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 132


 4148      68637000 
 4149              		.section	.rodata.wifi_ap_start.str1.4,"aMS",%progbits,1
 4150              		.align	2
 4151              	.LC13:
 4152 0000 77696669 		.ascii	"wifi_priv_mode\000"
 4152      5F707269 
 4152      765F6D6F 
 4152      646500
 4153 000f 00       		.space	1
 4154              	.LC14:
 4155 0010 77696669 		.ascii	"wifi_mode\000"
 4155      5F6D6F64 
 4155      6500
 4156 001a 0000     		.space	2
 4157              	.LC15:
 4158 001c 77696669 		.ascii	"wifi_channelnum\000"
 4158      5F636861 
 4158      6E6E656C 
 4158      6E756D00 
 4159              		.section	.rodata.wifi_enable.str1.4,"aMS",%progbits,1
 4160              		.align	2
 4161              	.LC52:
 4162 0000 41542B53 		.ascii	"AT+S.WIFI=%d\015\000"
 4162      2E574946 
 4162      493D2564 
 4162      0D00
 4163              		.section	.rodata.wifi_file_create.str1.4,"aMS",%progbits,1
 4164              		.align	2
 4165              	.LC9:
 4166 0000 41542B53 		.ascii	"AT+S.FSC=/%s,%d\015\000"
 4166      2E465343 
 4166      3D2F2573 
 4166      2C25640D 
 4166      00
 4167 0011 000000   		.space	3
 4168              	.LC10:
 4169 0014 41542B53 		.ascii	"AT+S.FSA=/%s,%d\015\000"
 4169      2E465341 
 4169      3D2F2573 
 4169      2C25640D 
 4169      00
 4170              		.section	.rodata.wifi_file_erase_external_flash.str1.4,"aMS",%progbits,1
 4171              		.align	2
 4172              	.LC11:
 4173 0000 41542B53 		.ascii	"AT+S.HTTPDFSERASE\015\000"
 4173      2E485454 
 4173      50444653 
 4173      45524153 
 4173      450D00
 4174              		.section	.rodata.wifi_get_IP_address.str1.4,"aMS",%progbits,1
 4175              		.align	2
 4176              	.LC58:
 4177 0000 41542B53 		.ascii	"AT+S.STS=%s\015\000"
 4177      2E535453 
 4177      3D25730D 
 4177      00
 4178              		.section	.rodata.wifi_get_MAC_address.str1.4,"aMS",%progbits,1
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 133


 4179              		.align	2
 4180              	.LC59:
 4181 0000 6E765F77 		.ascii	"nv_wifi_macaddr\000"
 4181      6966695F 
 4181      6D616361 
 4181      64647200 
 4182              	.LC60:
 4183 0010 41542B53 		.ascii	"AT+S.GCFG=%s\015\000"
 4183      2E474346 
 4183      473D2573 
 4183      0D00
 4184              		.section	.rodata.wifi_get_status_variable_value.str1.4,"aMS",%progbits,1
 4185              		.align	2
 4186              	.LC61:
 4187 0000 66726565 		.ascii	"free_heap\000"
 4187      5F686561 
 4187      7000
 4188              		.section	.rodata.wifi_gpio_init.str1.4,"aMS",%progbits,1
 4189              		.align	2
 4190              	.LC54:
 4191 0000 41542B53 		.ascii	"AT+S.GPIOC=%d,%s,%c\015\000"
 4191      2E475049 
 4191      4F433D25 
 4191      642C2573 
 4191      2C25630D 
 4192 0015 000000   		.space	3
 4193              	.LC55:
 4194 0018 41542B53 		.ascii	"AT+S.GPIOC=%d,%s\015\000"
 4194      2E475049 
 4194      4F433D25 
 4194      642C2573 
 4194      0D00
 4195              		.section	.rodata.wifi_gpio_read.str1.4,"aMS",%progbits,1
 4196              		.align	2
 4197              	.LC56:
 4198 0000 41542B53 		.ascii	"AT+S.GPIOR=%d\015\000"
 4198      2E475049 
 4198      4F523D25 
 4198      640D00
 4199              		.section	.rodata.wifi_gpio_write.str1.4,"aMS",%progbits,1
 4200              		.align	2
 4201              	.LC57:
 4202 0000 41542B53 		.ascii	"AT+S.GPIOW=%d,%d\015\000"
 4202      2E475049 
 4202      4F573D25 
 4202      642C2564 
 4202      0D00
 4203              		.section	.rodata.wifi_init.str1.4,"aMS",%progbits,1
 4204              		.align	2
 4205              	.LC28:
 4206 0000 0D0A0A42 		.ascii	"\015\012\012Build Configuration:\000"
 4206      75696C64 
 4206      20436F6E 
 4206      66696775 
 4206      72617469 
 4207              	.LC29:
 4208 0018 0D0A4E75 		.ascii	"\015\012Nucleo: NUCLEO-F401RE\015\000"
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 134


 4208      636C656F 
 4208      3A204E55 
 4208      434C454F 
 4208      2D463430 
 4209 0031 000000   		.space	3
 4210              	.LC30:
 4211 0034 582D4E75 		.ascii	"X-Nucleo: X-NUCLEO-IDW01M1\015\000"
 4211      636C656F 
 4211      3A20582D 
 4211      4E55434C 
 4211      454F2D49 
 4212              	.LC31:
 4213 0050 496E7465 		.ascii	"Interface: UART\015\000"
 4213      72666163 
 4213      653A2055 
 4213      4152540D 
 4213      00
 4214 0061 000000   		.space	3
 4215              	.LC32:
 4216 0064 636F6E73 		.ascii	"console1_speed\000"
 4216      6F6C6531 
 4216      5F737065 
 4216      656400
 4217 0073 00       		.space	1
 4218              	.LC33:
 4219 0074 41542657 		.ascii	"AT&W\015\000"
 4219      0D00
 4220 007a 0000     		.space	2
 4221              	.LC34:
 4222 007c 636F6E73 		.ascii	"console1_hwfc\000"
 4222      6F6C6531 
 4222      5F687766 
 4222      6300
 4223 008a 0000     		.space	2
 4224              	.LC35:
 4225 008c 77696669 		.ascii	"wifi_ht_mode\000"
 4225      5F68745F 
 4225      6D6F6465 
 4225      00
 4226 0099 000000   		.space	3
 4227              	.LC36:
 4228 009c 30783030 		.ascii	"0x00003FCF\000"
 4228      30303346 
 4228      434600
 4229 00a7 00       		.space	1
 4230              	.LC37:
 4231 00a8 77696669 		.ascii	"wifi_opr_rate_mask\000"
 4231      5F6F7072 
 4231      5F726174 
 4231      655F6D61 
 4231      736B00
 4232 00bb 00       		.space	1
 4233              	.LC38:
 4234 00bc 30783030 		.ascii	"0x003FFFCF\000"
 4234      33464646 
 4234      434600
 4235 00c7 00       		.space	1
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 135


 4236              	.LC39:
 4237 00c8 77696669 		.ascii	"wifi_powersave\000"
 4237      5F706F77 
 4237      65727361 
 4237      766500
 4238 00d7 00       		.space	1
 4239              	.LC40:
 4240 00d8 77696669 		.ascii	"wifi_operational_mode\000"
 4240      5F6F7065 
 4240      72617469 
 4240      6F6E616C 
 4240      5F6D6F64 
 4241 00ee 0000     		.space	2
 4242              	.LC41:
 4243 00f0 77696669 		.ascii	"wifi_beacon_wakeup\000"
 4243      5F626561 
 4243      636F6E5F 
 4243      77616B65 
 4243      757000
 4244 0103 00       		.space	1
 4245              	.LC42:
 4246 0104 77696669 		.ascii	"wifi_listen_interval\000"
 4246      5F6C6973 
 4246      74656E5F 
 4246      696E7465 
 4246      7276616C 
 4247 0119 000000   		.space	3
 4248              	.LC43:
 4249 011c 77696669 		.ascii	"wifi_tx_power\000"
 4249      5F74785F 
 4249      706F7765 
 4249      7200
 4250 012a 0000     		.space	2
 4251              	.LC44:
 4252 012c 69705F68 		.ascii	"ip_hostname\000"
 4252      6F73746E 
 4252      616D6500 
 4253              	.LC45:
 4254 0138 69705F61 		.ascii	"ip_apdomainname\000"
 4254      70646F6D 
 4254      61696E6E 
 4254      616D6500 
 4255              	.LC46:
 4256 0148 69705F61 		.ascii	"ip_apredirect\000"
 4256      70726564 
 4256      69726563 
 4256      7400
 4257 0156 0000     		.space	2
 4258              	.LC47:
 4259 0158 69705F68 		.ascii	"ip_http_get_recv_timeout\000"
 4259      7474705F 
 4259      6765745F 
 4259      72656376 
 4259      5F74696D 
 4260 0171 000000   		.space	3
 4261              	.LC48:
 4262 0174 69705F64 		.ascii	"ip_dhcp_timeout\000"
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 136


 4262      6863705F 
 4262      74696D65 
 4262      6F757400 
 4263              	.LC49:
 4264 0184 77696669 		.ascii	"wifi_reg_country\000"
 4264      5F726567 
 4264      5F636F75 
 4264      6E747279 
 4264      00
 4265 0195 000000   		.space	3
 4266              	.LC50:
 4267 0198 41542B53 		.ascii	"AT+S.HTTPD=%d\015\000"
 4267      2E485454 
 4267      50443D25 
 4267      640D00
 4268 01a7 00       		.space	1
 4269              	.LC51:
 4270 01a8 0D0A456E 		.ascii	"\015\012End of Initialization..\015\000"
 4270      64206F66 
 4270      20496E69 
 4270      7469616C 
 4270      697A6174 
 4271              		.section	.rodata.wifi_network_scan.str1.4,"aMS",%progbits,1
 4272              		.align	2
 4273              	.LC12:
 4274 0000 41542B53 		.ascii	"AT+S.SCAN\015\000"
 4274      2E534341 
 4274      4E0D00
 4275              		.section	.rodata.wifi_ping.str1.4,"aMS",%progbits,1
 4276              		.align	2
 4277              	.LC6:
 4278 0000 41542B53 		.ascii	"AT+S.PING=%s\015\000"
 4278      2E50494E 
 4278      473D2573 
 4278      0D00
 4279              		.section	.rodata.wifi_restore.str1.4,"aMS",%progbits,1
 4280              		.align	2
 4281              	.LC53:
 4282 0000 6C6F6361 		.ascii	"localecho1\000"
 4282      6C656368 
 4282      6F3100
 4283              		.section	.rodata.wifi_set_socket_certificates.str1.4,"aMS",%progbits,1
 4284              		.align	2
 4285              	.LC0:
 4286 0000 41542B53 		.ascii	"AT+S.TLSCERT2=clean,all\015\000"
 4286      2E544C53 
 4286      43455254 
 4286      323D636C 
 4286      65616E2C 
 4287 0019 000000   		.space	3
 4288              	.LC1:
 4289 001c 41542B53 		.ascii	"AT+S.SETTIME=%lu\015\000"
 4289      2E534554 
 4289      54494D45 
 4289      3D256C75 
 4289      0D00
 4290 002e 0000     		.space	2
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 137


 4291              	.LC2:
 4292 0030 41542B53 		.ascii	"AT+S.TLSCERT=f_ca,%d\015%s\000"
 4292      2E544C53 
 4292      43455254 
 4292      3D665F63 
 4292      612C2564 
 4293              	.LC3:
 4294 0048 41542B53 		.ascii	"AT+S.TLSDOMAIN=f_domain,%s\015\000"
 4294      2E544C53 
 4294      444F4D41 
 4294      494E3D66 
 4294      5F646F6D 
 4295              	.LC4:
 4296 0064 41542B53 		.ascii	"AT+S.TLSCERT=f_cert,%d\015%s\000"
 4296      2E544C53 
 4296      43455254 
 4296      3D665F63 
 4296      6572742C 
 4297 007e 0000     		.space	2
 4298              	.LC5:
 4299 0080 41542B53 		.ascii	"AT+S.TLSCERT=f_key,%d\015%s\000"
 4299      2E544C53 
 4299      43455254 
 4299      3D665F6B 
 4299      65792C25 
 4300              		.section	.rodata.wifi_standby.str1.4,"aMS",%progbits,1
 4301              		.align	2
 4302              	.LC24:
 4303 0000 736C6565 		.ascii	"sleep_enabled\000"
 4303      705F656E 
 4303      61626C65 
 4303      6400
 4304 000e 0000     		.space	2
 4305              	.LC25:
 4306 0010 7374616E 		.ascii	"standby_enabled\000"
 4306      6462795F 
 4306      656E6162 
 4306      6C656400 
 4307              	.LC26:
 4308 0020 7374616E 		.ascii	"standby_time\000"
 4308      6462795F 
 4308      74696D65 
 4308      00
 4309 002d 000000   		.space	3
 4310              	.LC27:
 4311 0030 41542B43 		.ascii	"AT+CFUN=%d\015\000"
 4311      46554E3D 
 4311      25640D00 
 4312              		.text
 4313              	.Letext0:
 4314              		.file 3 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\include
 4315              		.file 4 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\include
 4316              		.file 5 "Drivers/CMSIS/Include/core_cm4.h"
 4317              		.file 6 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/system_stm32f4xx.h"
 4318              		.file 7 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f401xe.h"
 4319              		.file 8 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f4xx.h"
 4320              		.file 9 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 138


 4321              		.file 10 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_gpio.h"
 4322              		.file 11 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 4323              		.file 12 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim.h"
 4324              		.file 13 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_uart.h"
 4325              		.file 14 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal.h"
 4326              		.file 15 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_spi.h"
 4327              		.file 16 "Middlewares/ST/STM32_SPWF0xSy/Inc/wifi_interface.h"
 4328              		.file 17 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
 4329              		.file 18 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
 4330              		.file 19 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\lib\\gcc\\arm-none-ea
 4331              		.file 20 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
 4332              		.file 21 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
 4333              		.file 22 "Middlewares/ST/STM32_SPWF0xSy/Utils/event_buffer.h"
 4334              		.file 23 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
 4335              		.file 24 "Middlewares/ST/STM32_SPWF0xSy/Inc/wifi_module.h"
 4336              		.file 25 "Middlewares/ST/STM32_SPWF0xSy/Utils/wifi_globals.h"
 4337              		.file 26 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_ll_dma.h"
 4338              		.file 27 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
 4339              		.file 28 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
 4340              		.file 29 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_cortex.h"
 4341              		.file 30 "<built-in>"
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 139


DEFINED SYMBOLS
                            *ABS*:00000000 wifi_interface.c
D:\cygwin64\tmp\ccTK68Dr.s:18     .text.wifi_set_socket_certificates:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:25     .text.wifi_set_socket_certificates:00000000 wifi_set_socket_certificates
D:\cygwin64\tmp\ccTK68Dr.s:280    .text.wifi_set_socket_certificates:00000158 $d
D:\cygwin64\tmp\ccTK68Dr.s:293    .text.wifi_ping:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:300    .text.wifi_ping:00000000 wifi_ping
D:\cygwin64\tmp\ccTK68Dr.s:347    .text.wifi_ping:0000002c $d
D:\cygwin64\tmp\ccTK68Dr.s:353    .text.wifi_websocket_client_open:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:360    .text.wifi_websocket_client_open:00000000 wifi_websocket_client_open
D:\cygwin64\tmp\ccTK68Dr.s:393    .text.wifi_websocket_client_open:0000001c $d
D:\cygwin64\tmp\ccTK68Dr.s:398    .text.wifi_websocket_client_write:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:405    .text.wifi_websocket_client_write:00000000 wifi_websocket_client_write
D:\cygwin64\tmp\ccTK68Dr.s:454    .text.wifi_websocket_client_write:00000028 $d
D:\cygwin64\tmp\ccTK68Dr.s:460    .text.wifi_websocket_client_close:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:467    .text.wifi_websocket_client_close:00000000 wifi_websocket_client_close
D:\cygwin64\tmp\ccTK68Dr.s:491    .text.wifi_socket_client_open:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:498    .text.wifi_socket_client_open:00000000 wifi_socket_client_open
D:\cygwin64\tmp\ccTK68Dr.s:531    .text.wifi_socket_client_open:0000001c $d
D:\cygwin64\tmp\ccTK68Dr.s:536    .text.Open_Serial_Port:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:543    .text.Open_Serial_Port:00000000 Open_Serial_Port
D:\cygwin64\tmp\ccTK68Dr.s:584    .text.Open_Serial_Port:00000024 $d
D:\cygwin64\tmp\ccTK68Dr.s:589    .text.wifi_socket_client_write:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:596    .text.wifi_socket_client_write:00000000 wifi_socket_client_write
D:\cygwin64\tmp\ccTK68Dr.s:702    .text.wifi_socket_client_write:00000070 $d
D:\cygwin64\tmp\ccTK68Dr.s:707    .text.wifi_socket_client_close:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:714    .text.wifi_socket_client_close:00000000 wifi_socket_client_close
D:\cygwin64\tmp\ccTK68Dr.s:753    .text.wifi_socket_client_close:00000020 $d
D:\cygwin64\tmp\ccTK68Dr.s:759    .text.wifi_socket_server_open:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:766    .text.wifi_socket_server_open:00000000 wifi_socket_server_open
D:\cygwin64\tmp\ccTK68Dr.s:791    .text.wifi_socket_server_close:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:798    .text.wifi_socket_server_close:00000000 wifi_socket_server_close
D:\cygwin64\tmp\ccTK68Dr.s:821    .text.wait_for_command_mode:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:828    .text.wait_for_command_mode:00000000 wait_for_command_mode
D:\cygwin64\tmp\ccTK68Dr.s:856    .text.wait_for_command_mode:00000010 $d
D:\cygwin64\tmp\ccTK68Dr.s:861    .text.Socket_Read:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:868    .text.Socket_Read:00000000 Socket_Read
D:\cygwin64\tmp\ccTK68Dr.s:937    .text.Socket_Read:00000058 $d
D:\cygwin64\tmp\ccTK68Dr.s:945    .text.Socket_Pending_Data:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:952    .text.Socket_Pending_Data:00000000 Socket_Pending_Data
D:\cygwin64\tmp\ccTK68Dr.s:1004   .text.Socket_Pending_Data:00000044 $d
D:\cygwin64\tmp\ccTK68Dr.s:1013   .text.wifi_socket_server_write:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:1020   .text.wifi_socket_server_write:00000000 wifi_socket_server_write
D:\cygwin64\tmp\ccTK68Dr.s:1278   .text.wifi_socket_server_write:000000ec $d
D:\cygwin64\tmp\ccTK68Dr.s:1287   .text.wifi_file_delete:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:1294   .text.wifi_file_delete:00000000 wifi_file_delete
D:\cygwin64\tmp\ccTK68Dr.s:1335   .text.wifi_file_list:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:1342   .text.wifi_file_list:00000000 wifi_file_list
D:\cygwin64\tmp\ccTK68Dr.s:1377   .text.wifi_file_print_content:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:1384   .text.wifi_file_print_content:00000000 wifi_file_print_content
D:\cygwin64\tmp\ccTK68Dr.s:1433   .text.wifi_file_create:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:1440   .text.wifi_file_create:00000000 wifi_file_create
D:\cygwin64\tmp\ccTK68Dr.s:1568   .text.wifi_file_create:000000a4 $d
D:\cygwin64\tmp\ccTK68Dr.s:1576   .text.wifi_fill_input_buffer:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:1583   .text.wifi_fill_input_buffer:00000000 wifi_fill_input_buffer
D:\cygwin64\tmp\ccTK68Dr.s:1637   .text.wifi_fill_input_buffer:00000034 $d
D:\cygwin64\tmp\ccTK68Dr.s:1642   .text.wifi_http_get:00000000 $t
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 140


D:\cygwin64\tmp\ccTK68Dr.s:1649   .text.wifi_http_get:00000000 wifi_http_get
D:\cygwin64\tmp\ccTK68Dr.s:1715   .text.wifi_http_get:00000030 $d
D:\cygwin64\tmp\ccTK68Dr.s:1720   .text.wifi_http_post:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:1727   .text.wifi_http_post:00000000 wifi_http_post
D:\cygwin64\tmp\ccTK68Dr.s:1794   .text.wifi_http_post:00000034 $d
D:\cygwin64\tmp\ccTK68Dr.s:1799   .text.wifi_file_image_create:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:1806   .text.wifi_file_image_create:00000000 wifi_file_image_create
D:\cygwin64\tmp\ccTK68Dr.s:1873   .text.wifi_file_erase_external_flash:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:1880   .text.wifi_file_erase_external_flash:00000000 wifi_file_erase_external_flash
D:\cygwin64\tmp\ccTK68Dr.s:1932   .text.wifi_file_erase_external_flash:00000038 $d
D:\cygwin64\tmp\ccTK68Dr.s:1938   .text.wifi_fw_update:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:1945   .text.wifi_fw_update:00000000 wifi_fw_update
D:\cygwin64\tmp\ccTK68Dr.s:1984   .text.wifi_network_scan:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:1991   .text.wifi_network_scan:00000000 wifi_network_scan
D:\cygwin64\tmp\ccTK68Dr.s:2068   .text.wifi_network_scan:0000005c $d
D:\cygwin64\tmp\ccTK68Dr.s:2077   .text.wifi_ap_start:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:2084   .text.wifi_ap_start:00000000 wifi_ap_start
D:\cygwin64\tmp\ccTK68Dr.s:2201   .text.wifi_ap_start:00000074 $d
D:\cygwin64\tmp\ccTK68Dr.s:2210   .text.wifi_connect:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:2217   .text.wifi_connect:00000000 wifi_connect
D:\cygwin64\tmp\ccTK68Dr.s:2339   .text.wifi_connect:00000080 $d
D:\cygwin64\tmp\ccTK68Dr.s:2347   .text.wifi_adhoc_create:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:2354   .text.wifi_adhoc_create:00000000 wifi_adhoc_create
D:\cygwin64\tmp\ccTK68Dr.s:2474   .text.wifi_adhoc_create:0000007c $d
D:\cygwin64\tmp\ccTK68Dr.s:2488   .text.wifi_standby:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:2495   .text.wifi_standby:00000000 wifi_standby
D:\cygwin64\tmp\ccTK68Dr.s:2558   .text.wifi_standby:00000050 $d
D:\cygwin64\tmp\ccTK68Dr.s:2568   .text.wifi_wakeup:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:2575   .text.wifi_wakeup:00000000 wifi_wakeup
D:\cygwin64\tmp\ccTK68Dr.s:2652   .text.wifi_wakeup:00000058 $d
D:\cygwin64\tmp\ccTK68Dr.s:2658   .text.wifi_init:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:2665   .text.wifi_init:00000000 wifi_init
D:\cygwin64\tmp\ccTK68Dr.s:3131   .text.wifi_init:00000290 $d
D:\cygwin64\tmp\ccTK68Dr.s:3161   .text.wifi_init:00000300 $t
D:\cygwin64\tmp\ccTK68Dr.s:3334   .text.wifi_init:00000414 $d
D:\cygwin64\tmp\ccTK68Dr.s:3348   .text.wifi_disconnect:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:3355   .text.wifi_disconnect:00000000 wifi_disconnect
D:\cygwin64\tmp\ccTK68Dr.s:3401   .text.wifi_disconnect:0000002c $d
D:\cygwin64\tmp\ccTK68Dr.s:3407   .text.wifi_enable:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:3414   .text.wifi_enable:00000000 wifi_enable
D:\cygwin64\tmp\ccTK68Dr.s:3533   .text.wifi_enable:00000088 $d
D:\cygwin64\tmp\ccTK68Dr.s:3541   .text.wifi_restore:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:3548   .text.wifi_restore:00000000 wifi_restore
D:\cygwin64\tmp\ccTK68Dr.s:3585   .text.wifi_restore:00000024 $d
D:\cygwin64\tmp\ccTK68Dr.s:3591   .text.wifi_gpio_init:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:3598   .text.wifi_gpio_init:00000000 wifi_gpio_init
D:\cygwin64\tmp\ccTK68Dr.s:3677   .text.wifi_gpio_init:0000004c $d
D:\cygwin64\tmp\ccTK68Dr.s:3684   .text.wifi_gpio_read:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:3691   .text.wifi_gpio_read:00000000 wifi_gpio_read
D:\cygwin64\tmp\ccTK68Dr.s:3754   .text.wifi_gpio_read:00000040 $d
D:\cygwin64\tmp\ccTK68Dr.s:3761   .text.wifi_gpio_write:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:3768   .text.wifi_gpio_write:00000000 wifi_gpio_write
D:\cygwin64\tmp\ccTK68Dr.s:3822   .text.wifi_gpio_write:00000034 $d
D:\cygwin64\tmp\ccTK68Dr.s:3828   .text.wifi_get_IP_address:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:3835   .text.wifi_get_IP_address:00000000 wifi_get_IP_address
D:\cygwin64\tmp\ccTK68Dr.s:3909   .text.wifi_get_IP_address:00000050 $d
D:\cygwin64\tmp\ccTK68Dr.s:3917   .text.wifi_get_MAC_address:00000000 $t
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 141


D:\cygwin64\tmp\ccTK68Dr.s:3924   .text.wifi_get_MAC_address:00000000 wifi_get_MAC_address
D:\cygwin64\tmp\ccTK68Dr.s:3998   .text.wifi_get_MAC_address:00000050 $d
D:\cygwin64\tmp\ccTK68Dr.s:4006   .text.wifi_get_status_variable_value:00000000 $t
D:\cygwin64\tmp\ccTK68Dr.s:4013   .text.wifi_get_status_variable_value:00000000 wifi_get_status_variable_value
D:\cygwin64\tmp\ccTK68Dr.s:4108   .text.wifi_get_status_variable_value:00000070 $d
                            *COM*:00000014 WAKEUP_InitStruct
D:\cygwin64\tmp\ccTK68Dr.s:4118   .rodata.Socket_Pending_Data.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4122   .rodata.Socket_Read.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4126   .rodata.wifi_adhoc_create.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4150   .rodata.wifi_ap_start.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4160   .rodata.wifi_enable.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4164   .rodata.wifi_file_create.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4171   .rodata.wifi_file_erase_external_flash.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4175   .rodata.wifi_get_IP_address.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4179   .rodata.wifi_get_MAC_address.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4185   .rodata.wifi_get_status_variable_value.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4189   .rodata.wifi_gpio_init.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4196   .rodata.wifi_gpio_read.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4200   .rodata.wifi_gpio_write.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4204   .rodata.wifi_init.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4272   .rodata.wifi_network_scan.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4276   .rodata.wifi_ping.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4280   .rodata.wifi_restore.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4284   .rodata.wifi_set_socket_certificates.str1.4:00000000 $d
D:\cygwin64\tmp\ccTK68Dr.s:4301   .rodata.wifi_standby.str1.4:00000000 $d
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
Reset_AT_CMD_Buffer
strlen
USART_Transmit_AT_Cmd
USART_Receive_AT_Resp
sprintf
WiFi_Counter_Variables
WiFi_AT_Cmd_Buff
Queue_Client_Open_Event
Queue_Client_Write_Event
open_web_socket
Queue_Client_Close_Event
open_sockets
WiFi_Control_Variables
Queue_Server_Open_Event
Queue_Server_Close_Event
IO_status_flag
WiFi_switch_to_data_mode
HAL_UART_Transmit
WiFi_UART_Error_Handler
WiFi_switch_to_command_mode
wifi_client_connected
UartWiFiHandle
Queue_File_Event
Queue_Wifi_File_Event
memset
memcpy
HAL_NVIC_EnableIRQ
Queue_Http_Event
SET_Power_State
ARM GAS  D:\cygwin64\tmp\ccTK68Dr.s 			page 142


ResetBuffer
Queue_Wifi_FW_Update_Event
wifi_scanned_list
SET_WiFi_SecKey
SET_SSID
SET_Configuration_Value
Save_Current_Setting
WiFi_Config_Variables
SET_Configuration_Addr
HAL_GPIO_Init
HAL_GPIO_WritePin
printf
puts
WiFi_Module_Init
wifi_reset
Restore_Default_Setting
UART_Configuration
Receive_Data
fflush
_impure_ptr
wifi_connected
strstr
atoi
